<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

            <meta charset="GBK" />
    <meta content="webkit" name="renderer" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="Uv1hAuRUL2" name="baidu-site-verification" />
    <meta content="支付宝服务窗平台,支付宝服务窗" name="keywords" />
    <meta content="支付宝服务窗平台，是支付宝向个人及组织提供的，面向支付宝钱包用户的服务平台。支付宝服务窗平台能够帮助商户与顾客进行信息互通互动、承载各类基于网页的功能服务、助力客户管理与数据分析。为各行业商户提供深度定制化营销解决方案，迅速提升商户在无线端的营销能力。" name="description" />
    <title>支付宝服务窗平台</title>
        
    
    

<link type="image/x-icon" href="favicon.ico" rel="icon" />
<link type="image/x-icon" href="favicon.ico" rel="shortcut icon" />    <link rel="dns-prefetch" href="https://a.alipayobjects.com/" />
<link rel="dns-prefetch" href="https://app.alipay.com/" />
<link rel="dns-prefetch" href="https://my.alipay.com/" />
<link rel="dns-prefetch" href="https://lab.alipay.com/" />
<link rel="dns-prefetch" href="https://cashier.alipay.com/" />
<link rel="dns-prefetch" href="https://financeprod.alipay.com/" />
<link rel="dns-prefetch" href="https://shenghuo.alipay.com/" />


<!-- uitpl:/component/trackerTime.vm -->
    <!-- CMS:全站公共 cms/tracker/iconfont.vm开始:tracker/iconfont.vm --><!-- CMS:全站公共 cms/tracker/iconfont.vm结束:tracker/iconfont.vm -->
<script type="text/javascript" async="" charset="utf-8" src="https://c.cnzz.com/core.php?web_id=1253107971&amp;t=q"></script><script type="text/javascript" async="" charset="utf-8" src="http://c.cnzz.com/core.php?web_id=1253107971&amp;t=q"></script><script type="text/javascript" async="" charset="utf-8" src="core.php"></script><script type="text/javascript">
  window._to = { start: new Date() };
</script>

<!-- CMS:cms/监控埋点/前端监控前置脚本开始:tracker/monitor.vm --><script type="text/javascript">
(function(e){if(!e.monitor){var a=e.monitor={};a._DATAS=[];var f=a._EVENTS=[];a.on=function(a,d){f.push([a,d])};a.off=function(){};a.log=function(c,d){if(c&amp;&amp;!(3&lt;=arguments.length)){var b;"[object Object]"===Object.prototype.toString.call(c)?(b=c,b.profile=d||b.profile||"log"):b={profile:d||"log",seed:c};a._DATAS.push(b);return b}}}})(this);
(function(h,c){function q(a){return(a=String(a).match(r))?a[0]:"global"}function f(a,m,n,g,f,d,k){if(!k&amp;&amp;arguments.callee.caller){for(var b=arguments.callee.caller,e=[],h=0;b.arguments&amp;&amp;b.arguments.callee&amp;&amp;b.arguments.callee.caller;){b=b.arguments.callee.caller;e.push("at "+q(b));if(b.caller===b)break;if(h++&gt;s)break}k=e.join("\n")}b={profile:t,type:a,msg:m||"",file:n||"",line:g||0,col:f||0,num:d||"",stack:k||"",lang:navigator.language||navigator.browserLanguage||"",lost:l.join(",")};
e=n+":"+g+":"+m;p.hasOwnProperty(e)||(b.uv=1,p[e]=!0);return c.log(b)}if(c){var t="jserror",s=20,r=/^\s*function\b[^\)]+\)/,l=[],d={};c.lost=function(a){if(!d.hasOwnProperty(a))return d[a]=!0,l.push(a),l};var p={};c.error=function(a){if(a instanceof Error)return f("catched",a.message||a.description,a.filename||a.fileName||a.sourceURL,a.lineno||a.lineNumber||a.line,a.colno||a.columnNumber,a.number,a.stack||a.stacktrace)};h.onerror=function(a,c,d,g){f("global",a,c,d,g);return!1}}})(this,this.monitor);
</script><!-- CMS:cms/监控埋点/前端监控前置脚本结束:tracker/monitor.vm -->
<!-- CMS:全站公共 cms/tracker/seajs.vm开始:tracker/seajs.vm -->	

<!-- monitor 防错代码 -->
<script>
(function(win){
  if(!win.monitor){win.monitor = {};}

  var METHODS = ["lost", "log", "error", "on", "off"];

  for(var i=0,method,l=METHODS.length; i&lt;l; i++){
    method = METHODS[i];
    if("function" !== typeof win.monitor[method]){
      win.monitor[method] = function(){};
    }
  }
})(window);
</script>

<!-- seajs以及插件 -->
<script src="untitled" onerror="window.monitor &amp;&amp; monitor.lost &amp;&amp; monitor.lost(this.src)" id="seajsnode" crossorigin="anonymous" charset="utf-8"></script>

<!-- seajs config 配置 -->
<script>
seajs.config({
  alias: {
    '$': 'jquery/jquery/1.7.2/jquery',
    '$-debug': 'jquery/jquery/1.7.2/jquery',
    'jquery': 'jquery/jquery/1.7.2/jquery',
    'jquery-debug': 'jquery/jquery/1.7.2/jquery-debug',
    'seajs-debug': 'seajs/seajs-debug/1.1.1/seajs-debug'
  },
  crossorigin: function(uri){
  
    function typeOf(type){
	  return function(object){
	    return Object.prototype.toString.call(object) === '[object ' + type + ']';
	  }
	}
	var isString = typeOf("String");
	var isRegExp = typeOf("RegExp");
    
	var whitelist = [];
	
                  whitelist.push('https://a.alipayobjects.com/');
          	
	for (var i=0, rule, l=whitelist.length; i&lt;l; i++){
	  rule = whitelist[i];
	  if (
	    (isString(rule) &amp;&amp; uri.indexOf(rule) === 0) ||
	    (isRegExp(rule) &amp;&amp; rule.test(uri))
		) {
		
	    return "anonymous";
	  }
	}
  },
  vars: {
    locale: 'zh-cn'
  }
});
</script>

<!-- 兼容原有的 plugin-i18n 写法 -->
<!-- https://github.com/seajs/seajs/blob/1.3.1/src/plugins/plugin-i18n.js -->
<script>
seajs.pluginSDK = seajs.pluginSDK || {
  Module: {
    _resolve: function() {}
  },
  config: {
    locale: ''
  }
};
// 干掉载入 plugin-i18n.js，避免 404
seajs.config({
  map: [
	[/^.*\/seajs\/plugin-i18n\.js$/, ''],
	[/^.*\i18n!lang\.js$/, '']
  ] 
});
</script>

<!-- 路由旧 ID，解决 seajs.use('select/x.x.x/select') 的历史遗留问题 -->
<script>
(function(){

var JQ = '/jquery/1.7.2/jquery.js';
seajs.cache['https://a.alipayobjects.com/gallery' + JQ] = seajs.cache['https://a.alipayobjects.com/jquery' + JQ];

var GALLERY_MODULES = [
  'async','backbone','coffee','cookie','es5-safe','handlebars','iscroll',
  'jasmine','jasmine-jquery','jquery','jquery-color','json','keymaster',
  'labjs','less','marked','moment','mustache','querystring','raphael',
  'socketio','store','swfobject','underscore','zepto','ztree'
];

var ARALE_MODULES = [
  'autocomplete','base','calendar','class','cookie','dialog','easing',
  'events','iframe-uploader','iframe-shim','messenger','overlay','popup',
  'position','select','switchable','tip','validator','widget'
];

var util = {};
util.indexOf = Array.prototype.indexOf ?
  function(arr, item) {
    return arr.indexOf(item);
  } :
  function(arr, item) {
    for (var i = 0; i &lt; arr.length; i++) {
      if (arr[i] === item) {
        return i;
      }
    }
    return -1;
  };
util.map = Array.prototype.map ?
  function(arr, fn) {
    return arr.map(fn);
  } :
  function(arr, fn) {
    var ret = [];
	for (var i = 0; i &lt; arr.length; i++) {
        ret.push(fn(arr[i], i, arr));
    }
    return ret;
  };

function contains(arr, item) {
  return util.indexOf(arr, item) &gt; -1
}

function map(id) {
  id = id.replace('#', '');

  var parts = id.split('/');
  var len = parts.length;
  var root, name;

  // id = root/name/x.y.z/name
  if (len === 4) {
    root = parts[0];
    name = parts[1];

    // gallery 或 alipay 开头的没有问题
    if (root === 'alipay' || root === 'gallery') {
      return id;
    }

    // arale 开头的
    if (root === 'arale') {
      // 处理 arale/handlebars 的情况
      if (contains(GALLERY_MODULES, name)) {
        return id.replace('arale/', 'gallery/');
      } else {
        return id;
      }
    }
  }
  // id = name/x.y.z/name
  else if (len === 3) {
    name = parts[0]

    // 开头在 GALLERY_MODULES 或 ARALE_MODULES
    if (contains(GALLERY_MODULES, name)) {
      return 'gallery/' + id;
    } else if (contains(ARALE_MODULES, name)) {
      return 'arale/' + id;
    }
  }

  return id;
}

var _use = seajs.use;

seajs.use = function(ids, callback) {
  if (typeof ids === 'string') {
    ids = [ids];
  }

  ids = util.map(ids, function(id) {
    return map(id);
  });

  return _use(ids, callback);
}

})();
</script><!-- CMS:全站公共 cms/tracker/seajs.vm结束:tracker/seajs.vm -->
<!-- CMS:全站公共 cms/tracker/tracker_time.vm开始:tracker/tracker_time.vm --><meta content="" name="ABTest" />

<script type="text/javascript">
if (!window._to) {
  window._to = { start: new Date() };
}
</script>


  







  <script src="untitled_001.dat" crossorigin="crossorigin" charset="utf-8"></script>



  
        
  


<script>
  window.Tracker &amp;&amp; Tracker.start &amp;&amp; Tracker.start();
  

  
                                                                      
  
        
  
</script>
<!-- CMS:全站公共 cms/tracker/tracker_time.vm结束:tracker/tracker_time.vm -->    <script type="text/javascript">
        seajs.config({
            alias: {
                'xBox': 'alipay/xbox/1.1.3/xbox',
                'dialog': 'arale/dialog/1.2.6/dialog',
                'confirmbox': 'arale/dialog/1.2.4/confirmbox',
                'handlebars': 'gallery/handlebars/1.0.2/handlebars',
                'json': 'gallery/json/1.0.3/json',
                "widget": "arale/widget/1.1.1/widget",
                'validator': 'arale/validator/0.9.7/validator',
                'cookie':'arale/cookie/1.0.2/cookie'
            },
            vars: {
                locale: 'zh-cn'
            }
        });
    </script>
    <script src="base.js" charset="utf-8" type="text/javascript"></script>

<link media="all" href="index.css" type="text/css" rel="stylesheet" />
</head>
<body>

<!-- CMS:公众服务平台商户后台cms/develop/developaapi.vm开始:publichome/develop/developaapi.vm -->
    
    <script src="3bvrks6ryz.js" type="text/javascript"></script>
    <script type="text/javascript">function byId(t){return document.getElementById(t)}function initPage(){$(".entry-content a").each(function(){0!==$(this).attr("href").indexOf("#")&amp;&amp;$(this).attr("target","_blank")}),$("pre").append("&lt;span class='clipbord'&gt;复制到剪贴版&lt;/span&gt;");var t=navigator.userAgent.toLowerCase(),e=-1==t.indexOf("chrome")&amp;&amp;t.indexOf("safari")&gt;0?decodeURI(window.location.hash).substr(1):window.location.hash.substr(1);$(byId(e)).length&gt;0&amp;&amp;$("html, body").animate({scrollTop:$(byId(e)).offset().top},800),_sidebarInit(),_clipInit()}function initScroll(){var t=$(window).scrollTop();_titleActive(),_elFixed(t)}function _sidebarInit(){var t=$(".document .entry-content").find("h1,h2"),e=$(".threecol.meta"),i="";i+='&lt;div id="sidebar-wrapper"&gt;',i+='&lt;div id="sidebar-fixed-nav"&gt;',t.each(function(t){$(this).attr("id")&amp;&amp;$(this).is("h1")?(0!==t&amp;&amp;(i+="&lt;/dl&gt;"),i+="&lt;dl&gt;",i+='&lt;dt data-index="'+t+'"&gt;&lt;a href="#'+$(this).attr("id")+'"&gt;'+$(this).text()+"&lt;/a&gt;&lt;/dt&gt;"):$(this).attr("id")&amp;&amp;$(this).is("h2")&amp;&amp;(i+='&lt;dd data-index="'+t+'"&gt;&lt;a href="#'+$(this).attr("id")+'"&gt;'+$(this).text()+"&lt;/a&gt;&lt;/dd&gt;")}),i+="&lt;/dl&gt;",i+="&lt;/div&gt;",i+="&lt;/div&gt;",e.html(i)}function _elFixed(t){var e=$(".header-nav").outerHeight()+parseInt($("#sidebar-wrapper").closest(".mar").css("marginTop"),0),i=$(".header-nav").offset().top,a=$(".footer").offset().top-$("#sidebar-wrapper").outerHeight()-e;i&gt;t?($("#sidebar-wrapper").removeClass("sidebar-fixed-top").css({top:"auto"}),$(".navigation").removeClass("navigation-fix navigation-btm").css({top:"auto"}),$("#sidebar-wrapper").css({maxHeight:$(window).height()-77})):t&gt;=i&amp;&amp;a&gt;t?($("#sidebar-wrapper").addClass("sidebar-fixed-top"),$(".navigation").addClass("navigation-fix").removeClass("navigation-btm").css({top:0}),$("#sidebar-wrapper").css({maxHeight:$(window).height()-20})):($("#sidebar-wrapper").removeClass("sidebar-fixed-top").offset({top:a+e}),$(".navigation").addClass("navigation-fix navigation-btm").offset({top:a}),$("#sidebar-wrapper").css({maxHeight:$(window).height()-100}))}function _titleActive(){var t=$(".document .entry-content").find("h1,h2"),e=$(".threecol.meta");t.each(function(t){if(this.getBoundingClientRect().bottom&gt;17&amp;&amp;this.getBoundingClientRect().top&lt;$(window).innerHeight()){var i=e.find('[data-index="'+t+'"]');switch(i.closest("dl").siblings("dl").removeClass("active"),i.closest("dl").addClass("active"),i.closest("dl").find("dd").removeClass("active"),this.nodeName.toUpperCase()){case"H1":i.closest("dl").find("dd").eq(0).addClass("active");break;case"H2":i.addClass("active")}return!1}})}function _clipInit(){var t=new ZeroClipboard($(".clipbord"),{moviePath:"//a.alipayobjects.com/gallery/zeroclipboard/1.3.5/ZeroClipboard.swf?noCache=1409909828475",hoverClass:"show",forceHandCursor:!0,trustedDomains:["*"]});t.on("load",function(t){t.on("datarequested",function(t){t.setText($(this).prev().text())}),t.on("complete",function(){var t=$(this);t.html("复制成功"),setTimeout(function(){t.html("复制到剪贴版")},3e3)})}),t.on("wrongflash noflash",function(){ZeroClipboard.destroy(),$("span.clipbord").remove()})}$(document).ready(function(){initPage(),initScroll(),$(window).scroll(function(){$(window).width()&gt;640&amp;&amp;initScroll()}),$(".threecol.meta").on("click","a",function(t){if(history.pushState&amp;&amp;t){t.preventDefault();var e,i=$(this);$("html, body").animate({scrollTop:$(i.attr("href")).offset().top},800),e=window.location.pathname.split("/"),history.pushState({},"",e[e.length-1]+i.attr("href"))}}),$(".navbar-toggle").click(function(){$(".header-nav").slideToggle(800)}),$(".nav &gt; li &gt; a").click(function(t){if($(this).next().length&gt;0){var e=t||event;e.preventDefault(),$(this).parent().siblings().find("ul").hide(),$(this).next().toggle()}}),$("pre code").mousedown(function(){$(this).siblings(".clipbord").addClass("hide")}),$(document).mouseup(function(){document.getSelection&amp;&amp;0===jQuery.trim(document.getSelection().toString()).length&amp;&amp;$(".clipbord").removeClass("hide")})});
    </script>
    <div class="header">
      <div class="slogan row"><img class="slogan-logo" alt="alipay" src="2m8ebk4ezh.png" seed="slogan-sloganLogo" smartracker="on" /><span>服务窗平台开发者文档</span></div>
      <div class="header-nav">
        <div class="navigation row-n" style="top: auto;"></div>
      </div>
    </div>
    <div class="row mar">
      <div class="threecol meta"><div id="sidebar-wrapper" style="top: auto; max-height: 812px;"><div id="sidebar-fixed-nav"><dl class="active"><dt data-index="0"><a href="#c01">服务窗简介</a></dt><dd data-index="1" class="active"><a href="#c0101">服务窗平台开发接口介绍</a></dd><dd data-index="2"><a href="#c0102">成功案例介绍</a></dd><dd data-index="3"><a href="#c0103">开发者规范</a></dd><dd data-index="4"><a href="#c0104_release_note">最新发布功能(Release Note)</a></dd></dl><dl><dt data-index="5"><a href="#c02">安全基础与接入</a></dt><dd data-index="6"><a href="#c0201">安全基础 - 生成公钥、私钥</a></dd><dd data-index="7"><a href="#c0202">接入与验证</a></dd><dd data-index="8"><a href="#c0203">消息交互体系</a></dd><dd data-index="9"><a href="#c0204">事件订阅与重试机制</a></dd><dd data-index="10"><a href="#c0205">数据接口与OAuth 2.0授权机制</a></dd></dl><dl><dt data-index="11"><a href="#c03">接收消息</a></dt><dd data-index="12"><a href="#c0301">开发者接入验证消息</a></dd><dd data-index="13"><a href="#c0302">事件消息</a></dd><dd data-index="14"><a href="#c0303">文本消息</a></dd><dd data-index="15"><a href="#c0304">图片消息</a></dd></dl><dl><dt data-index="16"><a href="#c04">发送消息</a></dt><dd data-index="17"><a href="#c0401">异步单发消息(客服接口)</a></dd><dd data-index="18"><a href="#c0402">群发消息</a></dd><dd data-index="19"><a href="#c0403">单发模板消息</a></dd></dl><dl><dt data-index="20"><a href="#c13">用户标签及标签组发消息接口组</a></dt><dd data-index="21"><a href="#c13_intro">概述</a></dd><dd data-index="22"><a href="#c13_label_crud">标签增删改查</a></dd><dd data-index="23"><a href="#c13_label_user_crud">用户标签增删查接口</a></dd><dd data-index="24"><a href="#c13_label_message">根据标签组发接口</a></dd></dl><dl><dt data-index="25"><a href="#c05">用户管理与数据开放</a></dt><dd data-index="26"><a href="#c0501">获取关注者列表</a></dd><dd data-index="27"><a href="#c0502">获取用户地理位置</a></dd><dd data-index="28"><a href="#c0503">账户信息共享接口</a></dd><dd data-index="29"><a href="#c0505">通讯录信息接口</a></dd><dd data-index="30"><a href="#c0504">获取用户收货地址(JSAPI)</a></dd></dl><dl><dt data-index="31"><a href="#c06">自定义菜单</a></dt><dd data-index="32"><a href="#c0601">菜单规范</a></dd><dd data-index="33"><a href="#c0602">创建菜单</a></dd><dd data-index="34"><a href="#c0603">更新菜单</a></dd><dd data-index="35"><a href="#c0604">查询菜单</a></dd></dl><dl><dt data-index="36"><a href="#c07">推广支持</a></dt><dd data-index="37"><a href="#c0701">带参推广二维码</a></dd><dd data-index="38"><a href="#c0702">带参推广短链接</a></dd></dl><dl><dt data-index="39"><a href="#c12">全民免费WiFi计划</a></dt><dd data-index="40"><a href="#c1201">概述</a></dd><dd data-index="41"><a href="#c1202">安全基础与接入认证</a></dd><dd data-index="42"><a href="#c1203">店铺管理接口</a></dd><dd data-index="43"><a href="#c1204">设备管理接口</a></dd></dl><dl><dt data-index="44"><a href="#c08">其他接口</a></dt><dd data-index="45"><a href="#c0801">支付接口</a></dd><dd data-index="46"><a href="#c0802">卡券接口</a></dd></dl><dl><dt data-index="47"><a href="#c09">附录</a></dt><dd data-index="48"><a href="#c0901">返回码</a></dd></dl><dl><dt data-index="49"><a href="#c10">JS接口</a></dt></dl><dl><dt data-index="50"><a href="#c11">开发者工具</a></dt><dd data-index="51"><a href="#c1101">SDK与Demo</a></dd><dd data-index="52"><a href="#c1102">JSAPI Demo</a></dd></dl></div></div></div>
      <div class="ninecol wrap-content">
        <div class="document">
          <div class="post-header">
            <div class="post-meta">
              <time datetime="2015-4-17">2015-4-17</time>
            </div>
          </div>
          <div class="entry-content"><h1 id="c01">Service Window Profile</h1>
<h2 id="c0101">Service Window platform development interface Introduction</h2>
<h3 id="c0101_intro">概述</h3>
<p>服务窗平台是为支付宝用户提供服务的平台，平台开发接口是提供服务的基础。开发者在<a href="https://fuwu.alipay.com/platform/index.htm" seed="entryContent-link" smartracker="on" target="_blank">服务窗平台</a>中创建服务窗，并且申请接口权限之后，可以通过阅读该文档来完成服务窗的开发工作。</p>
<p>服务窗平台开发接口向开发者提供包括自定义菜单、消息交互、获取用户基础信息等能力。当用户发消息给服务窗或者与服务窗发生其他交互时，支付宝网关会使用HTTP请求将消息推送给开发者网关，开发者网关也可以通过异步调用的方式给用户发送消息。</p>
<h3 id="c0101_apis">接口能力</h3>
<p>服务窗平台目前支持以下接口能力：</p>
<table>
<thead>
<tr>
<th>接口能力</th>
<th>描述及应用场景举例</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#c03" seed="entryContent-linkT1" smartracker="on">接收用户消息</a></td>
<td>用户发送的消息或者与服务窗产生的交互都会被推送至开发者网关，配合消息推送接口，开发者可以实现关键词回复消息、客服等业务</td>
</tr>
<tr>
<td><a href="#c04" seed="entryContent-linkT2" smartracker="on">向用户推送消息</a></td>
<td>开发者可以使用<a href="#c0401" seed="entryContent-linkT3" smartracker="on">异步单发消息</a>接口、<a href="#c0403" seed="entryContent-linkT4" smartracker="on">单发模板消息</a>接口或者<a href="#c0402" seed="entryContent-linkT5" smartracker="on">群发消息</a>接口向用户推送消息</td>
</tr>
<tr>
<td><a href="#c0502" seed="entryContent-linkT6" smartracker="on">获取用户地理位置信息</a></td>
<td>开发者可以根据用户地理位置信息提供个性化服务</td>
</tr>
<tr>
<td><a href="#c0503" seed="entryContent-linkT7" smartracker="on">网页授权获取用户基本信息</a></td>
<td>开发者可以通过OAuth2.0鉴权的方式获取用户基本信息，实现账号绑定、免登等业务逻辑</td>
</tr>
<tr>
<td><a href="#c0505" seed="entryContent-linkT8" smartracker="on">网页授权获取用户通讯录信息</a></td>
<td>开发者可以通过OAuth2.0鉴权的方式获取用户手机通讯录中好友的信息</td>
</tr>
<tr>
<td><a href="#c06" seed="entryContent-linkT9" smartracker="on">自定义菜单</a></td>
<td>支持<a href="#c0602" seed="entryContent-linkT10" smartracker="on">创建菜单</a>、<a href="#c0603" seed="entryContent-linkT11" smartracker="on">更新菜单</a>、<a href="#c0604" seed="entryContent-linkT12" smartracker="on">查询菜单</a>，用户点击菜单可以向开发者推送消息或者打开Web页面</td>
</tr>
<tr>
<td><a href="#c07" seed="entryContent-linkT13" smartracker="on">推广支持</a></td>
<td>开发者可以生成<a href="#c0701" seed="entryContent-linkT14" smartracker="on">带参推广二维码</a>和<a href="#c0702" seed="entryContent-linkT15" smartracker="on">带参推广短链接</a>，对服务窗及营销活动进行推广</td>
</tr>
<tr>
<td><a href="#c0801" seed="entryContent-linkT16" smartracker="on">支付接口</a></td>
<td>开发者可以在Web页面调用支付接口，非常方便地实现支付功能</td>
</tr>
<tr>
<td><a href="#c10" seed="entryContent-linkT17" smartracker="on">JS接口</a></td>
<td>开发者可以在Web页面调用JS接口实现获取用户网络状况、摇一摇等功能</td>
</tr>
<tr>
<td><a href="#c12" seed="entryContent-linkT18" smartracker="on">Wifi接口</a></td>
<td>开发者可以申请参与支付宝全民免费Wifi计划，为用户提供Wifi服务的同时，拓展自身的业务</td>
</tr>
</tbody>
</table>
<h2 id="c0102">成功案例介绍</h2>
<h3 id="c0102_shihua">中国石化浙江石油掌上营业厅</h3>
<p>中石化服务窗可以将用户与自身石化会员体系绑定，在此基础之上，为会员提供在线办卡、办卡进度查询、在线充值、消费查询等一系列服务。用户只需要关注该服务窗便可以享受这些快捷优质的服务。</p>
<p><img alt="中国石化浙江石油掌上营业厅" src="2uuffyeczd_src.png" seed="entryContent-iIEcmngPng2014062uuFfyeCzd_src" smartracker="on" /></p>
<h3 id="c0102_buding">布丁酒店连锁</h3>
<p>用户可以通过布丁酒店连锁服务窗进行账户绑定，使用该服务窗完成酒店预订、订单与积分管理、优惠券与特权券查看等功能，从此告别繁琐的APP，一步完成所需。用户还可以在这些服务中方便地使用支付宝的支付功能，安全快捷。除此之外，用户还能享受布丁酒店推送的优惠活动哦~</p>
<p><img alt="布丁酒店连锁" src="2uueu83re5_src.png" seed="entryContent-iIEcmngPng2014062uuEu83RE5_src" smartracker="on" /></p>
<h3 id="c0102_zhongxin">中信银行信用卡</h3>
<p>如果你是持卡人，可快捷查询信用卡账单、额度及积分。你还可以在服务窗中实现快速还款、申请账单分期等功能。从此你的信用卡消费将更加易于追踪，及时的消息推送让你再也不会忘记信用卡还款。</p>
<p><img alt="中信银行信用卡" src="2uugfimikr_src.png" seed="entryContent-iIEcmngPng2014062uuGFImIKr_src" smartracker="on" /></p>
<h3 id="c0102_dianxin">中国电信</h3>
<p>用户可以在中国电信服务窗中绑定自己的手机，从此话费和流量查询以及充值将变得异常简单。除此之外，用户还能第一时间看到中国电信推送的一系列优惠活动。</p>
<p><img alt="中国电信" src="2uufzux8xb_src.png" seed="entryContent-iIEcmngPng2014062uuFzux8xB_src" smartracker="on" /></p>
<h3 id="c0102_weizhang">交通违章办理</h3>
<p>在我们身处异地办理违章缴款并不方便、或是时间不充裕的时候，选择支付宝钱包代办交通违章无疑非常方便，万事不求人，填写完车牌号、发动机号等资料后就可以对车辆的违章情况进行查询，如果我们对违章情况没有异议的话可以直接在这里缴纳违章费用。</p>
<p><img alt="交通违章办理" src="2uuhmocndd_src.png" seed="entryContent-iIEcmngPng2014062uuHMOCNdd_src" smartracker="on" /></p>
<h2 id="c0103">开发者规范</h2>
<p>开发者进行服务窗开发时，除了需要满足每个接口的规范限制、调用频率限制外，还需特别注意用户数据等敏感信息的使用规范。</p>
<h3 id="c0103_data">用户数据获取使用规范</h3>
<ol>
<li>您的服务需要收集用户任何数据的，必须事先获得用户的明确同意，并且只使用运营中必须的用户数据，同时应当告知用户相关数据收集的目的、范围及使用方式等，保障用户知情权。</li>
<li>您收集用户的数据后，必须采取必要的保护措施，防止用户数据被盗、泄漏等。</li>
<li>您在特定支付宝服务窗中收集的用户数据仅可以在该特定支付宝服务窗中使用，不得将其使用在该特定支付宝服务窗之外或为其他任何目的进行使用，也不得以任何方式将其提供给他人。</li>
<li>如果支付宝认为您收集、使用用户数据的方式，可能损害用户体验，支付宝有权要求您删除相关数据并不得再以该方式收集、使用用户数据。</li>
<li>一旦您停止该服务，或支付宝基于任何原因终止您使用本服务，您必须立即删除全部因使用本服务而获得的数据（包括各种备份）， 且不得再以任何方式进行使用。</li>
</ol>
<h3 id="c0103_others">其他规范</h3>
<ol>
<li>请勿为任何用户自动登录到支付宝服务窗平台提供代理身份验证凭据。</li>
<li>请勿提供跟踪功能，包括但不限于识别其他用户在个人主页上查看、点击等操作行为。</li>
<li>请勿自动将浏览器窗口定向到其他网页。</li>
<li>请勿设置或发布任何违反相关法规、公序良俗、社会公德等的玩法、内容等。</li>
<li>请勿公开表达或暗示，您与支付宝之间存在合作关系，包括但不限于相互持股、商业往来或合作关系等，或声称支付宝对您的认可。</li>
<li>开发者进行服务窗开发时，除了需要满足每个接口的规范限制、调用频率限制外，还需特别注意用户数据等敏感信息的使用规范。</li>
</ol>
<h2 id="c0104_release_note">最新发布功能(Release Note)</h2>
<h3 id="c0104_20150213">2015/02/13 release note</h3>
<ol>
<li>全民免费WiFi计划内测申请已经开通，详情<a href="#c12" seed="entryContent-linkT19" smartracker="on">猛击此处</a></li>
<li>异步单发消息及群发消息支持<a href="#c0401_tofu" seed="entryContent-linkT20" smartracker="on">高级商品展示消息</a>类型</li>
<li>用户标签及标签组发消息接口组开放内测，详情<a href="#c13" seed="entryContent-linkT21" smartracker="on">猛击此处</a></li>
<li>通讯录信息接口开放内测，详情<a href="#c0505" seed="entryContent-linkT22" smartracker="on">猛击此处</a></li>
<li>OAuth 2.0授权支持接口组合授权方案，用户一次授权对多个接口生效，详情<a href="#c0205" seed="entryContent-linkT23" smartracker="on">猛击此处</a></li>
</ol>
<h3 id="c0104_20141204">2014/12/04 release note</h3>
<ol>
<li>事件订阅与重试机制，详情<a href="#c0204" seed="entryContent-linkT24" smartracker="on">猛击此处</a><ol>
<li>2014年12月06日凌晨00:00之前入驻的商户的“进入事件”默认订阅，之后入驻的商户的“进入事件”<strong>默认不订阅</strong>。</li>
<li>2014年12月06日凌晨00:00之前入驻的商户的重试机制默认不打开，之后入驻的商户的重试机制默认打开。</li>
</ol>
</li>
<li>模板消息调用时，做了actionName及url的兼容：<ol>
<li>调用接口不再强校验url字段，如果未配置url字段，则点击不跳转，并且下方不显示“立即查看”等引导点击的内容；</li>
<li>调用接口不再强校验actionName字段，如果未配置actionName字段，则默认显示“立即查看”。</li>
</ol>
</li>
</ol>
<h3 id="c0104_20141120">2014/11/20 release note</h3>
<ol>
<li>接口兼容了OpenId和老的用户Id（2088开头的串）。比如用户完成支付后，开发者可以获取到老的用户Id（2088开头），商户可以使用其作为入参调用<a href="#c0403" seed="entryContent-linkT25" smartracker="on">单发模板消息接口</a>向该用户发送一条付款成功通知。以下接口都做了OpenId及老用户Id的兼容：<ol>
<li><a href="#c0401" seed="entryContent-linkT26" smartracker="on">异步单发消息</a></li>
<li><a href="#c0403" seed="entryContent-linkT27" smartracker="on">单发模板消息</a></li>
<li><a href="#c0502" seed="entryContent-linkT28" smartracker="on">获取用户地理位置</a></li>
</ol>
</li>
</ol>
<h3 id="c0104_20141130">2014/10/30 release note</h3>
<ol>
<li><a href="#c0503" seed="entryContent-linkT29" smartracker="on">网页授权获取用户基本信息</a>机制优化<ol>
<li>新增“基础授权”类型——商户<strong>无需</strong>申请账户信息共享接口权限也可以在网页上获取用户的OpenId，实现商户账号与支付宝服务窗账号的绑定、免登等业务逻辑，对于只需要用户OpenId的授权方式，无需经过用户授权直接跳转商家页面，详情<a href="#c0503" seed="entryContent-linkT30" smartracker="on">猛击此处</a></li>
<li>授权页面交互及视觉改版，默认不显示“取消”按钮，商户可以通过URL上带参数将“取消”按钮打开，用户点击“取消”跳转到商家页面时不会带auth_code这个参数，这种情况需要商户自己做好容错，详情<a href="#c0503_url_rule" seed="entryContent-linkT31" smartracker="on">猛击此处</a></li>
<li>在商家后台将“账户信息共享接口”的登录名（logonid，比如xxxx@gmail.com）及收货地址的申请入口关闭，开发者想要使用收货地址时，请使用我们的JSAPI调用方案，详情<a href="#c0504" seed="entryContent-linkT32" smartracker="on">猛击此处</a>，开发者可以在“支付宝未来商业”这个服务窗中的“申请开通-技术文档”菜单中查看所有的Demo</li>
</ol>
</li>
<li><a href="#c0403" seed="entryContent-linkT33" smartracker="on">模板消息开放申请</a><ol>
<li>模板消息是指如银行动帐提醒、航空公司值机提醒等对消费者非常有价值的消息类型，模板消息符合特定的格式，无需用户发生交互就可以主动向用户推送。</li>
<li>单发模板消息接口的权限已经向所有商家开放，模板的申请后台还在开发之中，当前有需要申请的请先对应商务合作经理，模板消息接口文档<a href="#c0403_example" seed="entryContent-linkT34" smartracker="on">猛击此处</a></li>
<li><a href="#c0403_example" seed="entryContent-linkT35" smartracker="on">猛击此处</a>可以查看模板消息的一个示例</li>
</ol>
</li>
<li><p><a href="#c1102" seed="entryContent-linkT36" smartracker="on">JSAPI Demo开放</a></p>
<ol>
<li>JSAPI用于增强商户H5的功能，比如商户可以通过调用photo JSAPI调起钱包的拍照组件。我们将特色的JSAPI打包成Demo合集，开放给所有开发者参考使用，详情<a href="#c1102" seed="entryContent-linkT37" smartracker="on">猛击此处</a></li>
<li><p>开发者可以在“支付宝未来商业”这个服务窗中的“申请开通-技术文档”菜单中查看所有的Demo</p>
<p><img alt="" src="44vguqpoxn.jpg" seed="entryContent-iIEcmngJpg20141244vGUqpOXN" smartracker="on" /></p>
</li>
</ol>
</li>
</ol>
<h1 id="c02">安全基础与接入</h1>
<h2 id="c0201">安全基础 - 生成公钥、私钥</h2>
<h3 id="c0201_intro">概述</h3>
<p>服务窗平台采用了RSA加密签名的安全通信机制，开发者可以通过支付宝的公钥验证消息的来源，同时使用自己的私钥进行信息加密。RSA算法及数字签名机制是服务窗平台与开发者网关安全通信的基础，如果开发者对RSA及数字签名并不熟悉，请先查阅相关资料。</p>
<h3 id="c0201_rsa">RSA密钥使用指南</h3>
<h4 id="c0201_openssl">OpenSSL工具安装</h4>
<ol>
<li><p>Linux用户（以Ubuntu为例）</p>
<pre><code> sudo apt-get install openssl
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
<li><p>Windows用户开发者可以在<a href="https://www.openssl.org/related/binaries.html" seed="entryContent-linkT38" smartracker="on" target="_blank">OpenSSL官方网站</a>下载Windows的OpenSSL安装包进行安装</p>
</li>
</ol>
<h4 id="c0201_rsa_gen">RSA私钥及公钥生成</h4>
<ol>
<li><p>Linux用户（以Ubuntu为例）</p>
<pre><code> $ openssl   进入OpenSSL程序
 OpenSSL&gt; genrsa -out rsa_private_key.pem 1024   生成私钥
 OpenSSL&gt; pkcs8 -topk8 -inform PEM -in rsa_private_key.pem -outform PEM -nocrypt     Java开发者需要将私钥转换成PKCS8格式
 OpenSSL&gt; rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem    生成公钥
 OpenSSL&gt; exit   </code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
<li><p>Windows用户
以下操作在cmd窗口使用</p>
<pre><code> C:\Users\Hammer&gt;cd C:\OpenSSL-Win32\bin     进入OpenSSL安装目录
 C:\OpenSSL-Win32\bin&gt;openssl.exe            进入OpenSSL程序
 OpenSSL&gt; genrsa -out rsa_private_key.pem 1024   生成私钥
 OpenSSL&gt; pkcs8 -topk8 -inform PEM -in rsa_private_key.pem -outform PEM -nocrypt     Java开发者需要将私钥转换成PKCS8格式
 OpenSSL&gt; rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem    生成公钥
 OpenSSL&gt; exit   </code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
</ol>
<p><strong>注意：对于使用Java的开发者，将pkcs8在console中输出的私钥去除头尾、换行和空格，作为开发者私钥，对于.NET和PHP的开发者来说，无需进行pkcs8命令行操作。</strong></p>
<h4 id="c0201_keyex">私钥及公钥文件示例</h4>
<p>经过以上步骤，开发者可以在当前文件夹中（Windows用户在C:\OpenSSL-Win32\bin）看到rsa_private_key.pem和rsa_public_key.pem两个文件，前者为私钥，后者为公钥。开发者将私钥保留，将公钥提交给支付宝网关，用于信息加密及解密。以下为使用OpenSSL生成的私钥文件和公钥文件示例。</p>
<ol>
<li><p>标准的私钥文件示例（PHP、.NET使用）</p>
<pre><code> -----BEGIN RSA PRIVATE KEY-----
 MIICXQIBAAKBgQC+L0rfjLl3neHleNMOsYTW8r0QXZ5RVb2p/vvY3fJNNugvJ7lo
 4+fdBz+LN4mDxTz4MTOhi5e2yeAqx+v3nKpNmPzC5LmDjhHZURhwbqFtIpZD51mO
 fno2c3MDwlrsVi6mTypbNu4uaQzw/TOpwufSLWF7k6p2pLoVmmqJzQiD0QIDAQAB
 AoGAakB1risquv9D4zX7hCv9MTFwGyKSfpJOYhkIjwKAik7wrNeeqFEbisqv35Fp
 jGq3Q1oJpGkem4pxaLVEyZOHONefZ9MGVChT/MNH5b0FJYWl392RZy8KCdq376Vt
 4gKVlABvaV1DkapL+nLh7LMo/bENudARsxD55IGObMU19lkCQQDwHmzWPMHfc3kd
 Y6AqiLrOss+MVIAhQqZOHhDe0aW2gZtwiWeYK1wB/fRxJ5esk1sScOWgzvCN/oGJ
 LhU3kipHAkEAysNoSdG2oWADxlIt4W9kUiiiqNgimHGMHPwp4JMxupHMTm7D9XtG
 UIiDijZxunHv3kvktNfWj3Yji0661zHVJwJBAM8TDf077F4NsVc9AXVs8N0sq3xz
 qwQD/HPFzfq6hdR8tVY5yRMb4X7+SX4EDPORKKsgnYcur5lk8MUi7r072iUCQQC8
 xQvUne+fcdpRyrR4StJlQvucogwjTKMbYRBDygXkIlTJOIorgudFlrKP/HwJDoY4
 uQNl8gQJb/1LdrKwIe7FAkBl0TNtfodGrDXBHwBgtN/t3pyi+sz7OpJdUklKE7zM
 SBuLd1E3O4JMzvWP9wEE7JDb+brjgK4/cxxUHUTkk592
 -----END RSA PRIVATE KEY-----
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
<li><p>PKCS8处理后的私钥文件示例（Java使用）</p>
<pre><code> -----BEGIN PRIVATE KEY-----
 MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBAN0yqPkLXlnhM+2H
 /57aHsYHaHXazr9pFQun907TMvmbR04wHChVsKVgGUF1hC0FN9hfeYT5v2SXg1WJ
 Sg2tSgk7F29SpsF0I36oSLCIszxdu7ClO7c22mxEVuCjmYpJdqb6XweAZzv4Is66
 1jXP4PdrCTHRdVTU5zR9xUByiLSVAgMBAAECgYEAhznORRonHylm9oKaygEsqQGk
 YdBXbnsOS6busLi6xA+iovEUdbAVIrTCG9t854z2HAgaISoRUKyztJoOtJfI1wJa
 QU+XL+U3JIh4jmNx/k5UzJijfvfpT7Cv3ueMtqyAGBJrkLvXjiS7O5ylaCGuB0Qz
 711bWGkRrVoosPM3N6ECQQD8hVQUgnHEVHZYtvFqfcoq2g/onPbSqyjdrRu35a7P
 vgDAZx69Mr/XggGNTgT3jJn7+2XmiGkHM1fd1Ob/3uAdAkEA4D7aE3ZgXG/PQqlm
 3VbE/+4MvNl8xhjqOkByBOY2ZFfWKhlRziLEPSSAh16xEJ79WgY9iti+guLRAMra
 vGrs2QJBAOmKWYeaWKNNxiIoF7/4VDgrcpkcSf3uRB44UjFSn8kLnWBUPo6WV+x1
 FQBdjqRviZ4NFGIP+KqrJnFHzNgJhVUCQFzCAukMDV4PLfeQJSmna8PFz2UKva8f
 vTutTryyEYu+PauaX5laDjyQbc4RIEMU0Q29CRX3BA8WDYg7YPGRdTkCQQCG+pjU
 2FB17ZLuKRlKEdtXNV6zQFTmFc1TKhlsDTtCkWs/xwkoCfZKstuV3Uc5J4BNJDkQ
 OGm38pDRPcUDUh2/
 -----END PRIVATE KEY-----
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
<li><p>公钥文件示例</p>
<pre><code> -----BEGIN PUBLIC KEY-----
 MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDQWiDVZ7XYxa4CQsZoB3n7bfxL
 DkeGKjyQPt2FUtm4TWX9OYrd523iw6UUqnQ+Evfw88JgRnhyXadp+vnPKP7unorm
 YQAfsM/CxzrfMoVdtwSiGtIJB4pfyRXjA+KL8nIa2hdQy5nLfgPVGZN4WidfUY/Q
 pkddCVXnZ4bAUaQjXQIDAQAB
 -----END PUBLIC KEY-----
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
</ol>
<h2 id="c0202">接入与验证</h2>
<h3 id="c0202_intro">概述</h3>
<p>开发者生成私钥、公钥之后，将公钥提交给服务窗平台，同时下载支付宝的公钥，使用OpenSSL的方式验证签名之后便可完成接入。</p>
<p>开发者使用接口之前需要激活开发者模式，请打开<a href="https://fuwu.alipay.com/platform/developerMode.htm" seed="entryContent-linkT39" smartracker="on" target="_blank">服务窗平台开发者模式</a>，点击下方的“激活开发者模式”按钮。</p>
<p>建议开发者使用支付宝提供的SDK进行服务窗开发，使用SDK进行开发有以下优点：</p>
<ol>
<li>SDK会随着新接口的发布而同步更新</li>
<li>SDK会随着老接口的更新而同步更新</li>
<li>SDK让底层逻辑变得透明和简单，开发者只需关注于自身的业务逻辑</li>
<li>SDK集成了编码、签名等常用方法，开发者无需额外耗费时间</li>
<li>提供了基于SDK开发的Demo，开发者上手更容易</li>
</ol>
<p>SDK下载：</p>
<ol>
<li><a href="http://openhome.alipay.com/doc/sdkDownload.resource?sdkType=JAVA" seed="entryContent-linkT40" smartracker="on" target="_blank">Java-JDK 1.5 SDK</a></li>
<li><a href="http://openhome.alipay.com/doc/sdkDownload.resource?sdkType=JDK14" seed="entryContent-linkT41" smartracker="on" target="_blank">Java-JDK 1.4 SDK</a></li>
<li><a href="http://openhome.alipay.com/doc/sdkDownload.resource?sdkType=PHP" seed="entryContent-PHP-SDK" smartracker="on" target="_blank">PHP SDK</a></li>
<li><a href="http://openhome.alipay.com/doc/sdkDownload.resource?sdkType=NET" seed="entryContent-linkT42" smartracker="on" target="_blank">.NET2010 SDK</a></li>
</ol>
<p>Demo下载：</p>
<ol>
<li><a href="https://i.alipayobjects.com/i/ecmng/zip/201408/Alipay%20Fuwuchuang%20Java%20JDK%201.5%20Demo.zip" seed="entryContent-linkT43" smartracker="on" target="_blank">Java-JDK 1.5 Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/zip/201408/Alipay%20Fuwuchuang%20Java%20JDK%201.4%20Demo.zip" seed="entryContent-linkT44" smartracker="on" target="_blank">Java-JDK 1.4 Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/zip/201409/Alipay%20Fuwuchuang%20PHP%20Demo%2020140925.zip" seed="entryContent-PHP-Demo" smartracker="on" target="_blank">PHP Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/zip/201411/Alipay%20Fuwuchuang%20DotNet%20Demo%2020141028.zip" seed="entryContent-linkT45" smartracker="on" target="_blank">.NET2010 Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/pdf/201502/msgDemos.pdf" seed="entryContent-linkT46" smartracker="on" target="_blank">服务窗消息Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/pdf/201502/labelDemos.pdf" seed="entryContent-linkT47" smartracker="on" target="_blank">标签组发接口Demo</a></li>
</ol>
<h3 id="c0202_form">填写开发者网关及开发者公钥</h3>
<p>开发者将网关地址填入开发者网关一栏。</p>
<p>开发者将公钥文件去除头尾、换行和空格后的字符串填入开发者公钥一栏。</p>
<pre><code>转换前pem文件格式：
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDQWiDVZ7XYxa4CQsZoB3n7bfxL
DkeGKjyQPt2FUtm4TWX9OYrd523iw6UUqnQ+Evfw88JgRnhyXadp+vnPKP7unorm
YQAfsM/CxzrfMoVdtwSiGtIJB4pfyRXjA+KL8nIa2hdQy5nLfgPVGZN4WidfUY/Q
pkddCVXnZ4bAUaQjXQIDAQAB
-----END PUBLIC KEY-----
转换后的字符串:
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDQWiDVZ7XYxa4CQsZoB3n7bfxLDkeGKjyQPt2FUtm4TWX9OYrd523iw6UUqnQ+Evfw88JgRnhyXadp+vnPKP7unormYQAfsM/CxzrfMoVdtwSiGtIJB4pfyRXjA+KL8nIa2hdQy5nLfgPVGZN4WidfUY/QpkddCVXnZ4bAUaQjXQIDAQAB
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>如下图所示：</p>
<p><img alt="填写开发者网关、开发者公钥" src="38oszgav1j.png" seed="entryContent-iIEcmngPng20140738OSZgAV1J" smartracker="on" /></p>
<h3 id="c0202_public">下载支付宝公钥</h3>
<p>点击“复制公钥”按钮，可以获取支付宝公钥，支付宝公钥是经过格式化之后的字符串，如果开发者需要使用pem文件进行验签，请<a href="https://i.alipayobjects.com/i/ecmng/zip/201407/alipay_openapi_public_key.pem.zip" seed="entryContent-linkT48" smartracker="on" target="_blank">点此下载</a>pem公钥文件。</p>
<pre><code>支付宝公钥：
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDDI6d306Q8fIfCOaTXyiUeJHkrIvYISRcc73s3vF1ZT7XN8RNPwJxo8pWaJMmvyTn9N4HQ632qJBVHf8sxHi/fEsraprwCtzvzQETrNRwVxLO5jVmRGi60j8Ue1efIlzPXV9je9mkjzOmdssymZkh2QhUrCmZYI/FCEa3/cNMW0QIDAQAB
PEM格式化后的支付宝公钥：
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDDI6d306Q8fIfCOaTXyiUeJHkr
IvYISRcc73s3vF1ZT7XN8RNPwJxo8pWaJMmvyTn9N4HQ632qJBVHf8sxHi/fEsra
prwCtzvzQETrNRwVxLO5jVmRGi60j8Ue1efIlzPXV9je9mkjzOmdssymZkh2QhUr
CmZYI/FCEa3/cNMW0QIDAQAB
-----END PUBLIC KEY-----
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h3 id="c0202_sign">使用支付宝公钥进行验签</h3>
<p>当开发者完成网关代码的部署之后，便可以点击“提交”按钮，激活开发者模式，接入服务窗平台。</p>
<p>此时，支付宝网关会向开发者网关发送一条验证消息，以POST方式请求，以下为一个请求示例：</p>
<pre><code>REQUEST URL: http://example.com/gateway.do
REQUEST METHOD: POST
CONTENT:
    service=alipay.service.check
    sign=ntjOmXFGJMdfdMnrTL5rEp9QG8d0lDEoGg3ZHvqemHeI8BlQoEsFbhEn0IfQT+pvfJz5RCuE+3Qh1X7I4z5iTIiGjDBstc0xeuiAmtP9TrJZuw2jUAODFB9qOwBJLNcWlKHUGTU/db/qRsJQCj8EjoJvSi9MRM/xKv/XmduS/C4=
    sign_type=RSA
    charset=GBK
    biz_content=&lt;?xml version="1.0" encoding="gbk"?&gt;&lt;XML&gt;&lt;AppId&gt;&lt;![CDATA[2014072300007148]]&gt;&lt;/AppId&gt;&lt;FromUserId&gt;&lt;/FromUserId&gt;&lt;CreateTime&gt;&lt;![CDATA[1406083506817]]&gt;&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;&lt;EventType&gt;&lt;![CDATA[verifygw]]&gt;&lt;/EventType&gt;&lt;ActionParam&gt;&lt;/ActionParam&gt;&lt;AgreementId&gt;&lt;/AgreementId&gt;&lt;AccountNo&gt;&lt;/AccountNo&gt;&lt;/XML&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>开发者接收到该消息之后，需要使用支付宝的公钥对签名作验证，以确保该消息来源可靠。</p>
<ol>
<li><p>将支付宝返回的POST参数(不包含sign参数)做字母排序，组成query类型的字符串，比如上文的POST请求组成的query类型字符串为：</p>
<pre><code> biz_content=&lt;?xml version="1.0" encoding="gbk"?&gt;&lt;XML&gt;&lt;AppId&gt;&lt;![CDATA[2014072300007148]]&gt;&lt;/AppId&gt;&lt;FromUserId&gt;&lt;/FromUserId&gt;&lt;CreateTime&gt;&lt;![CDATA[1406083506817]]&gt;&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;&lt;EventType&gt;&lt;![CDATA[verifygw]]&gt;&lt;/EventType&gt;&lt;ActionParam&gt;&lt;/ActionParam&gt;&lt;AgreementId&gt;&lt;/AgreementId&gt;&lt;AccountNo&gt;&lt;/AccountNo&gt;&lt;/XML&gt;&amp;charset=GBK&amp;service=alipay.service.check&amp;sign_type=RSA
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
<li><p>将签名参数使用base64解码为字节码串</p>
</li>
<li><p>使用OpenSSL的验签方法及支付宝公钥验证签名，以下为php代码的一个片段，其中<strong>$data</strong>为经过1排序处理后的query字符串，<strong>$rsaPublicKeyFilePath</strong>指支付宝公钥PEM文件的文件地址</p>
<pre><code> /* 使用支付宝的公钥对支付宝来的消息进行验签 */
 public function verify($data, $sign, $rsaPublicKeyFilePath) {

     /* 读取公钥文件，PEM格式 */    
     $pubKey = file_get_contents($rsaPublicKeyFilePath);

     /* 转换为openssl格式密钥 */
     $res = openssl_get_publickey($pubKey);

     /* 调用openssl内置方法验签 */
     $result = (bool) openssl_verify($data, base64_decode($sign), $res);

     /* 释放资源 */
     openssl_free_key($res);

     /* 返回验签结果 */
     return $result;
 }
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
</ol>
<h3 id="c0202_response">返回验签成功消息</h3>
<p>开发者验签成功之后，需要向支付宝网关回复一条消息，表示验签成功。支付宝收到符合规则的消息之后，开发者模式就激活了。以下为回复消息的格式（其中biz_content为开发者公钥）：</p>
<pre><code>&lt;?xml version="1.0" encoding="GBK"?&gt;
&lt;alipay&gt;
    &lt;response&gt;
        &lt;biz_content&gt;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDQWiDVZ7XYxa4CQsZoB3n7bfxLDkeGKjyQPt2FUtm4TWX9OYrd523iw6UUqnQ+Evfw88JgRnhyXadp+vnPKP7unormYQAfsM/CxzrfMoVdtwSiGtIJB4pfyRXjA+KL8nIa2hdQy5nLfgPVGZN4WidfUY/QpkddCVXnZ4bAUaQjXQIDAQAB&lt;/biz_content&gt;
        &lt;success&gt;true&lt;/success&gt;
    &lt;/response&gt;
    &lt;sign&gt;DXr8LVfHytoZ3RR0K95pzGtA3d9LdpjIjLEis2BDIPQisPwS+FMFxZt9NCMt531EeDj/nbzoIAz8Or7PuqxNfSzNI8qnhirm/Hvr8uedXX9JiQxHu8q3Rw2lJWD8cqQzgf3xwV/+wbN8yuI7s8xjo6odq6NCqrAIu7E0DDfZyKo=&lt;/sign&gt;
    &lt;sign_type&gt;RSA&lt;/sign_type&gt;
&lt;/alipay&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT49" smartracker="on">点此下载</a>）。</p>
<h2 id="c0203">消息交互体系</h2>
<h3 id="c0203_intro">概述</h3>
<p>支付宝网关与开发者的通信消息主要分为两类：</p>
<ol>
<li>开发者网关接收支付宝网关发送的消息(下文简称接收消息)</li>
<li>开发者网关主动调用支付宝网关接口(下文简称OpenAPI)</li>
</ol>
<p>在支付宝网关与开发者网关消息交互中传输的用户ID都是经过加密处理的OpenId，以保障用户隐私安全。</p>
<h3 id="c0203_push">接收消息</h3>
<p>当用户与服务窗发生交互时，支付宝网关会向开发者网关发送POST请求。比如，用户关注服务窗时，支付宝网关会向开发者网关发送一条关注事件消息。下文为一个示例：</p>
<pre><code>REQUEST URL: http://example.com/gateway.do
REQUEST METHOD: POST
CONTENT:
    sign=SSK/h9WV8H+ObDwOGEItQOGPocc4IgpRPHgwUZiSU2DSGNC2o+EsYm8ajJZ6EkEWcvKcVyPiUNU1p7vzjrhv/T+KJ1Z5+BFTJ3ibrCZaZppoMk47se5LjjTDUwaKDDAb2zmK85ZOTt+8LkB3MEiPG/kiYomud7r7kvnoRCEixbY=
    biz_content=&lt;XML&gt;&lt;AppId&gt;&lt;![CDATA[2014072300007148]]&gt;&lt;/AppId&gt;&lt;FromUserId&gt;&lt;![CDATA[CogmJcgdBQvCr1jdSWXmMul3JwoaXmLBrbkSty7ivP0SaOemwnUkRdOm5AITm38701]]&gt;&lt;/FromUserId&gt;&lt;CreateTime&gt;![CDATA[1406165628612]]&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;&lt;EventType&gt;&lt;![CDATA[follow]]&gt;&lt;/EventType&gt;&lt;ActionParam&gt;&lt;![CDATA[]]&gt;&lt;/ActionParam&gt;&lt;AgreementId&gt;&lt;![CDATA[]]&gt;&lt;/AgreementId&gt;&lt;AccountNo&gt;&lt;![CDATA[]]&gt;&lt;/AccountNo&gt;&lt;UserInfo&gt;&lt;![CDATA[{"logon_id":"135**1009","user_name":"*iuxu527"}]]&gt;&lt;/UserInfo&gt;&lt;/XML&gt;
    sign_type=RSA
    service=alipay.mobile.public.message.notify
    charset=GBK

注：所有请求参数需经过编码处理，本示例给出的是未经编码处理时的请求参数
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
<tr>
<td>biz_content</td>
<td>业务消息体内容，xml格式，不含换行、空格</td>
</tr>
<tr>
<td>sign_type</td>
<td>签名方式，目前只支持RSA</td>
</tr>
<tr>
<td>service</td>
<td>发起消息的支付宝接口名称</td>
</tr>
<tr>
<td>charset</td>
<td>消息编码，默认为GBK，开发者网关需要以该编码进行解码</td>
</tr>
</tbody>
</table>
<p>POST消息体的格式固定，后续将只介绍各类消息的service参数及biz_content参数，对整个消息体不再赘述。</p>
<p>当开发者网关接收到支付宝网关发送的推送消息时，需要向支付宝网关回复一条接收成功消息，告知支付宝网关消息接收成功（注意：请务必对支付宝推送的每条消息都作回复，否则支付宝网关会尝试做重试请求处理）。回复消息格式如下：</p>
<pre><code>&lt;?xml version="1.0" encoding="GBK"?&gt;
&lt;alipay&gt;
    &lt;response&gt;
        &lt;XML&gt;
            &lt;ToUserId&gt;&lt;![CDATA[aYMvrMC8+qdi3Mj1lqxRZJPUsrychFTewHXFVXq5ySDxWgIluiZN3K2r70Eebm4r01]]&gt;&lt;/ToUserId&gt;
            &lt;AppId&gt;&lt;![CDATA[2014042900005397]]&gt;&lt;/AppId&gt;
            &lt;CreateTime&gt;![CDATA[1406165628612]]&lt;/CreateTime&gt;
            &lt;MsgType&gt;&lt;![CDATA[ack]]&gt;&lt;/MsgType&gt;
        &lt;/XML&gt;
    &lt;/response&gt;
    &lt;sign&gt;djRg8yFRYRJfieP69uFIbJRXivOEwCBZFmfkwiPcoDGgLClm2+loZhRt61OsRICSKHrWFWmb3T5BYguwg0zWuahihEs7Zig270gkCTYVHMj5H0heo0WwQAUxtkBcguyGQSy23bh7Swzrho3l6xysKD3ZxHF1TrULrPTS19KHGvg=&lt;/sign&gt;
    &lt;sign_type&gt;RSA&lt;/sign_type&gt;
&lt;/alipay&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>sign_type固定为RSA，sign是对该消息体的签名，除此之外，response中的各项参数分别表示：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ToUserId</td>
<td>发送消息用户的OpenId</td>
</tr>
<tr>
<td>AppId</td>
<td>服务窗账号ID</td>
</tr>
<tr>
<td>CreateTime</td>
<td>消息发送时间</td>
</tr>
<tr>
<td>MsgType</td>
<td>固定为ack</td>
</tr>
</tbody>
</table>
<h3 id="c0203_openapi">OpenAPI</h3>
<p>服务窗平台开放了众多的OpenAPI供开发者主动调用，开发者可以在<a href="https://fuwu.alipay.com/platform/developerMode.htm" seed="entryContent-linkT50" smartracker="on" target="_blank">服务窗平台-&gt;开发者模式</a>中申请接口权限。</p>
<h4 id="c0203_openapi_post">POST消息体</h4>
<p>开发者网关可以向支付宝网关发送POST消息，主动调用支付宝OpenAPI，以下为开发者调用创建菜单API时发送的POST消息：</p>
<pre><code>REQUEST URL: https://openapi.alipay.com/gateway.do
REQUEST METHOD: POST
CONTENT:
    app_id=2014072300007148
    method=alipay.mobile.public.menu.add
    charset=GBK
    sign_type=RSA
    timestamp=2014-07-24 03:07:50
    biz_content={"button":[{"actionParam":"ZFB_HFCZ","actionType":"out","name":"话费充值"},{"name":"查询","subButton":[{"actionParam":"ZFB_YECX","actionType":"out","name":"余额查询"},{"actionParam":"ZFB_LLCX","actionType":"out","name":"流量查询"},{"actionParam":"ZFB_HFCX","actionType":"out","name":"话费查询"}]},{"actionParam":"http://m.alipay.com","actionType":"link","name":"最新优惠"}]}
    sign=e9zEAe4TTQ4LPLQvETPoLGXTiURcxiAKfMVQ6Hrrsx2hmyIEGvSfAQzbLxHrhyZ48wOJXTsD4FPnt+YGdK57+fP1BCbf9rIVycfjhYCqlFhbTu9pFnZgT55W+xbAFb9y7vL0MyAxwXUXvZtQVqEwW7pURtKilbcBTEW7TAxzgro=
    version=1.0
    auth_token=publicpB9ea460ff5b5c468c9ccf5e967dc34963 /* 注：只有在使用OAuth 2.0授权的接口上有此参数 */

注：所有请求参数需经过编码处理，本示例给出的是未经编码时的请求参数
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_id</td>
<td>开发者服务窗的AppId</td>
</tr>
<tr>
<td>method</td>
<td>支付宝OpenAPI接口名称</td>
</tr>
<tr>
<td>charset</td>
<td>消息编码，默认为GBK，开发者网关需要以该编码进行解码</td>
</tr>
<tr>
<td>sign_type</td>
<td>签名方式，目前只支持RSA</td>
</tr>
<tr>
<td>timestamp</td>
<td>发送消息的时间，格式如2014-07-24 03:07:50</td>
</tr>
<tr>
<td>biz_content</td>
<td>消息体内容，JSON格式，不含换行、空格</td>
</tr>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
<tr>
<td>version</td>
<td>接口版本号，默认为1.0</td>
</tr>
<tr>
<td>auth_token</td>
<td>只有在使用OAuth 2.0授权的接口上有此参数，比如<a href="#c0503_userinfo" seed="entryContent-linkT51" smartracker="on">获取用户信息接口</a></td>
</tr>
</tbody>
</table>
<p>POST消息体的格式固定，后续将只介绍各类OpenAPI调用的method参数及biz_content参数，对整个消息体不再赘述。</p>
<h4 id="c0203_openapi_sign">消息签名</h4>
<p>在POST消息体中的sign参数是由开发者使用自己的私钥对参数进行签名产生的，签名的方法：</p>
<ol>
<li><p>将所有POST参数（sign除外）进行字典排序，组成字符串，如：</p>
<pre><code> app_id=2014072300007148&amp;biz_content={"button":[{"actionParam":"ZFB_HFCZ","actionType":"out","name":"话费充值"},{"name":"查询","subButton":[{"actionParam":"ZFB_YECX","actionType":"out","name":"余额查询"},{"actionParam":"ZFB_LLCX","actionType":"out","name":"流量查询"},{"actionParam":"ZFB_HFCX","actionType":"out","name":"话费查询"}]},{"actionParam":"http://m.alipay.com","actionType":"link","name":"最新优惠"}]}&amp;charset=GBK&amp;method=alipay.mobile.public.menu.add&amp;sign_type=RSA&amp;timestamp=2014-07-24 03:07:50&amp;version=1.0
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
<li><p>使用OpenSSL的加密算法对以上字符串进行签名并进行Base64编码，以下为php代码的签名函数代码片段，供参考：</p>
<pre><code> /* 签名 */
 private function sign($data, $rsaPrivateKey) {

     /* 获取私钥PEM文件内容，$rsaPrivateKey是指向私钥PEM文件的路径 */
     $priKey = file_get_contents($rsaPrivateKey);

     /* 从PEM文件中提取私钥 */
     $res = openssl_get_privatekey($priKey);

     /* 对数据进行签名 */
     openssl_sign($data, $sign, $res);

     /* 释放资源 */
     openssl_free_key($res);

     /* 对签名进行Base64编码，变为可读的字符串 */
     $sign = base64_encode($sign);

     return $sign;                                                                                                
 }
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
</ol>
<h4 id="c0203_openapi_response">返回值</h4>
<p>支付宝网关接收到开发者网关消息后，无论成功还是失败，都会回复一条JSON消息。JSON消息有两个属性，第一个属性标明是哪个接口的回复消息。比如调用"alipay.mobile.public.menu.add"，回复的JSON消息的第一个属性名为"alipay_mobile_public_menu_add_response"。</p>
<p>以下为创建菜单成功的一条回复消息： </p>
<pre><code>{
    "alipay_mobile_public_menu_add_response": {
        "code": 200,
        "msg": "成功"
    },
    "sign": "oi7sKzfEu6Jh/UwlPXc4+/AIugIGPiXZJfVWvvSbLU/Jj2ET5TPQEj2/41z8VQ/0pQppJp4yEITadsOKX5rf92kqO6vVnD1y+k9Eq5qQU2iy2YM1lXfBJRekPlsUy2aaDElbrHXYY8CQwQgOeQgv3WL+MukrFs2+syqnnX7ugjI="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>以下为创建菜单失败的一条回复消息：</p>
<pre><code>{
    "alipay_mobile_public_menu_add_response": {
        "code": 11013,
        "msg": "菜单已经创建过"
    },
    "sign": "d9ob0/1Fz0mmrG7fSSp61O3OZurTXOv9uljPU84GlgEZ0oZicIbRQNPJElUo6eLU5rJyh8CdYz14Fvn3ouzzh9FZ/ao6TvUpilmBTOi8hRO026ziV2L6HhUkvyIjnXjBFQqsX0yKlrQuv4fLwNt1lwUQwcOzEEr2Smo7/l9mCn8="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h2 id="c0204">事件订阅与重试机制</h2>
<h3 id="c0204_event_subscribe">事件订阅</h3>
<h4 id="c0204_event_subscribe_intro">概述</h4>
<p>开发者可以根据业务需要选择性订阅支付宝网关推送的事件消息，从而简化业务模型，降低服务器负载。我们提供的所有事件消息详见<a href="#c03" seed="entryContent-linkT52" smartracker="on">接收消息</a>。</p>
<p>2014年12月06日凌晨00:00之前入驻的商户的“进入事件”默认订阅，之后入驻的商户的“进入事件”<strong>默认不订阅</strong>。</p>
<h4 id="c0204_event_subscribe_setup">设置</h4>
<ol>
<li>进入<a href="https://fuwu.alipay.com/platform/developerMode.htm" seed="entryContent-linkT53" smartracker="on" target="_blank">商家后台-开发者</a>，找到“事件订阅与重试机制”；</li>
<li>点击“设置”按钮，在弹出的浮层上选择需要订阅的事件消息，去除不需要订阅的事件消息，点击“确定”即可完成订阅；
<img alt="" src="3wdyihruf1.jpg" seed="entryContent-iIEcmngJpg2014123wdYIhRUf1" smartracker="on" /></li>
<li>订阅完成之后立即生效，支付宝网关不再向开发者网关发送取消订阅的事件消息，比如取消订阅了图片消息，用户在服务窗中发送图片消息时，支付宝网关不再通知开发者网关；</li>
<li>菜单点击事件及接入验证消息为特殊事件，不能取消订阅。</li>
</ol>
<h3 id="c0204_retry">重试机制</h3>
<h4 id="c0204_retry_intro">概述</h4>
<p>重试机制可以防止因网络抖动等原因造成的事件消息丢失，开启后支付宝将对发送失败的消息重试2次，每次间隔5秒。</p>
<p>2014年12月06日凌晨00:00之前入驻的商户的重试机制默认打开，之后入驻的商户的重试机制默认不打开。</p>
<p>注：对于开启重试机制的开发者，支付宝投递事件消息的XML中会增加MsgId字段，如<msgid>&lt;![CDATA[20a3e2165d0948a39a88b853dee4ea5a]]&gt;</msgid>，用于标识该消息的Id，重试的消息的MsgId不变，用于商户做消息重排，避免发生因为网络抖动及重试机制而造成的同一逻辑执行多次的问题。未开启重试机制的商户的消息中不含该字段。</p>
<h4 id="c0204_retry_setup">设置</h4>
<ol>
<li>进入<a href="https://fuwu.alipay.com/platform/developerMode.htm" seed="entryContent-linkT54" smartracker="on" target="_blank">商家后台-开发者</a>，找到“事件订阅与重试机制”；</li>
<li>如果尚未开启重试机制，点击“点击开启”按钮会弹出“确定开启重试机制”对话框，点击确定即可开启重试机制；
<img alt="" src="3wdqax2obr.jpg" seed="entryContent-iIEcmngJpg2014123wdqaX2oBr" smartracker="on" /></li>
<li>如果已经开启重试机制，想要关闭，点击“点击关闭”按钮会弹出“确定关闭重试机制”对话框，点击确定即可关闭重试机制；</li>
<li>重试机制设置完毕后立即生效。</li>
<li>菜单点击事件及接入验证消息不作重试。</li>
</ol>
<h2 id="c0205">数据接口与OAuth 2.0授权机制</h2>
<p>服务窗涉及用户信息的数据类接口采用标准的OAuth 2.0授权流程：</p>
<ol>
<li>开发者申请接口权限，比如在商户后台申请<a href="#c0503" seed="entryContent-linkT55" smartracker="on">账户信息共享接口</a>的权限</li>
<li>按照规则拼接授权页面的链接</li>
<li>用户访问授权页面，并且授权成功</li>
<li>开发者调用接口，获取用户信息，完成业务流程<ul>
<li>获取授权码：引导用户进入授权页面并同意授权，在回跳页面上开发者可获取到auth_code；</li>
<li>换取授权访问令牌：通过auth_code换取网页授权access_token及<strong>用户的OpenId</strong>；</li>
<li>获取用户信息：使用access_token调用相应接口，获取用户信息。</li>
</ul>
</li>
</ol>
<p><strong>注1：用户授权成功后180天内无需再次授权，除非用户主动取消关注开发者的服务窗</strong></p>
<p><strong>注2：如果开发者只需要获取用户OpenId，可以参考<a href="#c0205_openid_only" seed="entryContent-linkT56" smartracker="on">特例：网页获取用户OpenId</a>方案，该方案无需经过用户授权</strong></p>
<p><img alt="" src="4t579o8ep3.jpg" seed="entryContent-iIEcmngJpg2015024T579O8Ep3" smartracker="on" /></p>
<div id="c0503_url_rule"></div><h3 id="c0205_combine">第一步：URL拼接方案与组合授权</h3>
<blockquote>
<p>url拼接规则：<a href="https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=APPID&amp;auth_skip=IS_SKIP&amp;scope=SCOPE&amp;redirect_uri=ENCODED_URL" seed="entryContent-linkT57" smartracker="on" target="_blank">https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=APPID&amp;auth_skip=IS_SKIP&amp;scope=SCOPE&amp;redirect_uri=ENCODED_URL</a> </p>
<p>使用场景举例：开发者通过URL拼接方案，构造授权页面。支持用户单次对多个接口进行组合授权。</p>
</blockquote>
<p>url参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_id</td>
<td>是</td>
<td>开发者服务窗的AppId</td>
</tr>
<tr>
<td>scope</td>
<td>是</td>
<td>接口权限值，以英文逗号分隔，支持单次对多个接口进行组合授权的方案，下文<a href="#c0205_scope" seed="entryContent-linkT58" smartracker="on">scope字段详解</a>有详细说明</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>是</td>
<td>回跳页面，是<strong>经过转义</strong>的url链接（url必须以http或者https开头），比如：http%3A%2F%2Fexample.com</td>
</tr>
<tr>
<td>auth_skip</td>
<td>否</td>
<td>bool值，true表示在授权页面"确定"按钮下方带上"跳过"按钮，点击后进入回跳页面，但是不带有auth_code，需开发者容错，效果见下图；false表示不显示"确定"按钮下方的"跳过"按钮。auth_skip默认为false</td>
</tr>
</tbody>
</table>
<p><img alt="" src="3kmwliwhsb.jpg" seed="entryContent-iIEcmngJpg2014113kmWlIWHsb" smartracker="on" /></p>
<p>当用户在授权页面点击"确定"按钮后，会跳转至开发者定义的回跳页面，支付宝会在回跳页面请求中加入参数，包括auth_code，app_id，scope等，需要注意的是支付宝仅保证auth_code，app_id以及scope参数的有效性。支付宝请求开发者Web页面示例如下：</p>
<pre><code>http://example.com/doc/toAuthPage.html?app_id=2014101500013658&amp;source=alipay_wallet&amp;scope=auth_userinfo&amp;auth_code=ca34ea491e7146cc87d25fca24c4cD11 
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h4 id="c0205_scope">scope字段详解</h4>
<p>scope字段支持单接口授权及多接口组合授权。目前已经开放的接口及权限值包括：</p>
<table>
<thead>
<tr>
<th>接口</th>
<th>权限值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>账户信息共享接口</td>
<td>auth_userinfo</td>
<td>获取用户城市、地址、姓名、手机号、身份证等信息，详见<a href="#c0503" seed="entryContent-linkT59" smartracker="on">账户信息共享接口</a></td>
</tr>
<tr>
<td>通讯录信息接口</td>
<td>auth_contact</td>
<td>获取用户的手机通讯录信息，详见<a href="#c0505" seed="entryContent-linkT60" smartracker="on">通讯录信息接口</a></td>
</tr>
</tbody>
</table>
<pre><code>示例一：获取账户信息共享接口权限
https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=2014071800007108&amp;auth_skip=false&amp;scope=auth_userinfo&amp;redirect_uri=http%3A%2F%2Fexample.com

示例二：获取通讯录信息接口权限
https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=2014071800007108&amp;auth_skip=false&amp;scope=auth_contact&amp;redirect_uri=http%3A%2F%2Fexample.com

示例三：获取账户信息共享接口、通讯录信息接口权限
https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=2014071800007108&amp;auth_skip=false&amp;scope=auth_userinfo,auth_contact&amp;redirect_uri=http%3A%2F%2Fexample.com
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h3 id="c0205_get_token">第二步：使用auth_code换取接口访问令牌及用户OpenId</h3>
<blockquote>
<p>接口名称：alipay.system.oauth.token</p>
<p>换取授权访问令牌，开发者可通过获取到的auth_code换取access_token和用户OpenId。auth_code作为换取access_token的票据，每次用户授权带上的auth_code将不一样，auth_code只能使用一次，一天未被使用自动过期。access_token的过期时间为5分钟。</p>
</blockquote>
<h4 id="c0205_auth_content">业务消息内容</h4>
<p>获取授权访问令牌的请求格式与<a href="#c0203" seed="entryContent-linkT61" smartracker="on">消息交互体系</a>中有所差别，grant_type、code以及refresh_token直接作为POST消息的参数，而不存在于biz_content参数之中，以下为一个请求的示例</p>
<pre><code>REQUEST URL: https://openapi.alipay.com/gateway.do
REQUEST METHOD: POST
CONTENT:
    app_id=2014070100171525
    method=alipay.system.oauth.token
    charset=GBK
    sign_type=RSA
    timestamp=2014-01-01 08:08:08
    sign=rXaTEfJ7WTDsP1DWRPHARW3uOr19+fzlngMCJBvbhP1XPEa9qZwGGng9oMDloABpJMT2SGeOj46+BUkqCGRO9fH90Vci3hOH01BfYnbhJz3ADK2h7gpjlponx4/sxELN6f2GXi51XKiHKnxMA9XpLLo68q+roY0M/ZFQ1UdnqeM=
    version=1.0
    grant_type=authorization_code
    code=4b203fe6c11548bcabd8da5bb087a83b
    refresh_token=201208134b203fe6c11548bcabd8da5bb087a83b
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>grant_type</td>
<td>是</td>
<td>授权类型，固定为authorization_code</td>
</tr>
<tr>
<td>code</td>
<td>是</td>
<td>授权码，用户对应用授权后得到，即第一步中开发者获取到auth_code值</td>
</tr>
<tr>
<td>refresh_token</td>
<td>否</td>
<td>可为空，刷新令牌时使用，失效时间300秒，上次换取得到的访问令牌</td>
</tr>
</tbody>
</table>
<h4 id="c0205_auth_response">同步响应结果</h4>
<pre><code>{
    "alipay_system_oauth_token_response": {
        "access_token": "publicpBa869cad0990e4e17a57ecf7c5469a4b2",
        "alipay_user_id": "CogmJcgdBQvCr1jdSWXmMul3JwoaXmLBrbkSty7ivP0SaOemwnUkRdOm5AITm38701",
        "expires_in": 300,
        "re_expires_in": 300,
        "refresh_token": "publicpB0ff17e364f0743c79b0b0d7f55e20bfc"
    },
    "sign": "xDffQVBBelDiY/FdJi4/a2iQV1I7TgKDFf/9BUCe6+l1UB55YDOdlCAir8CGlTfa0zLYdX0UaYAa43zY2jLhCTDG+d6EjhCBWsNY74yTdiM95kTNsREgAt4PkOkpsbyZVXdLIShxLFAqI49GIv82J3YtzBcVDDdDeqFcUhfasII="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>alipay_system_oauth_token_response</td>
<td>换取授权访问令牌内容</td>
</tr>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
<tr>
<td>access_token</td>
<td>交换令牌，用于获取用户信息</td>
</tr>
<tr>
<td>alipay_user_id</td>
<td>当前用户的OpenId</td>
</tr>
<tr>
<td>expires_in</td>
<td>令牌有效期，交换令牌的有效期，单位秒</td>
</tr>
<tr>
<td>re_expires_in</td>
<td>刷新令牌有效期，单位秒</td>
</tr>
<tr>
<td>refresh_token</td>
<td>刷新令牌时使用，失效时间300秒，上次换取得到的访问令牌</td>
</tr>
</tbody>
</table>
<h3 id="c0205_api_call">第三步：调用接口获取信息</h3>
<p>成功获取access_token之后，开发者可以调用相应的接口，获取用户的信息。接口调用方法详见<a href="#c0503" seed="entryContent-linkT62" smartracker="on">账户信息共享接口</a>及<a href="#c0505" seed="entryContent-linkT63" smartracker="on">通讯录信息接口</a>。</p>
<h3 id="c0205_openid_only">特例：网页获取用户OpenId</h3>
<blockquote>
<p>url拼接规则：<a href="https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=APPID&amp;auth_skip=false&amp;scope=auth_base&amp;redirect_uri=ENCODED_URL" seed="entryContent-linkT64" smartracker="on" target="_blank">https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=APPID&amp;auth_skip=false&amp;scope=auth_base&amp;redirect_uri=ENCODED_URL</a> </p>
<p>开发者在很多业务场景之下，只需获取用户的OpenId即可完成账号绑定、免登等业务逻辑。开发者使用此方案获取用户OpenId时，<strong>无需经过用户授权，也无需申请任何其他的接口权限。</strong></p>
</blockquote>
<p>url参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_id</td>
<td>是</td>
<td>开发者服务窗的AppId</td>
</tr>
<tr>
<td>scope</td>
<td>是</td>
<td>固定为auth_base</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>是</td>
<td>回跳页面，是<strong>经过转义</strong>的url链接（url必须以http或者https开头），比如：http%3A%2F%2Fexample.com</td>
</tr>
<tr>
<td>auth_skip</td>
<td>是</td>
<td>固定为false</td>
</tr>
</tbody>
</table>
<p>页面跳转至商户指定的redirect_uri时，商户直接使用auth_code通过<a href="#c0205_get_token" seed="entryContent-linkT65" smartracker="on">第二步：使用auth_code换取接口访问令牌及用户OpenId</a>方法即可获得用户的OpenId。</p>
<h1 id="c03">接收消息</h1>
<h2 id="c0301">开发者接入验证消息</h2>
<h3 id="c0301_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.service.check</p>
<p>使用场景举例：开发者开通开发者模式时支付宝网关向开发者网关发送验证消息。</p>
</blockquote>
<p>开发者如何回复该消息详见<a href="#c0202_response" seed="entryContent-linkT66" smartracker="on">接入与验证</a></p>
<h3 id="c0301_content">业务消息内容</h3>
<p>支付宝网关发送的POST消息中biz_content的内容示例如下：</p>
<pre><code>&lt;?xml version="1.0" encoding="gbk"?&gt;
&lt;XML&gt;
    &lt;AppId&gt;&lt;![CDATA[2014072300007148]]&gt;&lt;/AppId&gt;
    &lt;FromUserId&gt;&lt;/FromUserId&gt;
    &lt;CreateTime&gt;&lt;![CDATA[1406083506817]]&gt;&lt;/CreateTime&gt;
    &lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;
    &lt;EventType&gt;&lt;![CDATA[verifygw]]&gt;&lt;/EventType&gt;
    &lt;ActionParam&gt;&lt;/ActionParam&gt;
    &lt;AgreementId&gt;&lt;/AgreementId&gt;
    &lt;AccountNo&gt;&lt;/AccountNo&gt;
&lt;/XML&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>AppId</td>
<td>是</td>
<td>服务窗账号ID</td>
</tr>
<tr>
<td>FromUserId</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>CreateTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>MsgType</td>
<td>是</td>
<td>消息类型，事件类消息固定为event</td>
</tr>
<tr>
<td>EventType</td>
<td>是</td>
<td>事件类型，固定为verifygw</td>
</tr>
<tr>
<td>ActionParam</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>AgreementId</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>AccountNo</td>
<td>是</td>
<td>空值</td>
</tr>
</tbody>
</table>
<div id="alipay.mobile.public.message.notify"></div><h2 id="c0302">事件消息</h2>
<h3 id="c0302_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.message.notify</p>
<p>使用场景举例：接收用户操作事件通知，例如关注服务窗、菜单点击等，开发者可以使用<a href="#c0401" seed="entryContent-linkT67" smartracker="on">异步发送消息</a>功能向用户回复消息，实现诸如查询余额，推送最新优惠消息等业务逻辑</p>
<p>注：如果开发者开启了“重试机制”（2014年12月06日凌晨00:00入驻的商家默认开启），支付宝投递事件消息的XML中会增加MsgId字段，如<msgid>&lt;![CDATA[20a3e2165d0948a39a88b853dee4ea5a]]&gt;</msgid>，用于标识该消息的Id，重试的消息的MsgId不变，用于商户做消息重排，避免发生因为网络抖动及重试机制而造成的同一逻辑执行多次的问题。未开启重试机制的商户的消息中不含该字段。详见<a href="#c0204_retry" seed="entryContent-linkT68" smartracker="on">重试机制</a></p>
</blockquote>
<p>用户在与服务窗账号交互过程中会产生以下4种事件：</p>
<ol>
<li>关注事件     - 用户关注服务窗</li>
<li>取消关注事件 - 用户取消关注服务窗</li>
<li>进入事件     - 用户进入服务窗页面，包括用户点击和扫码二维码等方式进入服务窗</li>
<li>菜单点击事件     - 用户点击某个菜单项</li>
</ol>
<p>当开发者网关接收消息成功之后，请回复一条接收成功消息，详见<a href="#c0203" seed="entryContent-linkT69" smartracker="on">消息交互体系</a></p>
<h3 id="c0302_content">业务消息内容</h3>
<h4 id="c0302_follow_unfollow">关注与取消关注事件</h4>
<p>支付宝网关向开发者网关发送的POST消息中biz_content的内容示例如下：</p>
<pre><code>&lt;XML&gt;
    &lt;AppId&gt;&lt;![CDATA[2014070100171523]]&gt;&lt;/AppId&gt;
    &lt;FromUserId&gt;&lt;![CDATA[R8qtKrh1dS49uWaLZUbPr0re8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01]]&gt;&lt;/FromUserId&gt;
    &lt;CreateTime&gt;&lt;![CDATA[1405943673657]]&gt;&lt;/CreateTime&gt;
    &lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;
    &lt;EventType&gt;&lt;![CDATA[follow]]&gt;&lt;/EventType&gt;
    &lt;ActionParam&gt;&lt;![CDATA[{"scene":{"sceneId": "1234"}}]]&gt;&lt;/ActionParam&gt;
    &lt;AgreementId&gt;&lt;![CDATA[]]&gt;&lt;/AgreementId&gt;
    &lt;AccountNo&gt;&lt;![CDATA[]]&gt;&lt;/AccountNo&gt;
    &lt;UserInfo&gt;&lt;![CDATA[{"logon_id":"135****1009","user_name":"*iuxu527"}]]&gt;&lt;/UserInfo&gt;
&lt;/XML&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>AppId</td>
<td>是</td>
<td>服务窗账号ID</td>
</tr>
<tr>
<td>FromUserId</td>
<td>是</td>
<td>用户OpenId</td>
</tr>
<tr>
<td>CreateTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>MsgType</td>
<td>是</td>
<td>消息类型，事件类消息固定为event</td>
</tr>
<tr>
<td>EventType</td>
<td>是</td>
<td>事件类型。follow：关注事件；unfollow：取消关注事件</td>
</tr>
<tr>
<td>ActionParam</td>
<td>是</td>
<td>用户从特定场景（比如扫描开发者自定义的二维码，或者点击带参短链接）关注服务窗时，值为开发者自定义参数，详见<a href="#c0701" seed="entryContent-linkT70" smartracker="on">带参推广二维码</a>以及<a href="#c0702" seed="entryContent-linkT71" smartracker="on">带参推广短链接</a></td>
</tr>
<tr>
<td>AgreementId</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>AccountNo</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>MsgId</td>
<td>否</td>
<td>消息Id，用于消息去重，开启了<a href="#c0204_retry" seed="entryContent-linkT72" smartracker="on">重试机制</a>才会有这个字段</td>
</tr>
<tr>
<td>UserInfo</td>
<td>是</td>
<td>支付宝的用户信息，JSON格式，包含加星的用户账号及加星的用户名</td>
</tr>
</tbody>
</table>
<p>UserInfo的一个示例：</p>
<pre><code>{
  "logon_id": "135**1009",
  "user_name": "*iuxu527"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT73" smartracker="on">点此下载</a>）。</p>
<h4 id="c0302_enter">进入事件</h4>
<p>注：2014年12月06日凌晨00:00及之后入驻的商家进入事件<strong>默认不订阅</strong>，开发者可以通过<a href="#c0204_event_subscribe_setup" seed="entryContent-linkT74" smartracker="on">事件订阅</a>功能订阅该事件。</p>
<p>支付宝网关向开发者网关发送的POST消息中biz_content的内容示例如下：</p>
<pre><code>&lt;XML&gt;
    &lt;AppId&gt;&lt;![CDATA[2014070100171523]]&gt;&lt;/AppId&gt;
    &lt;FromUserId&gt;&lt;![CDATA[R8qtKrh1dS49uWaLZUbPr0re8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01]]&gt;&lt;/FromUserId&gt;
    &lt;CreateTime&gt;&lt;![CDATA[1405943673657]]&gt;&lt;/CreateTime&gt;
    &lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;
    &lt;EventType&gt;&lt;![CDATA[enter]]&gt;&lt;/EventType&gt;
    &lt;ActionParam&gt;&lt;![CDATA[{"scene":{"sceneId": "1234"}}]]&gt;&lt;/ActionParam&gt;
    &lt;AgreementId&gt;&lt;![CDATA[]]&gt;&lt;/AgreementId&gt;
    &lt;AccountNo&gt;&lt;![CDATA[]]&gt;&lt;/AccountNo&gt;
    &lt;UserInfo&gt;&lt;![CDATA[{"logon_id":"135****1009","user_name":"*iuxu527"}]]&gt;&lt;/UserInfo&gt;
&lt;/XML&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>AppId</td>
<td>是</td>
<td>服务窗账号ID</td>
</tr>
<tr>
<td>FromUserId</td>
<td>是</td>
<td>用户OpenId</td>
</tr>
<tr>
<td>CreateTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>MsgType</td>
<td>是</td>
<td>消息类型，事件类消息固定为event</td>
</tr>
<tr>
<td>EventType</td>
<td>是</td>
<td>事件类型，固定为enter</td>
</tr>
<tr>
<td>ActionParam</td>
<td>是</td>
<td>用户从特定场景（比如扫描开发者自定义的二维码，或者点击带参短链接）进入服务窗时，值为开发者自定义参数，详见<a href="#c0701" seed="entryContent-linkT75" smartracker="on">带参推广二维码</a>以及<a href="#c0702" seed="entryContent-linkT76" smartracker="on">带参推广短链接</a></td>
</tr>
<tr>
<td>AgreementId</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>AccountNo</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>MsgId</td>
<td>否</td>
<td>消息Id，用于消息去重，开启了<a href="#c0204_retry" seed="entryContent-linkT77" smartracker="on">重试机制</a>才会有这个字段</td>
</tr>
<tr>
<td>UserInfo</td>
<td>是</td>
<td>支付宝的用户信息，JSON格式，包含加星的用户账号及加星的用户名</td>
</tr>
</tbody>
</table>
<p>以下为二维码扫码进入场景enter事件中ActionParam示例，二维码生成方法详见<a href="#c0701" seed="entryContent-linkT78" smartracker="on">带参推广二维码</a>，开发者可以通过匹配sceneId的方法，使用<a href="#c0401" seed="entryContent-linkT79" smartracker="on">异步单发消息</a>接口发送服务内容：</p>
<pre><code>{
    "scene": {
        "sceneId": "1234"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT80" smartracker="on">点此下载</a>）。</p>
<h4 id="c0302_click">菜单点击事件</h4>
<p>菜单分为事件型菜单和链接型菜单，详见<a href="#c0601_cate" seed="entryContent-linkT81" smartracker="on">自定义菜单-菜单类型</a>，用户点击事件型菜单时，支付宝网关向开发者网关发送的POST消息中biz_content的内容示例如下：</p>
<pre><code>&lt;XML&gt;
    &lt;AppId&gt;&lt;![CDATA[2014070100171523]]&gt;&lt;/AppId&gt;
    &lt;FromUserId&gt;&lt;![CDATA[R8qtKrh1dS49uWaLZUbPr0re8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01]]&gt;&lt;/FromUserId&gt;
    &lt;CreateTime&gt;&lt;![CDATA[1405943673657]]&gt;&lt;/CreateTime&gt;
    &lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;
    &lt;EventType&gt;&lt;![CDATA[click]]&gt;&lt;/EventType&gt;
    &lt;ActionParam&gt;&lt;![CDATA[test_menu_key]]&gt;&lt;/ActionParam&gt;
    &lt;AgreementId&gt;&lt;![CDATA[]]&gt;&lt;/AgreementId&gt;
    &lt;AccountNo&gt;&lt;![CDATA[]]&gt;&lt;/AccountNo&gt;
    &lt;UserInfo&gt;&lt;![CDATA[{"logon_id":"135****1009","user_name":"*iuxu527"}]]&gt;&lt;/UserInfo&gt;
&lt;/XML&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>AppId</td>
<td>是</td>
<td>服务窗账号ID</td>
</tr>
<tr>
<td>FromUserId</td>
<td>是</td>
<td>用户OpenId</td>
</tr>
<tr>
<td>CreateTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>MsgType</td>
<td>是</td>
<td>消息类型，事件类消息固定为event</td>
</tr>
<tr>
<td>EventType</td>
<td>是</td>
<td>事件类型，固定为click</td>
</tr>
<tr>
<td>ActionParam</td>
<td>是</td>
<td>行为参数，菜单中设置的actionParam值，详见<a href="#c0602" seed="entryContent-linkT82" smartracker="on">创建菜单</a></td>
</tr>
<tr>
<td>AgreementId</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>AccountNo</td>
<td>是</td>
<td>空值</td>
</tr>
<tr>
<td>MsgId</td>
<td>否</td>
<td>消息Id，用于消息去重，开启了<a href="#c0204_retry" seed="entryContent-linkT83" smartracker="on">重试机制</a>才会有这个字段</td>
</tr>
<tr>
<td>UserInfo</td>
<td>是</td>
<td>支付宝的用户信息，JSON格式，包含加星的用户账号及加星的用户名</td>
</tr>
</tbody>
</table>
<p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT84" smartracker="on">点此下载</a>）。</p>
<h2 id="c0303">文本消息</h2>
<h3 id="c0303_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.message.notify</p>
<p>使用场景举例：接收用户主动发送的文字消息，开发者可以使用<a href="#c0401" seed="entryContent-linkT85" smartracker="on">异步单发消息</a>功能向用户回复消息，实现诸如查询余额、推送最新优惠消息、客服等业务逻辑</p>
</blockquote>
<p>当开发者网关接收消息成功之后，请回复一条接收成功消息，详见<a href="#c0203" seed="entryContent-linkT86" smartracker="on">消息交互体系</a></p>
<h3 id="c0303_content">业务消息内容</h3>
<p>支付宝网关发送的POST消息中biz_content的内容示例如下：</p>
<pre><code>&lt;XML&gt;
    &lt;Text&gt;
        &lt;Content&gt;&lt;![CDATA[Hello]]&gt;&lt;/Content&gt;
    &lt;/Text&gt;
    &lt;AppId&gt;&lt;![CDATA[2014070100171523]]&gt;&lt;/AppId&gt;
    &lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;
    &lt;CreateTime&gt;&lt;![CDATA[1406104130464]]&gt;&lt;/CreateTime&gt;
    &lt;FromUserId&gt;&lt;![CDATA[R8qtKrh1dS49uWaLZUbPr0re8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01]]&gt;&lt;/FromUserId&gt;
    &lt;MsgId&gt;&lt;![CDATA[140723160000000004]]&gt;&lt;/MsgId&gt;
    &lt;UserInfo&gt;&lt;![CDATA[{"logon_id":"135****1009","user_name":"*iuxu527"}]]&gt;&lt;/UserInfo&gt;
&lt;/XML&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Text</td>
<td>是</td>
<td>文本消息内容</td>
</tr>
<tr>
<td>AppId</td>
<td>是</td>
<td>服务窗账号ID</td>
</tr>
<tr>
<td>MsgType</td>
<td>是</td>
<td>消息类型，固定为text</td>
</tr>
<tr>
<td>CreateTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>FromUserId</td>
<td>是</td>
<td>用户OpenId</td>
</tr>
<tr>
<td>MsgId</td>
<td>是</td>
<td>消息ID</td>
</tr>
<tr>
<td>UserInfo</td>
<td>是</td>
<td>支付宝的用户信息，JSON格式，包含加星的用户账号及加星的用户名</td>
</tr>
</tbody>
</table>
<p>UserInfo的一个示例：</p>
<pre><code>{
  "logon_id": "135**1009",
  "user_name": "*iuxu527"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT87" smartracker="on">点此下载</a>）。</p>
<h2 id="c0304">图片消息</h2>
<h3 id="c0304_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.message.notify</p>
<p>使用场景举例：接收用户主动发送的图片消息，开发者可以使用<a href="#c0401" seed="entryContent-linkT88" smartracker="on">异步单发消息</a>功能向用户回复消息，实现诸如查询余额、推送最新优惠消息、客服等业务逻辑</p>
</blockquote>
<p>当开发者网关接收消息成功之后，请回复一条接收成功消息，详见<a href="#c0203" seed="entryContent-linkT89" smartracker="on">消息交互体系</a></p>
<h3 id="c0304_content">业务消息内容</h3>
<p>支付宝网关发送的POST消息中biz_content的内容示例如下：</p>
<pre><code>&lt;XML&gt;
  &lt;Image&gt;
    &lt;MediaId&gt;&lt;![CDATA[L21pZnMvVDF4ZlFBWGpGWFhYYUNucHJYP3Q9YW13ZiZ4c2lnPTFiNTNkODhjZmQ5MDkxNWRjOWJlMmZlMjc1NTBjYzk1452]]&gt;&lt;/MediaId&gt;
    &lt;Format&gt;&lt;![CDATA[jpg]]&gt;&lt;/Format&gt;
  &lt;/Image&gt;
  &lt;AppId&gt;&lt;![CDATA[2014070100171523]]&gt;&lt;/AppId&gt;
  &lt;MsgType&gt;&lt;![CDATA[image]]&gt;&lt;/MsgType&gt;
  &lt;CreateTime&gt;&lt;![CDATA[1406104130464]]&gt;&lt;/CreateTime&gt;
  &lt;FromUserId&gt;&lt;![CDATA[R8qtKrh1dS49uWaLZUbPr0re8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01]]&gt;&lt;/FromUserId&gt;
  &lt;MsgId&gt;&lt;![CDATA[140723160000000004]]&gt;&lt;/MsgId&gt;
  &lt;UserInfo&gt;&lt;![CDATA[{"logon_id":"135****1009","user_name":"*iuxu527"}]]&gt;&lt;/UserInfo&gt;
&lt;/XML&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Image</td>
<td>是</td>
<td>图片消息内容</td>
</tr>
<tr>
<td>MediaId</td>
<td>是</td>
<td>图片媒体ID，如jpg</td>
</tr>
<tr>
<td>Format</td>
<td>是</td>
<td>图片文件格式</td>
</tr>
<tr>
<td>AppId</td>
<td>是</td>
<td>服务窗账号ID</td>
</tr>
<tr>
<td>MsgType</td>
<td>是</td>
<td>消息类型，固定为image</td>
</tr>
<tr>
<td>CreateTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>FromUserId</td>
<td>是</td>
<td>用户OpenId</td>
</tr>
<tr>
<td>MsgId</td>
<td>是</td>
<td>消息ID</td>
</tr>
<tr>
<td>UserInfo</td>
<td>是</td>
<td>支付宝的用户信息，JSON格式，包含加星的用户账号及加星的用户名</td>
</tr>
</tbody>
</table>
<p>UserInfo的一个示例：</p>
<pre><code>{
  "logon_id": "135**1009",
  "user_name": "*iuxu527"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h3 id="c0304_download">使用mediaId下载图片</h3>
<blockquote>
<p>接口网关地址：<a href="https://openfile.alipay.com/chat/multimedia.do" seed="entryContent-linkT90" smartracker="on" target="_blank">https://openfile.alipay.com/chat/multimedia.do</a></p>
<p>接口名称：alipay.mobile.public.multimedia.download</p>
<p>使用场景举例：开发者可通过本接口来下载用户聊天发送的图片。</p>
<p><strong>注：</strong>本接口与<a href="#c0203" seed="entryContent-linkT91" smartracker="on">消息交互体系</a>中的网关地址不同，消息体及调用方式相同。</p>
</blockquote>
<h4 id="业务消息内容">业务消息内容</h4>
<pre><code>{
    "mediaId": "L21pZnMvVDFucFVGWGZKYlhYYUNucHJYP3Q9YW13ZiZ4c2lnPTEzYWYwZjE1MmU2OTVhZTRlYjRkNGVhYjhlZGU2MzIw052"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>mediaId</td>
<td>用户聊天发送的图片文件</td>
</tr>
</tbody>
</table>
<h4 id="同步响应结果">同步响应结果</h4>
<p>如果调用成功，将返回一个Content-Type为图片格式HTTP请求，包含了图片的数据流</p>
<h1 id="c04">发送消息</h1>
<p>开发者可以使用异步单发消息接口、群发消息接口及单发模板消息接口向用户推送消息，点击查看<a href="https://i.alipayobjects.com/i/ecmng/pdf/201411/msgDemos.pdf" seed="entryContent-linkT92" smartracker="on" target="_blank">接口调用Demo</a></p>
<div id="alipay.mobile.public.message.custom.send"></div><div id="alipay.mobile.public.message.push"></div><h2 id="c0401">异步单发消息(客服接口)</h2>
<h3 id="c0401_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.message.custom.send</p>
<p>使用场景举例：开发者可以使用该接口实现对用户消息的回复功能，也可以使用该接口实现客服等扩展功能。</p>
</blockquote>
<p>注：用户主动与服务窗交互的48小时之内，服务窗可以使用该接口向该用户进行消息推送</p>
<p>该接口可以发送以下3种消息：</p>
<ol>
<li>文本消息</li>
<li>图文消息（图片宽高比为2:1，建议尺寸540*270，不符合比例的图片显示时将会被部分切割）</li>
<li>高级商品展示消息[内测中]（图片宽高比为1:1.3，建议尺寸430*559，不符合比例的图片显示时将会被部分切割）</li>
</ol>
<h3 id="c0401_content">业务消息内容</h3>
<h4 id="c0401_text">文本消息</h4>
<pre><code>{
    "toUserId": "m7DZN0VfcHYP6IRA1sP1gBuSX3JjLZtwilbxOzPGDUrbq9FV8CBamV+6ZPDwOg7401",
    "msgType": "text",
    "createTime": 1406634435601,
    "text": {
        "content": "你好"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>toUserId</td>
<td>是</td>
<td>消息接收用户的OpenId</td>
</tr>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，text</td>
</tr>
<tr>
<td>createTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>content</td>
<td>是</td>
<td>文本消息内容</td>
</tr>
</tbody>
</table>
<p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT93" smartracker="on">点此下载</a>）。</p>
<h4 id="c0401_article">图文消息</h4>
<p>单条图文消息示例：</p>
<pre><code>{
    "toUserId": "R8qtKrh1dS49uWaLZUbPr0re8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01",
    "msgType": "image-text",
    "createTime": 1406634435601,
    "articles": [
        {
            "actionName": "立即查看",
            "desc": "图文内容",
            "imageUrl": "http: //example.com/abc.jpg",
            "title": "标题",
            "url": "https://www.example.com/a.php"
        }
    ]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>多条图文消息示例：</p>
<pre><code>{
    "toUserId": "R8qtKrh1dS49uWaLZUbPr0re8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01",
    "msgType": "image-text",
    "createTime": 1406634435601,
    "articles": [
        {
            "actionName": "立即查看",
            "desc": "图文内容",
            "imageUrl": "http: //example.com/abc.jpg",
            "title": "标题",
            "url": "https://www.example.com/a.php"
        },
        {
            "actionName": "查看余额",
            "desc": "图文内容",
            "imageUrl": "http: //example.com/efg.jpg",
            "title": "标题2",
            "url": "https://www.example.com/b.php"
        }
    ]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>toUserId</td>
<td>是</td>
<td>消息接收用户的OpenId</td>
</tr>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，image-text</td>
</tr>
<tr>
<td>createTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>articles</td>
<td>是</td>
<td>图文消息子消息项集合，单条消息最多6个子项，否则会发送失败</td>
</tr>
</tbody>
</table>
<p>其中articles中的子项参数：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>title</td>
<td>否</td>
<td>图文消息标题</td>
</tr>
<tr>
<td>desc</td>
<td>否</td>
<td>图文消息内容</td>
</tr>
<tr>
<td>imageUrl</td>
<td>否</td>
<td>图片链接，对于多条图文消息的第一条消息，该字段不能为空</td>
</tr>
<tr>
<td>url</td>
<td>否</td>
<td>点击图文消息跳转的链接</td>
</tr>
<tr>
<td>actionName</td>
<td>否</td>
<td>链接文字</td>
</tr>
</tbody>
</table>
<p><strong>注：其中title、desc、imageUrl不可同时为空</strong></p>
<p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT94" smartracker="on">点此下载</a>）。</p>
<h3 id="c0401_tofu">高级商品展示消息[内测中]</h3>
<p>为了满足更多商户在消息展示上的需求，我们将会陆续开放高级商品的展示形式，以下为第一批开放的展示消息。<strong>注：当前只支持4个商品作为一组展示数据，将来会作扩展。</strong></p>
<pre><code>{
  "toUserId": "N-TFftXz+RzJJPZvXx7jZY97w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01",
  "msgType": "image-htable",
  "tableRows": [
    {
      "rowItems": [
        {
          "actionParam": "http://example.com",
          "actionType": "link",
          "image": "https://i.alipayobjects.com/i/ecmng/jpg/201501/4IhdlXyYTt.jpg",
          "title": "图片描述图片描述图片片描述图片"
        },
        {
          "actionParam": "http://example.com",
          "actionType": "link",
          "image": "https://i.alipayobjects.com/i/ecmng/jpg/201501/4IhdlXyYTt.jpg",
          "title": "图片描述图片描述图片"
        }
      ]
    },
    {
      "rowItems": [
        {
          "actionParam": "http://example.com",
          "actionType": "link",
          "image": "https://i.alipayobjects.com/i/ecmng/jpg/201501/4IhdlXyYTt.jpg",
          "title": "图片描述图片描述图片"
        },
        {
          "actionParam": "http://example.com",
          "actionType": "link",
          "image": "https://i.alipayobjects.com/i/ecmng/jpg/201501/4IhdlXyYTt.jpg",
          "title": "图片描述图片描述图片"
        }
      ]
    }
  ]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>toUserId</td>
<td>是</td>
<td>消息接收用户的OpenId</td>
</tr>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，image-htable</td>
</tr>
<tr>
<td>tableRows</td>
<td>是</td>
<td>消息体的坑位信息，目前只支持2行2列4个坑位的展示，未来会作扩展，单行坑位信息在rowItems中</td>
</tr>
</tbody>
</table>
<p>其中tableRows中的子项参数：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>title</td>
<td>是</td>
<td>坑位消息标题，最多15个字符，超出会报12039错误</td>
</tr>
<tr>
<td>actionType</td>
<td>是</td>
<td>固定为link</td>
</tr>
<tr>
<td>actionParam</td>
<td>是</td>
<td>链接地址</td>
</tr>
<tr>
<td>image</td>
<td>是</td>
<td>图片链接</td>
</tr>
</tbody>
</table>
<p>以下为示例效果：</p>
<p><img alt="" src="4jydd9fqpf.jpg" seed="entryContent-iIEcmngJpg2015014JYdd9FqPF" smartracker="on" /></p>
<h3 id="c0401_response">同步响应结果</h3>
<pre><code>{
    "alipay_mobile_public_message_custom_send_response": {
        "code": 200,
        "msg": "成功"
    },
    "sign": "N4xgzU4EfPguSbVF64129bFocaAS0UULmGmiYElFnB/qX+CZKCOhZbldrppRJgCtAku44ElEPoQTJR9VVf3HwnQmLb/QPzYP+4T5bb9ComI1kcRtfmmWxM1oEY1lfDI5G6tOAV6Tv5CXKi7c/pPjY5R/U2qLy5b+W8gW1X5g0gk="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c0901" seed="entryContent-linkT95" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c0901" seed="entryContent-linkT96" smartracker="on">返回码</a></td>
</tr>
</tbody>
</table>
<div id="alipay.mobile.public.message.total.send"></div><h2 id="c0402">群发消息</h2>
<h3 id="c0402_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.message.total.send</p>
<p>使用场景举例：开发者可以通过本接口向所有关注该服务窗用户发送消息。</p>
</blockquote>
<p>该接口可以发送以下3种消息：</p>
<ol>
<li>文本消息</li>
<li>图文消息（图片宽高比为2:1，建议尺寸540*270，不符合比例的图片显示时将会被部分切割）</li>
<li>高级商品展示消息[内测中]（图片宽高比为1:1.3，建议尺寸430*559，不符合比例的图片显示时将会被部分切割）</li>
</ol>
<h3 id="c0402_content">业务消息内容</h3>
<h4 id="c0402_text">文本消息</h4>
<pre><code>{
    "msgType": "text",
    "text": {
        "content": "你好"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，text</td>
</tr>
<tr>
<td>content</td>
<td>是</td>
<td>文本消息内容</td>
</tr>
</tbody>
</table>
<p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT97" smartracker="on">点此下载</a>）。</p>
<h4 id="c0402_article">图文消息</h4>
<p>单条图文消息示例：</p>
<pre><code>{
    "msgType": "image-text",
    "createTime": 1406634435601,
    "articles": [
        {
            "actionName": "立即查看",
            "desc": "图文内容",
            "imageUrl": "http: //example.com/abc.jpg",
            "title": "标题",
            "url": "https://www.example.com/a.php"
        }
    ]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>多条图文消息示例：</p>
<pre><code>{
    "msgType": "image-text",
    "createTime": 1406634435601,
    "articles": [
        {
            "actionName": "立即查看",
            "desc": "图文内容",
            "imageUrl": "http: //example.com/abc.jpg",
            "title": "标题",
            "url": "https://www.example.com/a.php"
        },
        {
            "actionName": "查看余额",
            "desc": "图文内容",
            "imageUrl": "http: //example.com/efg.jpg",
            "title": "标题2",
            "url": "https://www.example.com/b.php"
        }
    ]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，image-text</td>
</tr>
<tr>
<td>createTime</td>
<td>是</td>
<td>消息创建时间</td>
</tr>
<tr>
<td>articles</td>
<td>是</td>
<td>图文消息子消息项集合，单条消息最多6个子项，否则会发送失败</td>
</tr>
</tbody>
</table>
<p>其中articles中的子项参数：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>title</td>
<td>否</td>
<td>图文消息标题</td>
</tr>
<tr>
<td>desc</td>
<td>否</td>
<td>图文消息内容</td>
</tr>
<tr>
<td>imageUrl</td>
<td>否</td>
<td>图片链接，对于多条图文消息的第一条消息，该字段不能为空</td>
</tr>
<tr>
<td>url</td>
<td>否</td>
<td>点击图文消息跳转的链接</td>
</tr>
<tr>
<td>actionName</td>
<td>否</td>
<td>链接文字</td>
</tr>
</tbody>
</table>
<p><strong>注：其中title、desc、imageUrl不可同时为空</strong></p>
<p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT98" smartracker="on">点此下载</a>）。</p>
<h3 id="c0402_tofu">高级商品展示消息[内测中]</h3>
<p>为了满足更多商户在消息展示上的需求，我们将会陆续开放高级商品的展示形式，以下为第一批开放的展示消息。<strong>注：当前只支持4个商品作为一组展示数据，将来会作扩展。</strong></p>
<pre><code>{
  "toUserId": "N-TFftXz+RzJJPZvXx7jZY97w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01",
  "msgType": "image-htable",
  "tableRows": [
    {
      "rowItems": [
        {
          "actionParam": "http://example.com",
          "actionType": "link",
          "image": "https://i.alipayobjects.com/i/ecmng/jpg/201501/4IhdlXyYTt.jpg",
          "title": "图片描述图片描述图片片描述图片"
        },
        {
          "actionParam": "http://example.com",
          "actionType": "link",
          "image": "https://i.alipayobjects.com/i/ecmng/jpg/201501/4IhdlXyYTt.jpg",
          "title": "图片描述图片描述图片"
        }
      ]
    },
    {
      "rowItems": [
        {
          "actionParam": "http://example.com",
          "actionType": "link",
          "image": "https://i.alipayobjects.com/i/ecmng/jpg/201501/4IhdlXyYTt.jpg",
          "title": "图片描述图片描述图片"
        },
        {
          "actionParam": "http://example.com",
          "actionType": "link",
          "image": "https://i.alipayobjects.com/i/ecmng/jpg/201501/4IhdlXyYTt.jpg",
          "title": "图片描述图片描述图片"
        }
      ]
    }
  ]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>toUserId</td>
<td>是</td>
<td>消息接收用户的OpenId</td>
</tr>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，image-htable</td>
</tr>
<tr>
<td>tableRows</td>
<td>是</td>
<td>消息体的坑位信息，目前只支持2行2列4个坑位的展示，未来会作扩展，单行坑位信息在rowItems中</td>
</tr>
</tbody>
</table>
<p>其中tableRows中的子项参数：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>title</td>
<td>是</td>
<td>坑位消息标题，最多15个字符，超出会报12039错误</td>
</tr>
<tr>
<td>actionType</td>
<td>是</td>
<td>固定为link</td>
</tr>
<tr>
<td>actionParam</td>
<td>是</td>
<td>链接地址</td>
</tr>
<tr>
<td>image</td>
<td>是</td>
<td>图片链接</td>
</tr>
</tbody>
</table>
<p>以下为示例效果：</p>
<p><img alt="" src="4jydd9fqpf.jpg" seed="entryContent-iIEcmngJpg2015014JYdd9FqPFT1" smartracker="on" /></p>
<h3 id="c0402_response">同步响应结果</h3>
<pre><code>{
    "alipay_mobile_public_message_total_send_response": {
        "code": 200,
        "msg": "成功",
        "data": "20131211000555540edce750-b2d5-4d29-8cd1-0b423bf8df75"
    },
    "sign": "Qour4B3uTa7XjFpzWxMtU0nzOF7UGBnXfVa5NcgN2eVAlkIJsKdgUpEtshGXVQ+CXE0JH4gZX/COLzlYEI5RdmPG3ez4K7cOGTr8zYt7YhvpBX5A+jWPJbjd/6LMdRL55oMDaealZQF/Rb8CpFlPHwyvyRGAoSm1M9UWzlsKTmA="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c0901" seed="entryContent-linkT99" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c0901" seed="entryContent-linkT100" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>data</td>
<td>否</td>
<td>消息ID</td>
</tr>
</tbody>
</table>
<div id="alipay.mobile.public.message.single.send"></div><h2 id="c0403">单发模板消息</h2>
<h3 id="c0403_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.message.single.send</p>
<p>使用场景举例：模板消息是指如银行动帐提醒、航空公司值机提醒等对消费者非常有价值的消息类型，模板消息符合特定的格式，无需用户发生交互就可以主动向用户推送。我们的模板消息申请后台正在开发中，如果开发者现在就有此类需求，请找对应的商务合作经理申请。</p>
</blockquote>
<h3 id="c0403_apply">申请邮件格式</h3>
<p>以下为一个申请示例，效果详见<a href="#c0403_example" seed="entryContent-linkT101" smartracker="on">示例图</a></p>
<pre><code>服务窗名称：航旅纵横
模板标题：值机提醒
模板内容（支持换行）：
    {{first.value}}

    航班日期：{{keyword1.value}}
    起降时间：{{keyword2.value}}
    航班行程：{{keyword3.value}}
    航班号：{{keyword4.value}}

    {{remark.value}}
内容示例：
    尊敬的熊先生：

    航班日期：2014-09-24
    起降时间：21:45起飞/00:15降落
    航班行程：成都双流T2到北京首都T1
    航班号：HU7142

    现在可以通过航旅纵横服务窗值机功能提前选座，还可以为好友办理值机哦~预祝您旅途愉快！
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h3 id="c0403_content">业务消息内容</h3>
<pre><code>{
   "toUserId":"m7DZN0VfcHYP6IRA1sP1gBuSX3JjLZtwilbxOzPGDUrbq9FV8CBamV+6ZPDwOg7401",
   "template":{
      "templateId":"cbb9fdded2b74fe4bb082de3ed1e1eb2",
      "context":{
         "headColor":"#85be53",
         "url":"http://m.baidu.com",
         "actionName":"查看详情",
         "keyword1":{
            "color":"#000000",
            "value":"2014-09-24"
         },
         "keyword2":{
            "color":"#85be53",
            "value":"HU7142"
         }
      }
   }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>toUserId</td>
<td>是</td>
<td>消息接收用户的openId</td>
</tr>
<tr>
<td>template</td>
<td>是</td>
<td>消息模板相关参数，其中包括templateId模板ID和context模板上下文</td>
</tr>
</tbody>
</table>
<p>其中template中的各项参数分别为：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>templateId</td>
<td>是</td>
<td>消息模板ID</td>
</tr>
<tr>
<td>context</td>
<td>是</td>
<td>消息模板上下文，即模板中定义的参数及参数值</td>
</tr>
</tbody>
</table>
<p>其中context中的各项参数分别为：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>headColor</td>
<td>是</td>
<td>顶部色条的色值</td>
</tr>
<tr>
<td>url</td>
<td>是</td>
<td>点击消息后承接页的地址</td>
</tr>
<tr>
<td>actionName</td>
<td>是</td>
<td>底部链接描述文字，如“查看详情”</td>
</tr>
<tr>
<td>keyword1</td>
<td>是</td>
<td>模板中占位符的值及文字颜色，value和color都为必填项，color为当前文字颜色</td>
</tr>
<tr>
<td>keyword2</td>
<td>是</td>
<td>模板中占位符的值及文字颜色，value和color都为必填项，color为当前文字颜色</td>
</tr>
</tbody>
</table>
<h4 id="c0403_response">同步响应消息业务内容</h4>
<pre><code>{
   "alipay_mobile_public_message_single_send_response":{
      "code":200,
      "msg":"成功"
   },
   "sign":"N4xgzU4EfPguSbVF64129bFocaAS0UULmGmiYElFnB/qX+CZKCOhZbldrppRJgCtAku44ElEPoQTJR9VVf3HwnQmLb/QPzYP+4T5bb9ComI1kcRtfmmWxM1oEY1lfDI5G6tOAV6Tv5CXKi7c/pPjY5R/U2qLy5b+W8gW1X5g0gk="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="https://fuwu.alipay.com/platform/doc.htm#c09" seed="entryContent-linkT102" smartracker="on" target="_blank">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="https://fuwu.alipay.com/platform/doc.htm#c09" seed="entryContent-linkT103" smartracker="on" target="_blank">业务返回码</a>。</td>
</tr>
</tbody>
</table>
<h4 id="c0403_example">一个示例</h4>
<p><img alt="" src="3jcapv9u5t.jpg" seed="entryContent-iIEcmngJpg2014103jCApv9u5t" smartracker="on" /></p>
<p>上图的模板消息商户占位符格式如下：</p>
<pre><code>{{first.value}}

航班日期：{{keyword1.value}}
起降时间：{{keyword2.value}}
航班行程：{{keyword3.value}}
航班号：{{keyword4.value}}

{{remark.value}}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>商户调用时候入参JSON如下：</p>
<pre><code>{
   "template":{
      "context":{
         "keyword1":{
            "color":"#000000",
            "value":"2014-09-24"
         },
         "keyword4":{
            "color":"#85be53",
            "value":"HU7142"
         },
         "keyword3":{
            "color":"#000000",
            "value":"成都双流T2到北京首都T1"
         },
         "keyword2":{
            "color":"#000000",
            "value":"21:45起飞/00:15降落"
         },
         "remark":{
            "color":"#85be53",
            "value":"现在可以通过航旅纵横服务窗值机功能提前选座，还可以为好友办理值机哦~预祝您旅途愉快！"
         },
         "headColor":"#85be53",
         "url":"http://m.baidu.com",
         "actionName":"查看详情",
         "first":{
            "color":"#000000",
            "value":"尊敬的熊先生："
         }
      },
      "templateId":"cbb9fdded2b74fe4bb082de3ed1e1eb2"
   },
   "toUserId":"m7DZN0VfcHYP6IRA1sP1gBuSX3JjLZtwilbxOzPGDUrbq9FV8CBamV+6ZPDwOg7401"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h1 id="c13">用户标签及标签组发消息接口组</h1>
<h2 id="c13_intro">概述</h2>
<blockquote>
<p>该接口组由标签的增删改查接口、用户标签的增删改查接口、标签组发接口一起组成。标签组发接口支持商户自定义的标签，同时还支持部分<a href="https://i.alipayobjects.com/i/ecmng/zip/201501/FirstPartOfTagsFromAlipay.zip" seed="entryContent-linkT104" smartracker="on" target="_blank">支付宝标签</a>进行人群筛选。</p>
<p>使用场景举例：开发者可以使用此类接口完成对用户的分组及分组发送消息等功能，实现精准营销。比如，商户可以在线下各个门店投放二维码（使用<a href="#https://fuwu.alipay.com/platform/doc.htm#c0701" seed="entryContent-linkT105" smartracker="on">带参二维码接口</a>接口生成），当用户扫描a门店二维码关注服务窗时，商户将用户贴上a门店标签（通过<a href="#c0302_follow_unfollow" seed="entryContent-linkT106" smartracker="on">关注事件</a>中的ActionParam参数进行匹配），后续a门店有营销活动，开发者可以通过标签组发接口向拥有a标签的这群用户推送营销消息。</p>
</blockquote>
<p><strong>注：目前该接口组处于内部测试阶段，开发者需要发邮件给 fuwudev@list.alibaba-inc.com 申请接口权限，邮件格式：</strong></p>
<pre><code>邮件标题：【接口权限申请】用户标签及标签组发消息接口组
公司名称：请填写公司名称
公司规模：请填写公司总共有多少工作人员
服务窗名称：请填写服务窗的名称
服务窗AppId：请填写服务窗的AppId
使用场景：请详细填写接口的使用场景
申请者姓名：请填写申请人的姓名
申请者手机：请填写申请人的手机联系方式
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h2 id="c13_label_crud">标签增删改查</h2>
<h3 id="c13_label_create">创建标签接口</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.label.add</p>
<p>使用场景举例：开发者可以使用该接口创建一个标签，一个服务窗最多同时拥有500个标签，标签名不能重复。</p>
</blockquote>
<h4 id="c13_label_create_content">业务消息内容</h4>
<pre><code>{
   "name" : "测试标签01"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>是</td>
<td>标签名</td>
</tr>
</tbody>
</table>
<h4 id="c13_label_create_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_mobile_public_label_add_response": {
        "code": 200,
        "id": 100513,
        "msg": "添加标签成功",
        "name": "测试标签01"
    },
    "sign": "FlbiiEs8vEm7daiR7Jzm6UfECYQ/5SLjdjTBurcP5h8Y6RPjcKHkIsgwh8YaHHS8FXv52Cxn4RA4Q+2plHjoUTtle8MGSfnzDwhD9xWhTMMR+T5ldH39BnOr9iBQPKjIFq9O4Wi0nXa6tQXchEwb6dEB5/UYdidkA8b5fAUvHtc="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT107" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT108" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>id</td>
<td>是</td>
<td>支付宝返回的标签ID，开发者后续通过该ID进行标签的查询、修改、删除等操作</td>
</tr>
<tr>
<td>name</td>
<td>是</td>
<td>开发者入参name的值</td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h3 id="c13_label_query">查询标签接口</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.label.query</p>
<p>使用场景举例：开发者可以查询该服务窗所有标签值及拥有该标签的用户个数</p>
</blockquote>
<h4 id="c13_label_query_content">业务消息内容</h4>
<pre><code>{
    // 业务参数为空
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h4 id="c13_label_query_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_mobile_public_label_query_response": {
        "code": 200,
        "labels": "[{\"count\":3,\"id\":100509,\"name\":\"bqtest2\"},{\"count\":3,\"id\":100510,\"name\":\"bqtest3\"},{\"count\":3,\"id\":100511,\"name\":\"bqtest4\"},{\"count\":3,\"id\":100512,\"name\":\"bqtest5\"},{\"count\":0,\"id\":100513,\"name\":\"测试标签01\"}]",
        "msg": "成功"
    },
    "sign": "eNarwqhe8tOl2jIO99cLEiV4WQVJL5n8xUntkh6SOjo9i0LKo0TraJDMP15R2BVeaEuxBq5bKMYH0CfrG65XnGAGF2eMApdqB9rgF9BdLBohr3Xmhl3//PqRQmyBfv/Fig7WGGclw+i7AmcupJLp1/4kwAhbKIQZ4tMGMZGH+a4="
}    
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT109" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT110" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>labels</td>
<td>是</td>
<td>标签信息，<strong>数据类型为JSON类型字符串，需要再次解析</strong></td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<p>labels解析为JSON后的格式如下：</p>
<pre><code>[
    {
        "count": 3,
        "id": 100509,
        "name": "bqtest2"
    },
    {
        "count": 3,
        "id": 100510,
        "name": "bqtest3"
    },
    {
        "count": 3,
        "id": 100511,
        "name": "bqtest4"
    },
    {
        "count": 3,
        "id": 100512,
        "name": "bqtest5"
    },
    {
        "count": 0,
        "id": 100513,
        "name": "测试标签01"
    }
]
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>标签Id</td>
</tr>
<tr>
<td>name</td>
<td>标签名</td>
</tr>
<tr>
<td>count</td>
<td>拥有该标签的用户数</td>
</tr>
</tbody>
</table>
<h3 id="c13_label_update">修改标签接口</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.label.update</p>
<p>使用场景举例：开发者可以使用该接口修改某个标签的名字</p>
</blockquote>
<h4 id="c13_label_update_content">业务消息内容</h4>
<pre><code>{
    "id" : "100513",
    "name" : "修改后的标签01"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>是</td>
<td>标签Id</td>
</tr>
<tr>
<td>name</td>
<td>是</td>
<td>修改后的标签名</td>
</tr>
</tbody>
</table>
<h4 id="c13_label_update_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_mobile_public_label_update_response": {
        "code": 200,
        "id": 100513,
        "msg": "修改标签名成功"
    },
    "sign": "TPCtYhoZzyK1NYG7gbX9rLsAYBjLOJDJbGvhjE8TBskxd6kCbiOscz4cZ2l3EZ84n0h7U8M3Biw7q4lNzADBx7U1U/knsYFpBg4T8U8dHkUAX4LqChdFYTzVpVnCnvd4mpkpzdk7sq872yxJdaBZvINHYEH10jGuno0io9v+n9U="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT111" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT112" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>id</td>
<td>是</td>
<td>标签Id</td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h3 id="c13_label_delete">删除标签接口</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.label.delete</p>
<p>使用场景举例：开发者可以通过该接口删除某个标签，删除标签时，会将所有拥有该标签的用户的对应标签Id一并删除，请谨慎使用该接口</p>
</blockquote>
<h4 id="c13_label_delete_content">业务消息内容</h4>
<pre><code>{
    "id" : "100513"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>是</td>
<td>标签Id</td>
</tr>
</tbody>
</table>
<h4 id="c13_label_delete_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_mobile_public_label_delete_response": {
        "code": 200,
        "id": 100513,
        "msg": "删除标签成功"
    },
    "sign": "USGQ2DsraeyiLpEBYQaKW+EAC21Iw1kPaUGfJdJS8qWbCyx8bk3g2+WIdErwBMlZiFjNGtDK3/ItRICIZLaxlH51Qk6MNz2ooUnNewNJP5FD2/JrBh+7i6z4v12AjnQ1QfXZ0XuqFEszj+h0AtrvviJQAFSuPZPEueV7RzM1Bj8="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT113" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT114" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>id</td>
<td>是</td>
<td>标签Id</td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h2 id="c13_label_user_crud">用户标签增删查接口</h2>
<h3 id="c13_label_user_add">用户增加标签接口</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.label.user.add</p>
<p>使用场景举例：创建标签完毕后，开发者可以给使用该接口给用户贴标签</p>
</blockquote>
<h4 id="c13_label_user_add_content">业务消息内容</h4>
<pre><code>{
    "userId" : "N-TFftXz+RzJJPZvXx7jZY97w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01",
    "labelId" : "100511"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>userId</td>
<td>是</td>
<td>用户的OpenId</td>
</tr>
<tr>
<td>labelId</td>
<td>是</td>
<td>标签Id</td>
</tr>
</tbody>
</table>
<h4 id="c13_label_user_add_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_mobile_public_label_user_add_response": {
        "code": 200,
        "msg": "成功"
    },
    "sign": "Mbt/a/K5iUja2aUSrpyeApESwtoEMGa58vxEVXuv/XRhNRm7+Mq/Ql9fMHooaEm1p/ux4LEBFzSRjlqd8f300kNPPIb6rGvz6rbran0yS9744aPHqfV4VJXbTtzqqRp6B8SBc8jG+HfOUurDGOwVpzeBZND61YXl831YUofkBMA="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT115" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT116" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h3 id="c13_label_user_query">查询用户标签接口</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.label.user.query</p>
<p>使用场景举例：开发者可以使用该接口查询某个用户的所有标签</p>
</blockquote>
<h4 id="c13_label_user_query_content">业务消息内容</h4>
<pre><code>{
    "userId" : "N-TFftXz+RzJJPZvXx7jZY97w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>userId</td>
<td>是</td>
<td>用户的OpenId</td>
</tr>
</tbody>
</table>
<h4 id="c13_label_user_query_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_mobile_public_label_user_query_response": {
        "code": 200,
        "label_ids": "100509,100510,100511,100512",
        "msg": "成功"
    },
    "sign": "LahI3JNYyak8jqnSyWOWznl9qtOTGD9/t4q2n+Tu8Fo4IKzwcQw/j/4KWqVG4ilZn3FeX5oAt7mA930erONOiKgEMbe+99VuLTV108bVHpO72vSdK5S8dUb1ggpVRE/gGFXeEN1aOWqyADbd1mjrPGgEL/8oW8oNorjGLSh3SXc="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT117" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT118" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>label_ids</td>
<td>是</td>
<td>用户标签id列表，以英文逗号分隔</td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h3 id="c13_label_user_delete">删除用户标签接口</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.label.user.delete</p>
<p>使用场景举例：开发者可以使用该接口删除用户的某个标签</p>
</blockquote>
<h4 id="c13_label_user_delete_content">业务消息内容</h4>
<pre><code>{
    "userId" : "N-TFftXz+RzJJPZvXx7jZY97w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01",
    "labelId" : "100511"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>userId</td>
<td>是</td>
<td>用户的OpenId</td>
</tr>
<tr>
<td>labelId</td>
<td>是</td>
<td>标签Id</td>
</tr>
</tbody>
</table>
<h4 id="c13_label_user_delete_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_mobile_public_label_user_delete_response": {
        "code": 200,
        "msg": "成功"
    },
    "sign": "Mbt/a/K5iUja2aUSrpyeApESwtoEMGa58vxEVXuv/XRhNRm7+Mq/Ql9fMHooaEm1p/ux4LEBFzSRjlqd8f300kNPPIb6rGvz6rbran0yS9744aPHqfV4VJXbTtzqqRp6B8SBc8jG+HfOUurDGOwVpzeBZND61YXl831YUofkBMA="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT119" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT120" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h2 id="c13_label_message">根据标签组发接口</h2>
<blockquote>
<p>接口名称：alipay.mobile.public.message.label.send</p>
<p>使用场景举例：开发者可以通过标签运算圈定一批用户，并且向这批用户推送消息。关于标签组发有以下注意点：</p>
<ul>
<li>除了商户自定义标签，还支持支付宝用户标签，我们将陆续开放用户画像标签，目前支持的支付宝标签及说明请查看<a href="https://i.alipayobjects.com/i/ecmng/zip/201501/FirstPartOfTagsFromAlipay.zip" seed="entryContent-linkT121" smartracker="on" target="_blank">支付宝开放标签</a>，使用方法参考<a href="#c13_appendix_demo6" seed="entryContent-linkT122" smartracker="on">示例6</a></li>
<li>用户及标签数据有1天的缓存时间，即昨天开发者给M用户打了a标签，今天给有a标签的用户组发消息，M能够收到消息；但是如果开发者今天给M用户打了a标签，然后向有a标签的用户组发消息，M不能收到消息；</li>
<li>与群发消息接口类似，该接口调用之后，消息发送系统会处理一段时间，调用接口到发送成功存在一定的时延，几分钟到半个小时不等</li>
<li>对于同一个用户而言，一周只能收到一条<a href="#c0402" seed="entryContent-linkT123" smartracker="on">群发</a>或者标签组发的消息</li>
<li>消息组发接口一周最多调用50次</li>
</ul>
</blockquote>
<h4 id="c13_label_message_content">业务消息内容</h4>
<pre><code>{
    "material": {
        "msgType": "image-text",
        "creatTime": "12345678",
        "articles": [
            {
                "title": "欢迎光临",
                "actionName": "点击查看详情",
                "imageUrl": "https://i.alipayobjects.com/i/ecmng/jpg/201411/3ts2vA3Z1T.jpg",
                "desc": "小二在此恭候多时：）这里有您想要的各种美味，请您慢慢享用~~",
                "url": "http://example.com"
            }
        ]
    },
    "filter": {
        "template": "${a}",
        "context": {
            "a": {
                "columnName": "label_id_list",
                "op": "=",
                "values": [
                    "100509"
                ]
            }
        }
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>material</td>
<td>是</td>
<td>发送消息内容，可以参考<a href="#c0402" seed="entryContent-linkT124" smartracker="on">群发消息接口</a>，支持文本消息和图文消息，此处不作赘述</td>
</tr>
<tr>
<td>filter</td>
<td>是</td>
<td>根据标签圈人的过滤器</td>
</tr>
</tbody>
</table>
<p>filter对象中的参数详解：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>template</td>
<td>是</td>
<td>过滤器模板，${a}是一个变量，会被context参数中的a参数替换，从而展开为最终的表达式，template最多支持两个参数，支持and及or连接符——and：同时满足条件；or：只需满足其中一个条件</td>
</tr>
<tr>
<td>context</td>
<td>是</td>
<td>用于替换模板中变量的上下文</td>
</tr>
<tr>
<td>columnName</td>
<td>是</td>
<td>标签组名，商户自定义的标签固定为label_id_list，支付宝开放的标签详见<a href="https://i.alipayobjects.com/i/ecmng/zip/201501/FirstPartOfTagsFromAlipay.zip" seed="entryContent-linkT125" smartracker="on" target="_blank">支付宝开放标签</a></td>
</tr>
<tr>
<td>op</td>
<td>是</td>
<td>操作符，支持=,!=以及in三个操作符；其中in表示是某几个标签中的一个</td>
</tr>
<tr>
<td>values</td>
<td>是</td>
<td>标签数组，用于组装最后的表达式</td>
</tr>
</tbody>
</table>
<p>本接口较为复杂，我们提供了详细的<a href="https://i.alipayobjects.com/i/ecmng/pdf/201502/labelDemos.pdf" seed="entryContent-linkT126" smartracker="on" target="_blank">标签组发接口Demo</a>，开发者可以依据示例进行实际开发工作</p>
<h4 id="c13_label_message_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_mobile_public_message_label_send_response": {
        "code": 200,
        "msg": "成功",
        "msg_id": "2014071800007108307137f6-5fb5-4daa-af4b-202e517fb5f0"
    },
    "sign": "MxBIIejVr/gucViJvuGJpWtr/FcniMS+uAJBNqXRFmHY+hZFFX3ZZgNS/OQDUMew3cPk/vromnMDyFIb5iBPFfxRFL2fCIfYFykFfQcruvV1tKkNGcY7h6ZHaySnkHd94B9XtFkh132Yj1vMcU/BozhT18+RqcbpIcR0OaoEk+s="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT127" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT128" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h1 id="c05">用户管理与数据开放</h1>
<div id="alipay.mobile.public.follow.list"></div><h2 id="c0501">获取关注者列表</h2>
<h3 id="c0501_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.follow.list</p>
<p>使用场景举例：开发者可通过本接口来获取帐号的关注者列表。</p>
</blockquote>
<p>关注者列表由一串用户OpenId组成。一次最多获取10000个关注者的OpenId，可以通过多次获取的方式来满足需求。</p>
<h3 id="c0501_content">业务消息内容</h3>
<pre><code>{
  "nextUserId": "aYMvrMC8+qdi3Mj1lqxRZJPUsrychFTewHXFVXq5ySDxWgIluiZN3K2r70Eebm4r01"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>nextUserId</td>
<td>当关注者数量超过10000时使用，本次拉取数据中第一个用户的OpenId，从上次接口调用返回值中获取，第一次调用置空</td>
</tr>
</tbody>
</table>
<h3 id="c0501_response">同步响应结果</h3>
<pre><code>{
    "alipay_mobile_public_follow_list_response": {
        "code": 200,
        "count": "2",
        "data": {
            "user_id_list": {
                "string": [
                    "ccQyL+73MAMTDkj2mRxLNkre8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01",
                    "R8qtKrh1dS49uWaLZUbPr0re8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01"
                ]
            }
        }
    },
    "sign": "b6AJP+rJLO0qExHKgYgHMsTwyRI5GhAUKmhuVAl+EmYW8Lic8kB9rgRpek0LeT3goHvEkimXv/BkUOYaVhIA7rrD8vQcNJDL7Vbgj3W3LToyB/biYWK8r1iHfYJNnOdstvq6FcU7xOOTSZHqFg45IHSc0vqXK9cqBeSgh2eJnoI="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sign</td>
<td>RSA加密签名</td>
</tr>
<tr>
<td>code</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c0901" seed="entryContent-linkT129" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>count</td>
<td>本次调用获取的OpenId个数，最大值为10000</td>
</tr>
<tr>
<td>data</td>
<td>用户数据，包含OpenId列表</td>
</tr>
</tbody>
</table>
<div id="alipay.mobile.public.gis.get"></div><h2 id="c0502">获取用户地理位置</h2>
<h3 id="c0502_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.gis.get</p>
<p>使用场景举例：查询该用户当前的位置信息，可以根据用户位置完成不同的业务逻辑。</p>
</blockquote>
<h3 id="c0502_content">业务消息内容</h3>
<pre><code>{
    "userId":"m7DZN0VfcHYP6IRA1sP1gBuSX3JjLZtwilbxOzPGDUrbq9FV8CBamV+6ZPDwOg7401"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>userId</td>
<td>是</td>
<td>该用户的OpenId</td>
</tr>
</tbody>
</table>
<h3 id="c0502_response">同步响应结果</h3>
<pre><code>{
    "alipay_mobile_public_gis_get_response": {
        "accuracy": "68.0",
        "city": "杭州市",
        "code": 200,
        "latitude": "30.27283",
        "longitude": "120.12555",
        "msg": "成功",
        "province": "浙江省"
    },
    "sign": "jfAz0Yi0OUvAPqYTzA0DLysx0ri++yf7o/lkHOHaG1Zy2fHBf3j4WM+sJWHZUuyInt6V+wn+6IP9AmwRTKi+GGdWjPrsfBjXqR7H5aBnLhMsAltV7v4cYjhuguAqh4WkaJO6v6CfdybDpzHlxE6Thoucnad+OsjdCXkNd1g3UuU="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c0901" seed="entryContent-linkT130" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c0901" seed="entryContent-linkT131" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>longitude</td>
<td>否</td>
<td>经度</td>
</tr>
<tr>
<td>latitude</td>
<td>否</td>
<td>维度</td>
</tr>
<tr>
<td>accuracy</td>
<td>否</td>
<td>精确度</td>
</tr>
<tr>
<td>province</td>
<td>否</td>
<td>省份，经纬度转换城市信息失败的情况会为空</td>
</tr>
<tr>
<td>city</td>
<td>否</td>
<td>城市，经纬度转换城市信息失败的情况会为空</td>
</tr>
</tbody>
</table>
<div id="alipay.user.userinfo.share"></div><h2 id="c0503">账户信息共享接口</h2>
<blockquote>
<p>接口名称：alipay.user.userinfo.share</p>
<p>使用场景举例：开发者可以使用该方案获取用户的OpenId、姓名、身份证、手机号等个人信息，开发者需要需要申请账户信息共享接口权限，详见<a href="https://fuwu.alipay.com/platform/developerMode.htm" seed="entryContent-linkT132" smartracker="on" target="_blank">开发者模式-高级接口-账户信息共享</a>。</p>
</blockquote>
<p>注1：账户信息共享接口采用标准的OAuth 2.0授权流程，请务必先阅读<a href="#c0205" seed="entryContent-linkT133" smartracker="on">数据接口与授权机制</a>。</p>
<p>注2：如果开发者获取了用户的手机号、身份证等敏感信息，<strong>在网页呈渲染时必须经过脱敏处理，一旦发现未经脱敏直接展示在页面上的，我们将直接关闭该接口所有权限</strong>，脱敏方案请遵循<a href="https://t.alipayobjects.com/tfscom/T1bg4fXg4sXXXXXXXX.docx" seed="entryContent-linkT134" smartracker="on" target="_blank">支付宝快捷共享会员信息展示规范.docx</a></p>
<p>注3：如果开发者只需要获取用户的OpenId，无需获取其他信息，请参考<a href="#c0205_openid_only" seed="entryContent-linkT135" smartracker="on">特例：网页获取用户OpenId</a>方案，该方案无需经过用户授权</p>
<h3 id="c0503_userinfo_post">发送获取用户基本信息请求</h3>
<p>获取用户信息接口的POST消息格式与其他API参数略有不同，不含biz_content参数，多出了auth_token参数，格式如下：</p>
<pre><code>REQUEST URL: https://openapi.alipay.com/gateway.do
REQUEST METHOD: POST
CONTENT:
    method=alipay.user.userinfo.share
    timestamp=2014-07-29 20:30:30
    app_id=2014070100171523
    auth_token=publicpB9ea460ff5b5c468c9ccf5e967dc34963
    charset=GBK
    version=1.0
    sign_type=RSA
    sign=R48FPxFxDSzred4JQ+sLsjzzNen5eZVjVcOgepxBgNFwhIxn0XrqDR53Di6fv1nLMIGEDm0VyGq516J8sVj4rlUSLehHy+oN7s7m07dYk+6xHpoIz4A1+N2tlCmtiHslWGxF6KMEYVjZLHo/y7tEwHQJ6r4H1svT3CJJ2HJpK1o=
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_id</td>
<td>服务窗账号 ID，服务窗账号唯一标识</td>
</tr>
<tr>
<td>method</td>
<td>接口名称:alipay.user.userinfo.share</td>
</tr>
<tr>
<td>timestamp</td>
<td>发送请求的时间戳</td>
</tr>
<tr>
<td>sign_type</td>
<td>签名方式，目前只支持RSA</td>
</tr>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
<tr>
<td>auth_token</td>
<td>交换令牌，即通过换取授权访问令牌接口获取到的access_token参数值</td>
</tr>
</tbody>
</table>
<p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT136" smartracker="on">点此下载</a>）。</p>
<h3 id="c0503_userinfo_response">同步响应结果</h3>
<p>当开发者发送获取用户基本信息请求后，支付宝会同步响应，参见如下示例：</p>
<p><strong>注：响应结果中的字段与开发者开通该接口时申请的权限有关，申请地址详见<a href="https://fuwu.alipay.com/platform/developerMode.htm" seed="entryContent-linkT137" smartracker="on" target="_blank">开发者模式-高级接口-账户信息共享</a></strong></p>
<pre><code>{
    "alipay_user_userinfo_share_response": {
        "user_type_value": "2",
        "is_licence_auth": "F",
        "is_certified": "T",
        "is_bank_auth": "T",
        "is_mobile_auth": "F",
        "user_id": "ccQyL+73MAMTDkj2mRxLNkre8hjWnYClscK-vjUi4qOHCIhO5aJXi4frP7yHEJoJ01",
        "user_status": "T",
        "is_id_auth": "T"
    },
    "sign": "P4iuFMEGKhQ6L+3Ako0Dpqc4QBksPiz/wbjGPaUIP0VTH8VEIViBbHWBT1VWxCqbvjugwbhoWrzfVcZXQC7McQKqCOC5b5O2yblpVuyLq2dIiqcMEZGammVHXeP1v4+kL4BX3/CTAPBTeSk+/zepipw0FeGMqpUPdoSPFl6ohUI="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>用户的userId</td>
</tr>
<tr>
<td>user_type_value</td>
<td>用户类型（1/2） 1代表公司账户; 2代表个人账户</td>
</tr>
<tr>
<td>user_status</td>
<td>用户状态（Q/T/B/W）。 Q代表快速注册用户;T代表已认证用户;B代表被冻结账户;W代表已注册，未激活的账户</td>
</tr>
<tr>
<td>firm_name</td>
<td>公司名称（用户类型是公司类型时公司名称才有此字段）。</td>
</tr>
<tr>
<td>real_name</td>
<td>用户的真实姓名。</td>
</tr>
<tr>
<td>avatar</td>
<td>用户头像</td>
</tr>
<tr>
<td>cert_no</td>
<td>证件号码</td>
</tr>
<tr>
<td>gender</td>
<td>性别（F：女性；M：男性）</td>
</tr>
<tr>
<td>phone</td>
<td>电话号码。</td>
</tr>
<tr>
<td>mobile</td>
<td>手机号码。</td>
</tr>
<tr>
<td>is_certified</td>
<td>是否通过实名认证。T是通过 F是没有实名认证</td>
</tr>
<tr>
<td>is_student_certified</td>
<td>是否是学生。T表示是学生，F表示不是学生</td>
</tr>
<tr>
<td>is_bank_auth</td>
<td>T为是银行卡认证，F为非银行卡认证。</td>
</tr>
<tr>
<td>is_id_auth</td>
<td>T为是身份证认证，F为非身份证认证。</td>
</tr>
<tr>
<td>is_mobile_auth</td>
<td>T为是手机认证，F为非手机认证。</td>
</tr>
<tr>
<td>is_licence_auth</td>
<td>T为通过营业执照认证，F为没有通过</td>
</tr>
<tr>
<td>cert_type_value</td>
<td>0:身份证;1:护照;2:军官证;3:士兵证;4:回乡证;5:临时身份证;6:户口簿;7:警官证;8:台胞证;9:营业执照;10其它证件</td>
</tr>
<tr>
<td>province</td>
<td>省份名称。</td>
</tr>
<tr>
<td>city</td>
<td>市名称。</td>
</tr>
<tr>
<td>area</td>
<td>区县名称。</td>
</tr>
<tr>
<td>address</td>
<td>详细地址。</td>
</tr>
<tr>
<td>zip</td>
<td>邮政编码。</td>
</tr>
<tr>
<td>address_code</td>
<td>区域编码，暂时不返回值</td>
</tr>
</tbody>
</table>
<div id="alipay.user.userinfo.share"></div><h2 id="c0505">通讯录信息接口</h2>
<blockquote>
<p>接口名称：alipay.mobile.public.contact.follow.list</p>
<p>使用场景举例：开发者可以通过该接口获取用户手机通讯录中<strong>同时关注</strong>开发者服务窗的好友的信息。</p>
</blockquote>
<p><strong>注1：通讯录信息接口采用标准的OAuth 2.0授权流程，请务必先阅读<a href="#c0205" seed="entryContent-linkT138" smartracker="on">数据接口与授权机制</a>。</strong></p>
<p><strong>注2：目前通讯录信息接口处于内部测试阶段，开发者需要发邮件给 fuwudev@list.alibaba-inc.com 申请接口权限，邮件格式：</strong></p>
<pre><code>邮件标题：【接口权限申请】通讯录信息接口
公司名称：请填写公司名称
公司规模：请填写公司总共有多少工作人员
服务窗名称：请填写服务窗的名称
服务窗AppId：请填写服务窗的AppId
使用场景：请详细填写接口的使用场景
申请者姓名：请填写申请人的姓名
申请者手机：请填写申请人的手机联系方式
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h3 id="c0505_contact_post">发送获取用户通讯录信息请求</h3>
<p>获取用户信息接口的POST消息格式与其他API参数略有不同，不含biz_content参数，多出了auth_token参数，格式如下：</p>
<pre><code>REQUEST URL: https://openapi.alipay.com/gateway.do
REQUEST METHOD: POST
CONTENT:
    method=alipay.mobile.public.contact.follow.list
    timestamp=2014-07-29 20:30:30
    app_id=2014070100171523
    auth_token=publicpB9ea460ff5b5c468c9ccf5e967dc34963
    charset=GBK
    version=1.0
    sign_type=RSA
    sign=R48FPxFxDSzred4JQ+sLsjzzNen5eZVjVcOgepxBgNFwhIxn0XrqDR53Di6fv1nLMIGEDm0VyGq516J8sVj4rlUSLehHy+oN7s7m07dYk+6xHpoIz4A1+N2tlCmtiHslWGxF6KMEYVjZLHo/y7tEwHQJ6r4H1svT3CJJ2HJpK1o=
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_id</td>
<td>服务窗账号ID，服务窗账号唯一标识</td>
</tr>
<tr>
<td>method</td>
<td>接口名称：alipay.mobile.public.contact.follow.list</td>
</tr>
<tr>
<td>timestamp</td>
<td>发送请求的时间戳</td>
</tr>
<tr>
<td>sign_type</td>
<td>签名方式，目前只支持RSA</td>
</tr>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
<tr>
<td>auth_token</td>
<td>交换令牌，即通过换取授权访问令牌接口获取到的access_token参数值</td>
</tr>
</tbody>
</table>
<h3 id="c0505_contact_response">同步响应结果</h3>
<pre><code>{
    "alipay_mobile_public_contact_follow_list_response": {
        "code": 200,
        "msg": "成功",
        "contact_follow_list": "[{\"avatar\":\"https://tfsimg.alipay.com/images/partner/T1yf8dXcllXXXXXXXX\",\"contactName\":\"手机联系人姓名\",\"defaultAvatar\":false,\"eachRecordFlag\":true,\"userId\":\"-RwBr5IW9zBWzE7X+fRrUY97w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01\"},{\"avatar\":\"https://tfsimg.alipay.com/images/partner/T1MC0aXlRrXXXXXXXX\",\"contactName\":\"手机联系人姓名\",\"defaultAvatar\":false,\"eachRecordFlag\":true,\"userId\":\"qLxjqikSQ0Wy+mdAeQOpM497w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01\"}]"
    },
    "sign": "N4xgzU4EfPguSbVF64129bFocaAS0UULmGmiYElFnB/qX+CZKCOhZbldrppRJgCtAku44ElEPoQTJR9VVf3HwnQmLb/QPzYP+4T5bb9ComI1kcRtfmmWxM1oEY1lfDI5G6tOAV6Tv5CXKi7c/pPjY5R/U2qLy5b+W8gW1X5g0gk="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c09" seed="entryContent-linkT139" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c09" seed="entryContent-linkT140" smartracker="on">业务返回码</a>。</td>
</tr>
<tr>
<td>contact_follow_list</td>
<td>是</td>
<td>同时也关注该服务窗的通讯录好友列表，<strong>数据类型为JSON类型字符串，需要再次解析</strong></td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>签名</td>
</tr>
</tbody>
</table>
<p>contact_follow_list解析为JSON后的格式如下：</p>
<pre><code>[
    {
        "avatar": "https://tfsimg.alipay.com/images/partner/T1yf8dXcllXXXXXXXX",
        "contactName": "联系人A",
        "defaultAvatar": false,
        "eachRecordFlag": true,
        "userId": "-RwBr5IW9zBWzE7X+fRrUY97w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01"
    },
    {
        "avatar": "https://tfsimg.alipay.com/images/partner/T1MC0aXlRrXXXXXXXX",
        "contactName": "联系人B",
        "defaultAvatar": false,
        "eachRecordFlag": true,
        "userId": "qLxjqikSQ0Wy+mdAeQOpM497w0QKRHRl-OmymTOxsGHnKDWiwQekMHiEi06tEbjg01"
    }
]
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>avatar</td>
<td>是</td>
<td>手机联系人用户头像，非标准化尺寸，与用户上传的实际图片有关</td>
</tr>
<tr>
<td>contactName</td>
<td>是</td>
<td>手机联系人姓名，与在用户手机上存储的名字一致</td>
</tr>
<tr>
<td>defaultAvatar</td>
<td>是</td>
<td>是否为默认头像，true表示该用户未上传过头像，我们返回的是默认头像</td>
</tr>
<tr>
<td>eachRecordFlag</td>
<td>是</td>
<td>与当前用户是否为双向好友关系，true表示确定为双向好友关系，即双方都上传了通讯录，并且在支付宝服务器上能够匹配，false表示<strong>不确定</strong>是否为双向好友关系</td>
</tr>
<tr>
<td>userId</td>
<td>是</td>
<td>手机联系人的OpenId</td>
</tr>
</tbody>
</table>
<h2 id="c0504">获取用户收货地址(JSAPI)</h2>
<h3 id="c0504_intro">概述</h3>
<blockquote>
<p>接口名称：selectAddress(JSAPI)，仅支持支付宝钱包8.3及以上版本</p>
<p>使用场景举例：商户在网页上调用该接口，将弹出支付宝钱包收货地址组件，用户选择后页面将收到回调。Demo详见<a href="#c1102" seed="entryContent-JSAPI-Demo" smartracker="on">JSAPI Demo</a>。</p>
</blockquote>
<h3 id="c0504_example">示例代码</h3>
<pre><code>&lt;!--必须首先引入该js库--&gt;
&lt;script src="https://publicexprod.alipay.com/deliveraddress/selectAddress.js"&gt;&lt;/script&gt;

&lt;button id="selectAddress" type='button' class="am-button am-button-blue"&gt;
    点击选择用户收货地址
&lt;/button&gt;

&lt;script&gt;
    document.getElementById('selectAddress').addEventListener('click', function () {
        // 调用am.selectAddress接口并传入回调函数
        am.selectAddress(function (data) {
            alert(JSON.stringify(data));
        })
    }, false);
&lt;/script&gt;

其中返回值data的JSON格式如下：

{
    "address": "古荡街道万塘路18号黄龙时代广场B座",
    "addressCode": "330106",
    "addressId": "214118119",
    "area": "西湖区",
    "city": "杭州市",
    "fullname": "张三",
    "mobilePhone": "13912345678",
    "post": "310012",
    "prov": "浙江省"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h1 id="c06">自定义菜单</h1>
<h2 id="c0601">菜单规范</h2>
<h3 id="c0601_intro">简要说明</h3>
<ol>
<li>菜单创建后，在支付宝钱包客户端是实时生效的</li>
<li>删除原有菜单后，建议开发者至少保留该删除菜单的服务七天以上</li>
<li>最多设置4个一级菜单，每个一级菜单最多设置5个二级菜单，当设置4个一级菜单时，左侧的发送消息按钮将被隐藏</li>
<li>一级菜单最多显示4个汉字，二级菜单最多显示12个汉字</li>
</ol>
<h3 id="c0601_cate">菜单类型</h3>
<p>菜单总共分为以下两种类型：</p>
<ol>
<li>事件型菜单 - 用户点击之后支付宝网关向开发者网关发送<a href="#c0302" seed="entryContent-linkT141" smartracker="on">事件消息</a>，开发者可以通过自定义参数匹配的方式实现业务逻辑</li>
<li>链接型菜单 - 用户点击之后跳转到一个Web页面或者唤起一个本地服务（例如拨通电话），<strong>不向</strong>开发者网关发送消息</li>
</ol>
<h3 id="c0601_ifs">菜单接口</h3>
<p>服务窗平台提供三个接口，分别用于：</p>
<ol>
<li>创建菜单</li>
<li>更新菜单</li>
<li>查询菜单</li>
</ol>
<div id="alipay.mobile.public.menu.add"></div><h2 id="c0602">创建菜单</h2>
<h3 id="c0602_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.menu.add </p>
<p>使用场景举例：开发者通过调用该接口创建菜单。</p>
</blockquote>
<p>菜单只能被创建一次，后续的修改全部由更新菜单接口完成</p>
<h3 id="c0602_content">业务消息内容</h3>
<pre><code>{
    "button": [
        {
            "actionParam": "ZFB_HFCZ", 
            "actionType": "out", 
            "name": "话费充值"
        }, 
        {
            "name": "查询", 
            "subButton": [
                {
                    "actionParam": "ZFB_YECX", 
                    "actionType": "out", 
                    "name": "余额查询"
                }, 
                {
                    "actionParam": "95188", 
                    "actionType": "tel", 
                    "name": "联系我们"
                }, 
                {
                    "actionParam": "http://example.com/a.php", 
                    "actionType": "link", 
                    "name": "话费查询"
                }
            ]
        }, 
        {
            "actionParam": "http://example.com/b.php", 
            "actionType": "link", 
            "name": "帐号绑定"
        }
    ]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>button</td>
<td>一级菜单数组，个数应为1~4个</td>
</tr>
<tr>
<td>subButton</td>
<td>二级菜单数组，个数应为1~5个</td>
</tr>
<tr>
<td>name</td>
<td>菜单标题，一级菜单不超过4个汉字，子菜单不超过12个汉字</td>
</tr>
<tr>
<td>actionType</td>
<td>菜单类型，out:事件型菜单；link:链接型菜单；tel:点击拨打电话</td>
</tr>
<tr>
<td>actionParam</td>
<td>当actionType为link时，该参数为详细链接；当actionType为out时，该参数为用户自定义参数；当actionType为tel时，该参数为电话号码。该参数最长255个字符，不允许冒号等特殊字符</td>
</tr>
</tbody>
</table>
<h3 id="c0602_response">同步响应结果</h3>
<h4 id="c0602_suc">操作成功时的响应结果</h4>
<pre><code>{
    "alipay_mobile_public_menu_add_response": {
        "code": 200,
        "msg": "成功"
    },
    "sign": "gi771WtMTPpLY68/jCibUyHZ1S6wbVFzD+E2ggH2TkwrJAl6tP2a/TyJIgxWrwnoYQfT6MEY3FwzC5x1jAhvb4l31fDKXfhi9iqfs87y4WT27rXRvvszXt5ILOkFLZ7NbZ1lZcZzPvL4fUf5qZLfsGlhzfkMUlThiMD8T+6VqVw="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c0901" seed="entryContent-linkT142" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>msg</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c0901" seed="entryContent-linkT143" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h4 id="c0602_error">操作失败时的响应结果示例</h4>
<pre><code>{
    "alipay_mobile_public_menu_add_response": {
        "code": 11013,
        "msg": "菜单已经创建过"
    },
    "sign": "SFIJp0ZUTrjymCGTfLnfsGBh8objZgCEF1HsDvofpCjCZmTAnuuz/x8rRKiEEtnfipp0XHGpGRykMEzCvaJ6jt+FkAFiU0WCQAhXQFMX62tDCAqWu2RsKJVYeoJf1ApZESbIxAz0GE6WOwDFXQSHlCastLt30Lt4s9+vhiF7cHk="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><div id="alipay.mobile.public.menu.update"></div><h2 id="c0603">更新菜单</h2>
<h3 id="c0603_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.menu.update</p>
<p>使用场景举例：开发者通过调用该接口更新菜单。</p>
</blockquote>
<h3 id="c0603_content">业务消息内容</h3>
<pre><code>{
    "button": [
        {
            "actionParam": "ZFB_WDZH", 
            "actionType": "out", 
            "name": "我的账户"
        }, 
        {
            "name": "查询", 
            "subButton": [
                {
                    "actionParam": "ZFB_YECX", 
                    "actionType": "out", 
                    "name": "余额查询"
                }, 
                {
                    "actionParam": "ZFB_LLCX", 
                    "actionType": "out", 
                    "name": "流量查询"
                }
            ]
        }, 
        {
            "actionParam": "http://m.alipay.com", 
            "actionType": "link", 
            "name": "最新优惠"
        }
    ]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>button</td>
<td>一级菜单数组，个数应为1~4个</td>
</tr>
<tr>
<td>subButton</td>
<td>二级菜单数组，个数应为1~5个</td>
</tr>
<tr>
<td>name</td>
<td>菜单标题，一级菜单不超过4个汉字，子菜单不超过12个汉字</td>
</tr>
<tr>
<td>actionType</td>
<td>菜单类型，out:事件型菜单；link:链接型菜单；tel:点击拨打电话</td>
</tr>
<tr>
<td>actionParam</td>
<td>当actionType为link时，该参数为详细链接；当actionType为out时，该参数为用户自定义参数；当actionType为tel时，该参数为电话号码。该参数最长255个字符，不允许冒号等特殊字符</td>
</tr>
</tbody>
</table>
<h3 id="c0603_response">同步响应结果</h3>
<h4 id="c0603_suc">操作成功时的响应结果</h4>
<pre><code>{
  "alipay_mobile_public_menu_update_response": {
    "code": 200,
    "msg": "成功"
  },
  "sign": "gi771WtMTPpLY68/jCibUyHZ1S6wbVFzD+E2ggH2TkwrJAl6tP2a/TyJIgxWrwnoYQfT6MEY3FwzC5x1jAhvb4l31fDKXfhi9iqfs87y4WT27rXRvvszXt5ILOkFLZ7NbZ1lZcZzPvL4fUf5qZLfsGlhzfkMUlThiMD8T+6VqVw="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c0901" seed="entryContent-linkT144" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>msg</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c0901" seed="entryContent-linkT145" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h4 id="c0603_error">操作失败时的响应结果示例</h4>
<pre><code>{
    "alipay_mobile_public_menu_update_response": {
        "code": 11006,
        "msg": "二级菜单超出个数"
    },
    "sign": "wwd3ofIpMD/eJIYhm3xTJgo4k1YvoW5JYInWxNJLVmqZ4ikTyZ90/KJCNN3PyquWyslego/6FSFj4D9TFRuGFSiTqQ0vnM0TT/wznn/8pKdC8cmmoZAIIAuyA/tnHoWYSt1cG/SsceF2pX87/TEL6rDY7xp36ha6D4SD4cpXxgA="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><div id="alipay.mobile.public.menu.get"></div><h2 id="c0604">查询菜单</h2>
<h3 id="c0604_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.menu.get</p>
<p>使用场景举例：开发者通过调用该接口查询菜单。</p>
</blockquote>
<h3 id="c0604_content">业务消息内容</h3>
<pre><code>{
    // 注：业务参数为空
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h3 id="c0604_response">同步响应结果</h3>
<h4 id="c0604_suc">操作成功时的响应结果</h4>
<pre><code>{
  "alipay_mobile_public_menu_get_response": {
    "code": 200,
    "menu_content": "{\"button\":[{\"actionParam\":\"ZFB_HFCZ\",\"actionType\":\"out\",\"name\":\"话费充值\"},{\"name\":\"查询\",\"subButton\":[{\"actionParam\":\"ZFB_LLCX\",\"actionType\":\"out\",\"name\":\"流量查询\"},{\"actionParam\":\"ZFB_HFCX\",\"actionType\":\"out\",\"name\":\"话费查询\"}]},{\"actionParam\":\"http:\/\/m.alipay.com\",\"actionType\":\"link\",\"name\":\"最新优惠\"}]}",
    "msg": "成功"
  },
  "sign": "lwG5UXgud5EuKsJ2Y5DChoCBC8tm/Zbm9MZVNhmmwIZUqPHb8viAVYG2YIXWsh8+66TiVw9nJms/CVfVDztxLmUEtuQaCICUB8HZVkIgloDxf0ck80E5xzOX1iVEJwk/t9PvRhzMNi/I5BVou3yVEMeP2/gkBYzirIVoZJaRlGg="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c0901" seed="entryContent-linkT146" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>menu_content</td>
<td>菜单内容，<strong>数据类型为JSON类型字符串，需要再次解析</strong></td>
</tr>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<p>menu_content解析为JSON后的格式如下：</p>
<pre><code>{
    "button": [{
        "actionParam": "ZFB_HFCZ",
        "actionType": "out",
        "name": "话费充值"
    }, {
        "name": "查询",
        "subButton": [{
            "actionParam": "ZFB_YECX",
            "actionType": "out",
            "name": "余额查询"
        }, {
            "actionParam": "ZFB_LLCX",
            "actionType": "out",
            "name": "流量查询"
        }, {
            "actionParam": "ZFB_HFCX",
            "actionType": "out",
            "name": "话费查询"
        }]
    }, {
        "actionParam": "http://m.alipay.com",
        "actionType": "link",
        "name": "最新优惠"
    }]
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>button</td>
<td>一级菜单数组，个数应为1~4个</td>
</tr>
<tr>
<td>subButton</td>
<td>二级菜单数组，个数应为1~5个</td>
</tr>
<tr>
<td>name</td>
<td>菜单标题，一级菜单不超过4个汉字，子菜单不超过12个汉字</td>
</tr>
<tr>
<td>actionType</td>
<td>菜单类型，out:事件型菜单；link:链接型菜单；tel:点击拨打电话</td>
</tr>
<tr>
<td>actionParam</td>
<td>当actionType为link时，该参数为详细链接；当actionType为out时，该参数为用户自定义参数；当actionType为tel时，该参数为电话号码。该参数最长255个字符，不允许冒号等特殊字符</td>
</tr>
</tbody>
</table>
<h1 id="c07">推广支持</h1>
<div id="alipay.mobile.public.qrcode.create"></div><h2 id="c0701">带参推广二维码</h2>
<h3 id="c0701_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.qrcode.create</p>
<p>使用场景举例：开发者通过调用该接口创建带参二维码。通过参数开发者可以区分二维码的渠道等信息。</p>
</blockquote>
<h3 id="c0701_content">业务消息内容</h3>
<pre><code>{
    "codeInfo": {
        "scene": {
            "sceneId": "1234"
        }
    },
    "codeType": "TEMP",
    "expireSecond": "1800",
    "showLogo": "N"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>codeType</td>
<td>是</td>
<td>二维码类型，目前只支持两种，TEMP：临时的(默认)；PERM：永久的</td>
</tr>
<tr>
<td>expireSecond</td>
<td>否</td>
<td>临时码过期时间，以秒为单位，最大不超过1800秒；永久码置空</td>
</tr>
<tr>
<td>codeInfo</td>
<td>否</td>
<td>开发者自定义信息</td>
</tr>
<tr>
<td>showLogo</td>
<td>否</td>
<td>二维码中间是否显示服务窗logo，Y：显示；N：不显示（默认）</td>
</tr>
<tr>
<td>sceneId</td>
<td>是</td>
<td>场景Id，最长32位，英文字母、数字以及下划线，开发者自定义</td>
</tr>
</tbody>
</table>
<p>注：用户扫码关注服务窗时候，支付宝网关会向开发者网关发送一条<a href="#c0302" seed="entryContent-linkT147" smartracker="on">关注事件</a>并且带有sceneId参数，用户扫码进入服务窗时，支付宝网关会向开发者网关发送一条<a href="#c0302" seed="entryContent-linkT148" smartracker="on">进入消息</a>并且带有sceneId参数，开发者可以使用<a href="#c0401" seed="entryContent-linkT149" smartracker="on">异步发送消息</a>接口向该用户推送相应消息。</p>
<p>开发者可以参考相关Demo（Demo包请<a href="#c1101_download" seed="entryContent-linkT150" smartracker="on">点此下载</a>）。</p>
<h3 id="c0701_response">同步响应结果</h3>
<h4 id="c0701_suc">操作成功时的响应结果</h4>
<pre><code>{
    "alipay_mobile_public_qrcode_create_response": {
        "code": 200,
        "code_img": "https://mobilecodec.alipay.com/show.htm?code=pvj4hi212zvdbk05bb&amp;picSize=M",
        "expire_second": 1800,
        "msg": "成功"
    },
    "sign": "enek+ijZYazyuAMJrcKCY/hejIi+SH0rMcoHN2aj7CIaxREzJZWh9GAkoQl8bHmg6T9BBnNbwHxc2OTJJeZFxDGp/4DIQBSn3ZCJ94nIzuBbP+7H3hk3cxOc61vQn79S8dy0ymKPUQpEmm8MiFsyxT9ABad1Jt89rBBL8toxlQY="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="#c0901" seed="entryContent-linkT151" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>code_img</td>
<td>二维码图片地址，会经过跳转到实际图片</td>
</tr>
<tr>
<td>expire_second</td>
<td>二维码有效时间，单位（秒）。永久码暂时忽略该信息</td>
</tr>
<tr>
<td>msg</td>
<td>支付宝返回的处理结果说明，请参考<a href="#c0901" seed="entryContent-linkT152" smartracker="on">返回码</a></td>
</tr>
<tr>
<td>sign</td>
<td>RSA加密算法签名</td>
</tr>
</tbody>
</table>
<h4 id="c0701_error">操作失败时的响应结果示例</h4>
<pre><code>{
    "alipay_mobile_public_qrcode_create_response": {
        "code": 1001,
        "msg": "无效的业务参数"
    },
    "sign": "lbRk3InUz2aIhQQOvk6BIRftEOACvDat6Tu/ZzbP9j2G7N6NYT8mRNQx7eHl0wYrtGSrqvc6i2gbmzny+WatLTKO9Zfe8hOP1Uzqh1dDlmfLaCV0Iniwncpue7sDBmPSUWvWTpioVscaB80rTrdbFwNBg32cSWY6sLtxckxg38c="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><h2 id="c0702">带参推广短链接</h2>
<div id="alipay.mobile.public.shortlink.create"></div><h3 id="c0702_intro">概述</h3>
<blockquote>
<p>接口名称：alipay.mobile.public.shortlink.create</p>
<p>使用场景举例：开发者通过调用该接口创建带参短链接。通过参数开发者可以区分短链接的渠道等信息。注：只支持支付宝钱包8.3及以上版本。</p>
</blockquote>
<h3 id="c0702_content">业务消息内容</h3>
<pre><code>{
   "sceneId" : "store_pay_01",
   "remark" : "门店1支付推广"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sceneId</td>
<td>是</td>
<td>短链接对应的场景ID，该ID由商户自己定义</td>
</tr>
<tr>
<td>remark</td>
<td>否</td>
<td>对于场景ID的描述，商户自己定义</td>
</tr>
</tbody>
</table>
<h4 id="c0702_response">同步响应消息业务内容</h4>
<pre><code>{
   "alipay_mobile_public_shortlink_create_response":{
      "shortlink" : "http://t.alipay.com/I/Ev62jVRm",
      "code" : 200,
      "msg" : "成功"
   },
   "sign" : "N4xgzU4EfPguSbVF64129bFocaAS0UULmGmiYElFnB/qX+CZKCOhZbldrppRJgCtAku44ElEPoQTJR9VVf3HwnQmLb/QPzYP+4T5bb9ComI1kcRtfmmWxM1oEY1lfDI5G6tOAV6Tv5CXKi7c/pPjY5R/U2qLy5b+W8gW1X5g0gk="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码。处理成功：200；处理失败：请参考<a href="https://fuwu.alipay.com/platform/doc.htm#c09" seed="entryContent-linkT153" smartracker="on" target="_blank">业务返回码</a>。</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明，请参考<a href="https://fuwu.alipay.com/platform/doc.htm#c09" seed="entryContent-linkT154" smartracker="on" target="_blank">业务返回码</a>。</td>
</tr>
<tr>
<td>shortlink</td>
<td>是</td>
<td>生成的带参推广短链接</td>
</tr>
</tbody>
</table>
<p>注：用户点击短链关注服务窗时候，支付宝网关会向开发者网关发送一条<a href="#c0302" seed="entryContent-linkT155" smartracker="on">关注事件</a>并且带有sceneId参数，用户点击短链进入服务窗时，支付宝网关会向开发者网关发送一条<a href="#c0302" seed="entryContent-linkT156" smartracker="on">进入消息</a>并且带有sceneId参数，开发者可以使用<a href="#c0401" seed="entryContent-linkT157" smartracker="on">异步发送消息</a>接口向该用户推送相应消息。</p>
<h1 id="c12">全民免费WiFi计划</h1>
<p><strong>注：WiFi接口功能已停止新商户申请接入，4月30日18:00本文档的WiFi部分会下线，本次调整将不会影响已经申请了合作的商户</strong></p>
<h2 id="c1201">概述</h2>
<p>加入支付宝全民免费WiFi计划，可以极大提高开发者所拥有热点的商业价值，通过热点实现更多的用户触达、营销，甚至直接打通支付环节实现完整的顾客消息生命周期管理。</p>
<p>在支付宝全民免费WiFi计划中，我们设计的产品系统结构如下：</p>
<p><img alt="" src="3yyxr2xz5r.jpg" seed="entryContent-iIEcmngJpg2014123yyXR2xz5R" smartracker="on" /></p>
<p>开发者可以通过以下三种模式进行未来WiFi商业模式的尝试：</p>
<ol>
<li>接入支付宝免费WiFi计划，即可为开发者的热点增加营销功能，增强设备的市场竞争力，同时享受与支付宝官方合作的品牌推广红利；</li>
<li>接入支付宝免费WiFi计划后，开发者可以享受连接过程中广告带来的收益，我们目前支持在连接成功页嵌入商品售卖告、品牌广告等各类讯息，且暂不收取任何分佣；</li>
<li>接入支付宝免费WiFi计划后，开发者还可以获得当前接入热点的用户数据，并可便捷的向用户发送卡券、红包等营销工具，提高热点对商户带来的商业价值。</li>
</ol>
<h3 id="c1201_prep">接入前期准备</h3>
<h4 id="c1201_prep_create">开通服务窗</h4>
<p>全民免费WiFi计划的产品API全部基于支付宝移动开放平台，开发者必须先行创建一个服务窗应用方可调用下述接口(<a href="http://fuwu.alipay.com/" seed="entryContent-linkT158" smartracker="on" target="_blank">请点此创建服务窗</a>)。
在创建服务窗的过程中，我们会与开发者签署包含WiFi产品在内的服务窗+WiFi联合产品协议。</p>
<h4 id="c1201_prep_applyapi">申请接口权限</h4>
<p><strong>注：WiFi接口功能已停止新商户申请接入，4月30日18:00本文档的WiFi部分会下线，本次调整将不会影响已经申请了合作的商户</strong></p>
<h2 id="c1202">安全基础与接入认证</h2>
<blockquote>
<p>本章仅介绍Portal类型热点的接入认证方式，使用密码登陆的热点接入该计划<strong>无需</strong>阅读本章。</p>
</blockquote>
<p>加入支付宝全民免费WiFi计划，首先需要配置开发者的AP/AC、认证服务器设备，以完成利用支付宝钱包实现的portal路由器设备认证功能。</p>
<h3 id="c1202_otp">认证流程简介</h3>
<p><img alt="" src="3yyxqwzmyx.png" seed="entryContent-iIEcmngPng2014123yyXQwZMYX" smartracker="on" /></p>
<p>OTP(one time password)是支付宝钱包用于身份验证的一项技术。支付宝钱包可以在离线的情况下使用OTP技术为用户生成token，开发者的热点获取该token后，可以向支付宝服务器请求认证，支付宝服务器会验证该token是否有效并且返回认证信息。</p>
<p>整体流程分为以下4步：</p>
<ol>
<li><strong>用户触发认证：</strong>用户在开发者提供的Wifi Portal页点击“支付宝一键上网”按钮，唤起支付宝钱包进行认证上网。</li>
<li><strong>获取离线Token：</strong>支付宝钱包向wifi热点发送上网请求，并且在请求上带有token参数。</li>
<li><strong>支付宝服务器验证Token：</strong>wifi热点可以直接（或者通过开发者的认证服务器）向支付宝服务器发送请求，并且附上token参数。</li>
<li><strong>返回认证结果并放行：</strong>支付宝服务器将认证结果同步返回给wifi热点（或者开发者的认证服务器），wifi热点（或者开发者的认证服务器）根据认证结果，确定是否放行。</li>
</ol>
<p>以下将详细讲解其中的每个步骤。</p>
<h3 id="c1202_portal">第一步：Portal页设置“支付宝一键上网”</h3>
<p>首先，开发者需要在Portal页嵌入“支付宝一键上网”按钮，作为用户一键认证上网的入口。用户点击该按钮后可以唤起钱包进行认证，认证成功后将展示开发者的营销H5页面，或者直接引导用户关注开发者的服务窗。<a href="https://siteprobe.alipay.com/Alipay-Free-Wi-Fi-Sample-clean.html" seed="entryContent-linkT159" smartracker="on" target="_blank">点此查看嵌入样例</a>。</p>
<p><strong>注意：</strong></p>
<ol>
<li>开发者可以选择使用支付宝提供的多套默认portal页样式，也可以自行制作，但是<strong>必须包含</strong><a href="http://pic.alipayobjects.com/e/201403/2FlEeO4zav.png" seed="entryContent-linkT160" smartracker="on" target="_blank">支付宝Logo</a>(白色PNG图片，请下载后用图片软件打开)。</li>
<li><p>支付宝钱包目前只支持Android和iOS版本。在嵌入“支付宝一键上网”按钮时请判断用户客户端类型，只在Android和iOS客户端访问时显示按钮。判断客户端类型的js代码如下：</p>
<pre><code> var browse = "other";
 var ua = navigator.userAgent.toLowerCase();
 var ios = /.*(iphone|ios|ipod|ipad).*/;
 var android = /.*(android|adr).*/;

 //钱包IOS版
 if (ios.test(ua)) {
     browse = "ios";
 }
 //钱包android版
 if (android.test(ua)) {
     browse = "android";
 }
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre></li>
</ol>
<p>然后，开发者需要为Portal页面点击“支付宝一键上网”按钮配置跳转页面地址，在跳转页面中传参以供支付宝钱包进行认证：</p>
<p>   第一步：请从<a href="http://tfs.alipayobjects.com/L1/92/7/alipaywifi.html" seed="entryContent-linkT161" smartracker="on" target="_blank">以下地址</a>下载HTML页面保存在本地。
   第二步：请根据实际情况，修改HTML以下内容：</p>
<pre><code>&lt;form id="alipaywifi_request_data"&gt;
    &lt;input type="hidden" name="authId" id="authId" value=""/&gt;
    &lt;input type="hidden" name="shopId" id="shopId" value="20140611190503616078"/&gt; 
    &lt;input type="hidden" name="authType" id="authType" value="7"/&gt; 
    &lt;input type="hidden" name="user_ip" value=""/&gt;
    &lt;input type="hidden" name="user_mac" value=""/&gt;
&lt;/form&gt;
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>名称</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>authId</td>
<td>否</td>
<td>此参数请置空</td>
</tr>
<tr>
<td>shopId</td>
<td>是</td>
<td>请参阅<a href="#c1203_create" seed="entryContent-linkT162" smartracker="on">创建店铺接口</a></td>
</tr>
<tr>
<td>authType</td>
<td>是</td>
<td>"7"为标准认证模式。若需要AC返回302，支付宝钱包重新向认证服务器发送Token，则此项需要填写为'8'</td>
</tr>
<tr>
<td>user_ip</td>
<td>否</td>
<td>开发者自定义传参</td>
</tr>
<tr>
<td>user_mac</td>
<td>否</td>
<td>开发者自定义传参</td>
</tr>
</tbody>
</table>
<p>   第三步：修改Portal“一键唤起支付宝”的按钮地址，指向上一步部署在本地的HTML页面URL。
   <strong>注意：该HTML页面使用了jquery库，请修改引用本地jquery文件；或为引用的jquery域名开通放行白名单，以防jquery文件在设备未认证状态下无法加载！</strong></p>
<h3 id="c1202_get_token">第二步：获取离线Token</h3>
<p>用户点击“支付宝一键上网”按钮，唤起支付宝钱包后，支付宝钱包会向wifi热点发送请求，并且带上OTP生成的用户token。</p>
<ol>
<li><p>当authType=7时，请求如下：</p>
<p> <a href="http://alipaywifilogin.net/login?alipaytoken=g8CszsnFR1usdCrk4t5rZA" seed="entryContent-linkT163" smartracker="on" target="_blank">http://alipaywifilogin.net/login?alipaytoken=g8CszsnFR1usdCrk4t5rZA</a></p>
<p> 开发者可以选择通过配置路由表，将alipaywifilogin.net指向自己的认证服务器，使用认证服务器获取alipaytoken并且进行下一步认证。也可以选择截获支付宝钱包发出的请求，然后带alipaytoken转发给认证服务器。</p>
</li>
<li><p>当authType=8时，请求如下：
 <a href="http://www.taobao.xn--com%288-ki2hn3w3qs7ju6s2i.xn--5%29-7m8d991b/" seed="entryContent-linkT164" smartracker="on" target="_blank">http://www.taobao.com（支付宝钱包8.5版本）</a>
 <a href="http://www.tmall.com/go/chn/common/network-status.php%EF%BC%88%E6%94%AF%E4%BB%98%E5%AE%9D%E9%92%B1%E5%8C%858.6%E5%8F%8A%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%EF%BC%89" seed="entryContent-linkT165" smartracker="on" target="_blank">http://www.tmall.com/go/chn/common/network-status.php（支付宝钱包8.6及以上版本）</a>
 请同时尝试截获以上两个地址，以避免版本适配问题。</p>
<p> AC/Portal服务器在接收到请求后应返回302响应，跳转地址为认证服务器地址。钱包客户端解析302响应中的跳转地址，附加上alipaytoken参数，并设置HTTP请求UA为”Alipay OTP Client”，向认证服务器发起HTTP请求</p>
</li>
</ol>
<p><strong>注意：此Token采用base64方法生成，中间会有部分特殊字符，请在二次编码、解码时注意保持Token的完整性。</strong>
<strong>若AP/AC不支持配置路由表和直接转发请求，则可以返回带认证服务器地址的302响应，支付宝钱包会再次将认证token按返回的地址直接发送至认证服务器。</strong></p>
<p>请求中的输入参数如下：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>alipaytoken</td>
<td>是</td>
<td>基于OTP的身份认证token，长度为24个字符。需要透传给支付宝WiFi用户认证接口进行支付宝WiFi用户身份认证</td>
</tr>
</tbody>
</table>
<p>Http请求Header信息：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>User-Agent</td>
<td>是</td>
<td>标识支付宝钱包客户端，取值固定</td>
</tr>
</tbody>
</table>
<p>为”Alipay OTP Client”。不带UA头信息的，则不触发本流程|</p>
<h3 id="c1202_validate">第三步、支付宝服务器验证Token</h3>
<blockquote>
<p>接口名称：alipay.siteprobe.user.info.get</p>
<p>使用场景举例：开发者认证服务器通过本接口向支付宝服务器做用户认证</p>
</blockquote>
<h4 id="c1202_validate_content">业务消息内容</h4>
<pre><code>{
    "alipaytoken": "g8CszsnFR1usdCrk4t5rZA==",
    "shop_id": "20140703120348430603"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>名称</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>alipaytoken</td>
<td>是</td>
<td>支付宝客户端请求中的alipaytoken参数值（24个字符）</td>
</tr>
<tr>
<td>shop_id</td>
<td>否</td>
<td>当前连接WiFi设备所属的店铺Id</td>
</tr>
</tbody>
</table>
<h4 id="c1202_validate_response">同步响应结果</h4>
<pre><code>{
    "alipay_siteprobe_user_info_get_response":{
        "code":200,
        "msg":"成功",
        "phone":"15889503601",
        "open_id_1":"2014070312034",
        "open_id_2":"2014086713533"
    },
    "sign":"mfPaNe49A6eOI6C2l78vvETLbayT9QQh="
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>名称</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>返回码说明信息</td>
</tr>
<tr>
<td>phone</td>
<td>否</td>
<td>支付宝用户绑定手机号码</td>
</tr>
<tr>
<td>open_id_1</td>
<td>是</td>
<td>该用户对应于设备提供商服务窗的OpenId</td>
</tr>
<tr>
<td>open_id_2</td>
<td>否</td>
<td>该用户对应于该店铺服务窗的OpenId（请求参数中包含shop_id的可以拿到该参数）</td>
</tr>
<tr>
<td>sign</td>
<td>是</td>
<td>加签值</td>
</tr>
</tbody>
</table>
<h3 id="c1202_result">第四步、返回认证结果并放行</h3>
<p>认证成功后，需要开发者的AP/AC设备，在<a href="#c1202_get_token" seed="entryContent-linkT166" smartracker="on">第二步：获取离线Token</a>后，同步返回给支付宝钱包客户端的http response中，告知其是否已认证成功被放行。如果需要钱包再次进行http请求才能放行的，请附带上用于放行的URL给支付宝钱包，支付宝钱包访问对应的放行URL实现真正放行。</p>
<p>http response输出格式为JSON。正常的情况下，无论授权通过与否，Http Code都需为200 OK，具体的处理结果信息在响应body中给出。异常情况下，参考Http规范返回对应的<a href="#c1201_OTP_ReturnResult_code" seed="entryContent-Http-Code" smartracker="on">Http Code</a>。</p>
<h4 id="c1201_OTP_ReturnResult_response">同步响应结果</h4>
<pre><code>{
    "code": "100",
    "msg": "授权上网成功",
    "open_id1": "2014070312034",
    "open_id2": "2014086713533",
    "auth_url": "http://www.xyz.com:7080/login?vtoken=xxxxxx",
    "method": "post"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>否</td>
<td>返回码描述信息</td>
</tr>
<tr>
<td>open_id1</td>
<td>是</td>
<td>设备提供商应用中支付宝用户的Id，接透传支付宝WiFi用户认证接口认证接口返回的open_id1</td>
</tr>
<tr>
<td>open_id2</td>
<td>否</td>
<td>店铺绑定服务窗应用中支付宝用户的Id，接透传支付宝WiFi用户认证接口认证接口返回的open_id2</td>
</tr>
<tr>
<td>auth_url</td>
<td>否</td>
<td>如果需要支付宝钱包再次发起http请求进行上网放行认证，则通过此参数返回认证请求url。此时返回码必须为200</td>
</tr>
<tr>
<td>method</td>
<td>否</td>
<td>向auth_url发请求的模式，GET或者POST。默认为GET</td>
</tr>
</tbody>
</table>
<h2 id="c1203">店铺管理接口</h2>
<p>店铺，是支付宝免费WiFi计划中营销管理的基本单位。每个店铺可以管理自己独立且唯一的营销内容，包括推荐用户关注服务窗或展示自定义的H5内容页面。每个店铺可以下挂若干个设备，当支付宝钱包连接设备成功上网后，展示该设备所属店铺的营销内容。</p>
<p>每个店铺包含以下信息：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>third_party_shop_name</td>
<td>第三方店铺名称</td>
<td>开发者传给支付宝用于数据备份的店铺名称</td>
</tr>
<tr>
<td>shop_name</td>
<td>支付宝店铺名称</td>
<td>在支付宝钱包中实际显示的店铺名称</td>
</tr>
<tr>
<td>logo</td>
<td>支付宝店铺Logo</td>
<td>在支付宝钱包中实际显示的店铺LOGO</td>
</tr>
<tr>
<td>shop_notice</td>
<td>店铺公告</td>
<td>在支付宝钱包中实际显示的店铺公告</td>
</tr>
<tr>
<td>adv_type</td>
<td>推广类型：NA或Public或H5</td>
<td>在支付宝钱包中连接成功后显示的内容类型：“H5”代表自定义H5页面，“Public”代表服务窗（若此时未绑定服务窗则报错），“NA”代表不展示任何内容</td>
</tr>
<tr>
<td>public_name</td>
<td>服务窗名称</td>
<td>该店铺绑定的用于推荐的服务窗名称</td>
</tr>
<tr>
<td>h5url</td>
<td>H5广告页URL</td>
<td>在支付宝钱包中连接成功后显示的H5广告页面地址</td>
</tr>
</tbody>
</table>
<h3 id="c1203_create">新建店铺接口</h3>
<div id="alipay.siteprobe.shop.info.add"></div><h4 id="c1203_create_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.shop.info.add</p>
<p>使用场景举例：新建WiFi店铺，店铺名称和LOGO默认初始化为统一的“支付宝全民免费WiFi计划”和对应LOGO；当店铺绑定服务窗后，会自动将店铺名称和LOGO更新为服务窗名称和头像。</p>
</blockquote>
<h4 id="c1203_create_content">业务消息内容</h4>
<pre><code>{
    "third_party_shop_id":"12345677", 
    "third_party_shop_name":"诚一良品", 
    "shop_notice":"公告", 
    "adv_type":"h5", 
    "h5_url":"http://www.taobao.com"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>third_party_shop_id</td>
<td>是</td>
<td>第三方ShopID</td>
</tr>
<tr>
<td>third_party_shop_name</td>
<td>是</td>
<td>第三方店铺名称</td>
</tr>
<tr>
<td>shop_notice</td>
<td>否</td>
<td>店铺公告</td>
</tr>
<tr>
<td>adv_type</td>
<td>是</td>
<td>推广类型，“H5”表示展示自定义H5页面，“NA”表示不展示任何信息</td>
</tr>
<tr>
<td>h5_url</td>
<td>否</td>
<td>H5广告页URL（推广类型选择“H5”时为必填，选择“NA”时为选填）</td>
</tr>
</tbody>
</table>
<h4 id="c1203_create_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_shop_info_add_response":{
        "code":200,
        "msg":"成功",
        "shop_id":"12345678"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
<tr>
<td>shop_id</td>
<td>是</td>
<td>由支付宝生成的唯一店铺ID，成功时返回。此shopid在进行设备认证——portal页唤起钱包时需要使用到，详见<a href="#c1202_portal" seed="entryContent-linkT167" smartracker="on">第一步：Portal页设置“支付宝一键上网” </a></td>
</tr>
</tbody>
</table>
<h3 id="c1203_delete">删除店铺接口</h3>
<div id="alipay.siteprobe.shop.info.delete"></div><h4 id="c1203_delete_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.shop.info.delete</p>
<p>使用场景举例：删除已创建的店铺。店铺有下挂设备时不可删除，返回特殊错误码。</p>
</blockquote>
<h4 id="c1203_delete_content">业务消息内容</h4>
<pre><code>{
    "shop_id":"12345678"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shop_id</td>
<td>是</td>
<td>店铺ID</td>
</tr>
</tbody>
</table>
<h4 id="c1203_delete_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_device_info_delete_response":{
        "code":200,
        "msg":"成功"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
</tbody>
</table>
<h3 id="c1203_modify">修改店铺接口</h3>
<div id="alipay.siteprobe.shop.info.update"></div><h4 id="c1203_modify_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.shop.info.update</p>
<p>使用场景举例：修改已创建店铺的信息。仅可通过该接口修改店铺的公告，营销推广展示内容的类型，以及H5类型推广内容的自定义页面URL。支持修改1条或者N条属性，不填写的属性字段则不进行修改。</p>
</blockquote>
<h4 id="c1203_modify_content">业务消息内容</h4>
<pre><code>{
    "shop_id":"12345678", 
    "shop_notice":"公告", 
    "adv_type":"h5", 
    "h5_url":"http://www.taobao.com"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shop_id</td>
<td>是</td>
<td>店铺ID</td>
</tr>
<tr>
<td>shop_notice</td>
<td>否</td>
<td>店铺公告</td>
</tr>
<tr>
<td>adv_type</td>
<td>是</td>
<td>推广类型，“H5”代表自定义H5页面，“Public”代表服务窗（若此时未绑定服务窗则报错），“NA”代表不展示任何内容</td>
</tr>
<tr>
<td>h5_url</td>
<td>否</td>
<td>H5广告页URL（adv_type选择H5时该项必填）</td>
</tr>
</tbody>
</table>
<h4 id="c1203_modify_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_shop_info_update_response":{
        "code":200,
        "msg":"成功"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
</tbody>
</table>
<h3 id="c1203_search">查询店铺接口</h3>
<div id="alipay.siteprobe.shop.info.get"></div><h4 id="c1203_search_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.shop.info.get</p>
<p>使用场景举例：根据shopID查询对应店铺详细信息。</p>
</blockquote>
<h4 id="c1203_search_content">业务消息内容</h4>
<pre><code>{
    "shop_id":"12345678"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shop_id</td>
<td>是</td>
<td>店铺ID</td>
</tr>
</tbody>
</table>
<h4 id="c1203_search_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_shop_info_get_response":{
        "code":200,
        "msg":"成功",
        "third_party_shop_name":"诚一良品",
        "shop_name":"诚一良品",
        "logo":"https://tfsimg.alipay.com/images/publichome/T1pYNeXnj",
        "shop_notice":"欢迎来到诚一良品",
        "adv_type":"public",
        "public_name":"全民免费WiFi计划",
        "url":"http://www.taobao.com"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
<tr>
<td>third_party_shop_name</td>
<td>是</td>
<td>第三方店铺名称</td>
</tr>
<tr>
<td>shop_name</td>
<td>是</td>
<td>支付宝店铺名称</td>
</tr>
<tr>
<td>logo</td>
<td>是</td>
<td>支付宝店铺Logo</td>
</tr>
<tr>
<td>shop_notice</td>
<td>是</td>
<td>店铺公告</td>
</tr>
<tr>
<td>adv_type</td>
<td>是</td>
<td>推广类型，“H5”代表自定义H5页面，“Public”代表服务窗（若此时未绑定服务窗则报错），“NA”代表不展示任何内容</td>
</tr>
<tr>
<td>public_name</td>
<td>是</td>
<td>服务窗名称</td>
</tr>
<tr>
<td>url</td>
<td>是</td>
<td>H5广告页URL</td>
</tr>
</tbody>
</table>
<h3 id="c1203_binding">绑定服务窗接口</h3>
<div id="alipay.siteprobe.shop.public.bind"></div><h4 id="c1203_binding_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.shop.public.bind</p>
<p>使用场景举例：未绑定服务窗时，店铺名称和LOGO默认为“支付宝”和全民免费WiFi计划的logo。调用该接口绑定服务窗成功后，支付宝服务器会将店铺名称、店铺Logo修改为绑定的服务窗名称、服务窗LOGO。</p>
<p>调用服务窗绑定接口需要经过PC OAuth 2.0授权，流程详见<a href="https://openhome.alipay.com/doc/docIndex.htm?url=https://openhome.alipay.com/doc/viewKbDoc.htm?key=236615_236620_259878&amp;type=info" seed="entryContent-linkT168" smartracker="on" target="_blank">支付宝开放平台授权2.0介绍</a>。</p>
</blockquote>
<p>OAuth 2.0 URL拼接规则：<a href="https://openauth.alipay.com/oauth2/authorize.htm?client_id=APPID&amp;redirect_uri=ENCODED_URL" seed="entryContent-linkT169" smartracker="on" target="_blank">https://openauth.alipay.com/oauth2/authorize.htm?client_id=APPID&amp;redirect_uri=ENCODED_URL</a></p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>client_id</td>
<td>是</td>
<td>开发者服务窗的AppId</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>是</td>
<td>回跳页面，是经过转义的url链接（url必须以http或者https开头），比如：http%3A%2F%2Fexample.com</td>
</tr>
</tbody>
</table>
<h4 id="c1203_binding_content">业务消息内容</h4>
<p>绑定服务窗接口的POST消息格式与其他API参数略有不同，多出了auth_token参数（auth_token由<a href="https://openhome.alipay.com/doc/docIndex.htm?url=https://openhome.alipay.com/doc/viewKbDoc.htm?key=236615_236620_259878&amp;type=info" seed="entryContent-linkT170" smartracker="on" target="_blank">支付宝开放平台授权2.0介绍-第四步：获取授权令牌</a>获得），格式如下：</p>
<pre><code>REQUEST URL: https://openapi.alipay.com/gateway.do
REQUEST METHOD: POST
CONTENT:
    method=alipay.siteprobe.shop.public.bind
    timestamp=2014-07-29 20:30:30
    app_id=2014070100171523
    auth_token=publicpB9ea460ff5b5c468c9ccf5e967dc34963
    biz_content={"shop_id":"12345678"}
    charset=GBK
    version=1.0
    sign_type=RSA
    sign=R48FPxFxDSzred4JQ+sLsjzzNen5eZVjVcOgepxBgNFwhIxn0XrqDR53Di6fv1nLMIGEDm0VyGq516J8sVj4rlUSLehHy+oN7s7m07dYk+6xHpoIz4A1+N2tlCmtiHslWGxF6KMEYVjZLHo/y7tEwHQJ6r4H1svT3CJJ2HJpK1o=
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>其中biz_content内容为：</p>
<pre><code>{
    "shop_id":"12345678"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shop_id</td>
<td>是</td>
<td>支付宝店铺ID</td>
</tr>
</tbody>
</table>
<h4 id="c1203_binding_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_shop_public_bind_response":{
        "code":200,
        "msg":"成功",
        "public_name":"诚一良品",
        "public_logo":"https://tfsimg.alipay.com/images/publichome/T1pCBcXex.png"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
<tr>
<td>public_name</td>
<td>是</td>
<td>服务窗名称</td>
</tr>
<tr>
<td>public_logo</td>
<td>是</td>
<td>服务窗Logo</td>
</tr>
</tbody>
</table>
<h3 id="c1203_unbinding">解绑服务窗接口</h3>
<div id="alipay.siteprobe.shop.public.unbind"></div><h4 id="c1203_unbinding_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.shop.public.unbind</p>
<p>使用场景举例：解绑服务窗后，店铺名称和LOGO充值为默认的“支付宝全民免费WiFi计划”和对应的LOGO。</p>
<p>调用服务窗解绑接口需要经过PC OAuth 2.0授权，流程详见<a href="https://openhome.alipay.com/doc/docIndex.htm?url=https://openhome.alipay.com/doc/viewKbDoc.htm?key=236615_236620_259878&amp;type=info" seed="entryContent-linkT171" smartracker="on" target="_blank">支付宝开放平台授权2.0介绍</a>。</p>
</blockquote>
<p>OAuth 2.0 URL拼接规则：</p>
<pre><code>https://openauth.alipay.com/oauth2/authorize.htm?client_id=APPID&amp;redirect_uri=ENCODED_URL
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>client_id</td>
<td>是</td>
<td>开发者服务窗的AppId</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>是</td>
<td>回跳页面，是经过转义的url链接（url必须以http或者https开头），比如：http%3A%2F%2Fexample.com</td>
</tr>
</tbody>
</table>
<h4 id="c1203_binding_content">业务消息内容</h4>
<p>绑定服务窗接口的POST消息格式与其他API参数略有不同，多出了auth_token参数（auth_token由<a href="https://openhome.alipay.com/doc/docIndex.htm?url=https://openhome.alipay.com/doc/viewKbDoc.htm?key=236615_236620_259878&amp;type=info" seed="entryContent-linkT172" smartracker="on" target="_blank">支付宝开放平台授权2.0介绍-第四步：获取授权令牌</a>获得），格式如下：</p>
<pre><code>REQUEST URL: https://openapi.alipay.com/gateway.do
REQUEST METHOD: POST
CONTENT:
    method=alipay.siteprobe.shop.public.unbind
    timestamp=2014-07-29 20:30:30
    app_id=2014070100171523
    auth_token=publicpB9ea460ff5b5c468c9ccf5e967dc34963
    biz_content={"shop_id":"12345678"}
    charset=GBK
    version=1.0
    sign_type=RSA
    sign=R48FPxFxDSzred4JQ+sLsjzzNen5eZVjVcOgepxBgNFwhIxn0XrqDR53Di6fv1nLMIGEDm0VyGq516J8sVj4rlUSLehHy+oN7s7m07dYk+6xHpoIz4A1+N2tlCmtiHslWGxF6KMEYVjZLHo/y7tEwHQJ6r4H1svT3CJJ2HJpK1o=
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>其中biz_content内容为：</p>
<pre><code>{
    "shop_id":"12345678"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shop_id</td>
<td>是</td>
<td>支付宝店铺ID</td>
</tr>
</tbody>
</table>
<h4 id="c1203_unbinding_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_shop_public_unbind_response":{
        "code":200,
        "msg":"成功"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
</tbody>
</table>
<h2 id="c1204">设备管理接口</h2>
<p>设备，是挂载在店铺下的供支付宝钱包连接上网的对应热点。设备的录入，主要用于在Android系统上，支付宝钱包进入热点范围后主动触发的PUSH通知。
当设备被挂载在店铺下后，只有店铺所有者方有权限调用设备管理接口组。</p>
<p>每个设备包含以下信息：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>参数说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>ssid</td>
<td>路由器SSID</td>
<td>在用户手机中显示出来的热点名称</td>
</tr>
<tr>
<td>bssid</td>
<td>路由器Mac地址</td>
<td>向支付宝报备该bssid后，用户手机进入对应的设备热点范围内将自动弹出PUSH提示连接</td>
</tr>
<tr>
<td>password</td>
<td>路由器密码</td>
<td>用于支付宝钱包帮助用户自动连接密码型路由器。portal型路由器请置空该项</td>
</tr>
<tr>
<td>auth_type</td>
<td>认证类型</td>
<td>该路由器实际使用的认证方式："7"为标准认证模式；若需要AC返回302，支付宝钱包重新向认证服务器发送Token，则此项需要填写为'8'。</td>
</tr>
<tr>
<td>auth_id</td>
<td>认证子类型ID</td>
<td>请置空该项</td>
</tr>
<tr>
<td>shop_id</td>
<td>店铺ID</td>
<td>当前路由器所属的店铺ID</td>
</tr>
<tr>
<td>status</td>
<td>是否上架</td>
<td>表示该设备是否需要主动弹出PUSH：“0”表示不需要；“1”表示需要</td>
</tr>
<tr>
<td>longitude</td>
<td>否</td>
<td>设备在高德地图上的位置经度。建议填写，否则系统将尝试自动搜索并填充设备的位置信息，但如果搜索失败，支付宝钱包将无法主动发现设备和弹出PUSH通知。</td>
</tr>
<tr>
<td>latitude</td>
<td>否</td>
<td>设备在高德地图上的位置纬度。建议填写，否则系统将尝试自动搜索并填充设备的位置信息，但如果搜索失败，支付宝钱包将无法主动发现设备和弹出PUSH通知。</td>
</tr>
</tbody>
</table>
<h3 id="c1204_add">增加设备接口</h3>
<div id="alipay.siteprobe.device.info.add"></div><h4 id="c1204_add_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.device.info.add</p>
<p>使用场景举例：当增加设备信息中包含店铺ID并且该店铺ID存在时，支付宝服务器将该设备与该店铺进行绑定。</p>
</blockquote>
<p>当增加设备信息中包含店铺ID但是该店铺ID不存在时，返回错误码；当增加的设备BSSID参数与已添加设备冲突时，返回错误码。</p>
<h4 id="c1204_add_content">业务消息内容</h4>
<pre><code>{
    "ssid":"ExampleSsid",
    "bssid":"12:13:42:5c:7b:3a",
    "password":"1123123",
    "auth_type":"7",
    "auth_id":"",
    "shop_id":"122344555",
    "status":"1",
    "longitude":"120.386925",
    "latitude":"36.268544"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ssid</td>
<td>是</td>
<td>路由器SSID</td>
</tr>
<tr>
<td>bssid</td>
<td>是</td>
<td>路由器Mac地址</td>
</tr>
<tr>
<td>password</td>
<td>否</td>
<td>路由器密码</td>
</tr>
<tr>
<td>auth_type</td>
<td>是</td>
<td>认证类型："7"为标准认证模式；若需要AC返回302，支付宝钱包重新向认证服务器发送Token，则此项需要填写为'8'。</td>
</tr>
<tr>
<td>auth_id</td>
<td>否</td>
<td>请置空</td>
</tr>
<tr>
<td>shop_id</td>
<td>是</td>
<td>通过创建店铺接口生成的支付宝店铺ID</td>
</tr>
<tr>
<td>status</td>
<td>否</td>
<td>表示该设备是否需要主动弹出PUSH：“0”表示不需要；“1”表示需要</td>
</tr>
<tr>
<td>longitude</td>
<td>否</td>
<td>设备在高德地图上的位置经度。建议填写，否则系统将尝试自动搜索并填充设备的位置信息，但如果搜索失败，支付宝钱包将无法主动发现设备和弹出PUSH通知。</td>
</tr>
<tr>
<td>latitude</td>
<td>否</td>
<td>设备在高德地图上的位置纬度。建议填写，否则系统将尝试自动搜索并填充设备的位置信息，但如果搜索失败，支付宝钱包将无法主动发现设备和弹出PUSH通知。</td>
</tr>
</tbody>
</table>
<p><strong>特别注意：</strong>如果添加设备时未正确填写设备所在位置经纬度longitude和latitude，则Push通知信息无法正常下发到手机端，导致Android手机上不会出现发现该WiFi的Push通知。支付宝对大多数热点设备会通过自动校准机制，在1个自然周后确定设备位置，使Android手机发现WiFi时能够正常出现Push通知。</p>
<h4 id="c1204_add_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_device_info_add_response":{
        "code":200,
        "msg":"成功",
        "device_id":"12345678"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
<tr>
<td>device_id</td>
<td>是</td>
<td>设备ID</td>
</tr>
</tbody>
</table>
<h3 id="c1204_delete">删除设备接口</h3>
<div id="alipay.siteprobe.device.info.delete"></div><h4 id="c1204_delete_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.device.info.delete</p>
<p>使用场景举例：删除WiFi设备，退出支付宝全民免费WiFi计划。重新加入计划时，会分配到全新的deviceid。</p>
</blockquote>
<h4 id="c1204_delete_content">业务消息内容</h4>
<pre><code>{
    "device_id":"12345678"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>device_id</td>
<td>是</td>
<td>设备ID</td>
</tr>
</tbody>
</table>
<h4 id="c1204_delete_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_device_info_delete_response":{
        "code":"200",
        "msg":"成功"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
</tbody>
</table>
<h3 id="c1204_modify">修改设备接口</h3>
<div id="alipay.siteprobe.device.info.update"></div><h4 id="c1204_modify_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.device.info.update</p>
<p>使用场景举例：支持修改1条或者N条属性，不填写的属性字段则不进行修改。</p>
</blockquote>
<h4 id="c1204_modify_content">业务消息内容</h4>
<pre><code>{
    "device_id":"12312312",
    "ssid":"ExampleSsid",
    "bssid":"12:13:42:5c:7b:3a",
    "password":"1123123",
    "auth_type":"7",
    "auth_id":"",
    "shop_id":"122344555",
    "status":"1",
    "longitude":"120.386925",
    "latitude":"36.268544"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>device_id</td>
<td>是</td>
<td>设备ID</td>
</tr>
<tr>
<td>ssid</td>
<td>否</td>
<td>路由器SSID</td>
</tr>
<tr>
<td>bssid</td>
<td>否</td>
<td>路由器Mac地址</td>
</tr>
<tr>
<td>password</td>
<td>否</td>
<td>路由器密码</td>
</tr>
<tr>
<td>auth_type</td>
<td>否</td>
<td>认证类型："7"为标准认证模式；若需要AC返回302，支付宝钱包重新向认证服务器发送Token，则此项需要填写为'8'。</td>
</tr>
<tr>
<td>auth_id</td>
<td>否</td>
<td>请置空</td>
</tr>
<tr>
<td>shop_id</td>
<td>否</td>
<td>需要修改设备所属店铺时，填写支付宝shopid</td>
</tr>
<tr>
<td>status</td>
<td>否</td>
<td>表示该设备是否需要主动弹出PUSH：“0”表示不需要；“1”表示需要</td>
</tr>
<tr>
<td>longitude</td>
<td>否</td>
<td>设备在高德地图上的位置经度。建议填写，否则系统将尝试自动搜索并填充设备的位置信息，但如果搜索失败，支付宝钱包将无法主动发现设备和弹出PUSH通知。</td>
</tr>
<tr>
<td>latitude</td>
<td>否</td>
<td>设备在高德地图上的位置纬度。建议填写，否则系统将尝试自动搜索并填充设备的位置信息，但如果搜索失败，支付宝钱包将无法主动发现设备和弹出PUSH通知。</td>
</tr>
</tbody>
</table>
<h4 id="c1204_modify_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_device_info_update_response":{
        "code":200,
        "msg":"成功"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
</tbody>
</table>
<h3 id="c1204_search">查询设备接口</h3>
<div id="alipay.siteprobe.device.info.get"></div><h4 id="c1204_search_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.device.info.get</p>
<p>使用场景举例：根据设备ID查询设备详细信息。</p>
</blockquote>
<h4 id="c1204_search_content">业务消息内容</h4>
<pre><code>{
    "device_id":"12345678"
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>device_id</td>
<td>是</td>
<td>热点设备ID</td>
</tr>
</tbody>
</table>
<h4 id="c1204_search_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_device_info_get_response":{
        "code":200,
        "msg":"成功",
        "ssid":"ExampleSsid",
        "bssid":"20:e5:2a:51:ec:a0",
        "password":"12345678",
        "auth_type":"7",
        "auth_id":"",
        "shop_id":"12345678",
        "status":"1",
        "longitude":"120.386925",
        "latitude":"36.268544"
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
<tr>
<td>ssid</td>
<td>是</td>
<td>路由器SSID</td>
</tr>
<tr>
<td>bssid</td>
<td>是</td>
<td>路由器Mac地址</td>
</tr>
<tr>
<td>password</td>
<td>否</td>
<td>路由器密码</td>
</tr>
<tr>
<td>auth_type</td>
<td>是</td>
<td>认证类型："7"为标准认证模式；“8”为AC返回302，支付宝钱包重新向认证服务器发送Token。</td>
</tr>
<tr>
<td>auth_id</td>
<td>否</td>
<td>请置空</td>
</tr>
<tr>
<td>shop_id</td>
<td>是</td>
<td>通过创建店铺接口生成的支付宝店铺ID</td>
</tr>
<tr>
<td>status</td>
<td>否</td>
<td>表示该设备是否需要主动弹出PUSH：“0”表示不需要；“1”表示需要</td>
</tr>
<tr>
<td>longitude</td>
<td>否</td>
<td>设备在高德地图上的位置经度。建议填写，否则系统将尝试自动搜索并填充设备的位置信息，但如果搜索失败，支付宝钱包将无法主动发现设备和弹出PUSH通知。</td>
</tr>
<tr>
<td>latitude</td>
<td>否</td>
<td>设备在高德地图上的位置纬度。建议填写，否则系统将尝试自动搜索并填充设备的位置信息，但如果搜索失败，支付宝钱包将无法主动发现设备和弹出PUSH通知。</td>
</tr>
</tbody>
</table>
<h3 id="c1204_batchSearch">批量查询设备接口</h3>
<div id="alipay.siteprobe.device.info.search"></div><h4 id="c1204_batchSearch_intro">概述</h4>
<blockquote>
<p>接口名称：alipay.siteprobe.device.info.search</p>
<p>使用场景举例：根据店铺ID查询店铺下的设备列表。</p>
</blockquote>
<h4 id="c1204_batchSearch_content">业务消息内容</h4>
<pre><code>{
    "shop_id":"12345678",
    "offset":1,
    "limit":200
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shop_id</td>
<td>是</td>
<td>店铺ID</td>
</tr>
<tr>
<td>offset</td>
<td>是</td>
<td>数据偏移量，从该条开始取数据</td>
</tr>
<tr>
<td>limit</td>
<td>否</td>
<td>每次取数据条数，上限200条</td>
</tr>
</tbody>
</table>
<h4 id="c1204_batchSearch_response">同步响应消息业务内容</h4>
<pre><code>{
    "alipay_siteprobe_device_info_search_response": {
        "code": 200,
        "msg": "成功",
        "total": 1000,
        "devices": [
            {
                "device_id": "12345",
                "ssid": "ExampleSsid",
                "bssid": "20:e5:2a:51:ec:a0",
                "password": "1212131",
                "auth_type": "7",
                "auth_id": "",
                "shop_id": "12341234",
                "status": "1",
                "longitude":"120.386925",
                "latitude":"36.268544"
            },
            {
                "device_id": "12346",
                "ssid": "ExampleSsid",
                "bssid": "11:20:12:51:ec:a0",
                "password": "1212131",
                "auth_type": "7",
                "auth_id": "",
                "shop_id": "12341234",
                "status": "1",
                "longitude":"120.386925",
                "latitude":"36.268544"
            },
            ...
        ]
    }
}
</code><span class="clipbord">复制到剪贴版</span><span class="clipbord">复制到剪贴版</span></pre><p>同步响应参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>是否必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>是</td>
<td>返回码</td>
</tr>
<tr>
<td>msg</td>
<td>是</td>
<td>支付宝返回的处理结果说明</td>
</tr>
<tr>
<td>devices</td>
<td>是</td>
<td>设备信息，详细信息为JSON数组格式，具体定义参见<a href="#c1204_search" seed="entryContent-linkT173" smartracker="on">查询设备接口</a></td>
</tr>
</tbody>
</table>
<h1 id="c08">其他接口</h1>
<h2 id="c0801">支付接口</h2>
<h3 id="c0801_wap">手机网站支付</h3>
<p>手机网站支付主要应用于手机、掌上电脑等无线设备的网页上，通过网页跳转或浏览器自带的支付宝快捷支付实现买家付款的功能，资金即时到账。</p>
<p>申请条件：</p>
<ol>
<li>如果您有已经建设完成的无线网站（不包含淘宝网店、团购类网站），您的网站必须已通过ICP备案，备案信息与签约商户信息一致，网站经营的商品或服务内容明确、完整（古玩、珠宝等奢侈品、投资类行业无法申请本产品）；</li>
<li>如果您没有网站请提供应用demo（支持.apk.doc .docx .pdf格式）/或提供已经上线的应用名称，（appstore/豌豆荚/googleplay/91等应用市场上的应用名称，或已生效的服务窗名称；</li>
<li>您申请前必须拥有企业支付宝账号（不含个体工商户账号），且通过支付宝实名认证审核注册企业账号。</li>
</ol>
<p><a href="https://b.alipay.com/order/productDetail.htm?productId=2014110308142133" seed="entryContent-linkT174" smartracker="on" target="_blank">点击在线申请</a></p>
<div id="alipay.mobile.shake.user.query"></div><div id="alipay.pass.sync.add"></div><div id="alipay.pass.sync.update"></div><div id="alipay.pass.tpl.content.update"></div><div id="alipay.pass.tpl.content.add"></div><div id="alipay.pass.tpl.update"></div><div id="alipay.pass.tpl.add"></div><div id="alipay.pass.file.add"></div><h2 id="c0802">卡券接口</h2>
<p>卡券接口文档正在完善中，老接口文档查看请<a href="https://openhome.alipay.com/doc/docIndex.htm?url=https://openhome.alipay.com/doc/viewKbDoc.htm?key=236698&amp;type=cat" seed="entryContent-linkT175" smartracker="on" target="_blank">点此查看</a></p>
<h1 id="c09">附录</h1>
<h2 id="c0901">返回码</h2>
<h3 id="c0901_biz">业务返回码</h3>
<table>
<thead>
<tr>
<th>返回码</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>401</td>
<td>服务窗不存在</td>
</tr>
<tr>
<td>403</td>
<td>服务不可用</td>
</tr>
<tr>
<td>503</td>
<td>系统错误</td>
</tr>
<tr>
<td>813</td>
<td>AppId为空</td>
</tr>
<tr>
<td>828</td>
<td>短链生成失败</td>
</tr>
<tr>
<td>829</td>
<td>sceneId为空</td>
</tr>
<tr>
<td>831</td>
<td>不合法的sceneId</td>
</tr>
<tr>
<td>1001</td>
<td>无效的业务参数</td>
</tr>
<tr>
<td>1002</td>
<td>无效的业务行为</td>
</tr>
<tr>
<td>1003</td>
<td>解析XML/JSON出错</td>
</tr>
<tr>
<td>2001</td>
<td>服务窗账号信息不存在</td>
</tr>
<tr>
<td>2002</td>
<td>服务窗账号暂不能提供服务</td>
</tr>
<tr>
<td>2003</td>
<td>支付宝账号信息不存在</td>
</tr>
<tr>
<td>2004</td>
<td>无效的用户userId</td>
</tr>
<tr>
<td>2005</td>
<td>无效的手机号mobileNo</td>
</tr>
<tr>
<td>2006</td>
<td>无效的身份证号码identityCard</td>
</tr>
<tr>
<td>10001</td>
<td>绑定账户解析格式错误</td>
</tr>
<tr>
<td>10002</td>
<td>关注者fromUserId不能为空</td>
</tr>
<tr>
<td>10003</td>
<td>agreementId不能为空</td>
</tr>
<tr>
<td>10004</td>
<td>绑定账户不能为空</td>
</tr>
<tr>
<td>10005</td>
<td>displayName为空</td>
</tr>
<tr>
<td>10006</td>
<td>displayName超出长度</td>
</tr>
<tr>
<td>10007</td>
<td>realName超出长度</td>
</tr>
<tr>
<td>10008</td>
<td>协议号已被占用</td>
</tr>
<tr>
<td>10009</td>
<td>协议号无效</td>
</tr>
<tr>
<td>10010</td>
<td>协议号已被废弃</td>
</tr>
<tr>
<td>10011</td>
<td>添加外部户业务中的服务窗帐号与消息头服务窗帐号不一致</td>
</tr>
<tr>
<td>10012</td>
<td>重复添加账户</td>
</tr>
<tr>
<td>10013</td>
<td>您添加的账户已达上限</td>
</tr>
<tr>
<td>10014</td>
<td>添加绑定账户失败</td>
</tr>
<tr>
<td>10015</td>
<td>移除绑定账户失败</td>
</tr>
<tr>
<td>10016</td>
<td>禁止移除其它服务窗帐号的绑定账户</td>
</tr>
<tr>
<td>10017</td>
<td>禁止移除其它支付宝用户的绑定账户</td>
</tr>
<tr>
<td>10018</td>
<td>新绑定的户号与要删除的老绑定账户的户号一样,不能换绑</td>
</tr>
<tr>
<td>10019</td>
<td>移除外部户时参数信息不够:agreementId为空时，bindAccountNo和fromUserId均不能为空</td>
</tr>
<tr>
<td>10020</td>
<td>根据bindAccountNo、fromUserId和appId查不到对应的外部账号</td>
</tr>
<tr>
<td>10021</td>
<td>禁止查询非关注用户的绑定账户列表</td>
</tr>
<tr>
<td>10022</td>
<td>请求的支付宝用户Id无效</td>
</tr>
<tr>
<td>11001</td>
<td>菜单解析格式错误</td>
</tr>
<tr>
<td>11002</td>
<td>菜单没有内容</td>
</tr>
<tr>
<td>11003</td>
<td>一级菜单标题超出长度</td>
</tr>
<tr>
<td>11004</td>
<td>二级菜单标题超出长度</td>
</tr>
<tr>
<td>11005</td>
<td>一级菜单超出个数</td>
</tr>
<tr>
<td>11006</td>
<td>二级菜单超出个数</td>
</tr>
<tr>
<td>11007</td>
<td>菜单标题为空</td>
</tr>
<tr>
<td>11008</td>
<td>菜单超出2级</td>
</tr>
<tr>
<td>11009</td>
<td>菜单标题为空</td>
</tr>
<tr>
<td>11010</td>
<td>菜单type不在支持范围内</td>
</tr>
<tr>
<td>11011</td>
<td>无效的关注关系</td>
</tr>
<tr>
<td>11012</td>
<td>推送消息失败</td>
</tr>
<tr>
<td>11013</td>
<td>菜单已经创建过</td>
</tr>
<tr>
<td>11014</td>
<td>菜单actionParam不能为空</td>
</tr>
<tr>
<td>11015</td>
<td>菜单authType非法</td>
</tr>
<tr>
<td>11016</td>
<td>菜单中含有未授权的菜单类型</td>
</tr>
<tr>
<td>11017</td>
<td>菜单中含有非法字符或链接,请检查</td>
</tr>
<tr>
<td>12001</td>
<td>服务窗帐号与消息体内不一致</td>
</tr>
<tr>
<td>12002</td>
<td>消息中含有非法字符或者链接，请检查</td>
</tr>
<tr>
<td>12003</td>
<td>服务窗帐号已经下线,发送消息失败</td>
</tr>
<tr>
<td>12004</td>
<td>批量发送消息频率超限</td>
</tr>
<tr>
<td>12005</td>
<td>使用了已经发送过的分组ID标识</td>
</tr>
<tr>
<td>12006</td>
<td>单发消息频率超限</td>
</tr>
<tr>
<td>12007</td>
<td>没有关注者，发送消息失败</td>
</tr>
<tr>
<td>12008</td>
<td>绑定账户不存在</td>
</tr>
<tr>
<td>12020</td>
<td>消息模板不存在</td>
</tr>
<tr>
<td>12021</td>
<td>消息模板未启用</td>
</tr>
<tr>
<td>12022</td>
<td>无效的消息模板标识templateId</td>
</tr>
<tr>
<td>12023</td>
<td>无效的消息模板内容template</td>
</tr>
<tr>
<td>12024</td>
<td>无效的消息模板KEY，和预设变量KEY冲突</td>
</tr>
<tr>
<td>12025</td>
<td>无效的匹配器matcher</td>
</tr>
<tr>
<td>12026</td>
<td>模板上下文context缺少相关的变量KEY</td>
</tr>
<tr>
<td>12030</td>
<td>用户拒绝接受该服务窗消息</td>
</tr>
<tr>
<td>12031</td>
<td>用户没有行为，发送消息失败</td>
</tr>
<tr>
<td>12035</td>
<td>消息类型非法</td>
</tr>
<tr>
<td>13001</td>
<td>查询用户地理位置信息失败</td>
</tr>
<tr>
<td>13002</td>
<td>服务窗帐号没有查询用户地理位置信息的权限</td>
</tr>
<tr>
<td>13003</td>
<td>禁止查询非关注用户的地理位置信息</td>
</tr>
<tr>
<td>13004</td>
<td>用户地理位置信息不存在</td>
</tr>
<tr>
<td>14001</td>
<td>无效的userId</td>
</tr>
<tr>
<td>14002</td>
<td>系统繁忙,请稍候再次获取</td>
</tr>
<tr>
<td>14004</td>
<td>添加关注失败</td>
</tr>
<tr>
<td>14005</td>
<td>没有添加关注的权限</td>
</tr>
</tbody>
</table>
<h3 id="c0901_security">安全机制错误码</h3>
<p>当商户通过接口请求支付宝，支付宝同步返回参数时，如果支付宝在安全机制环节校验不通过，则返回安全机制异常参数信息，而不会返回本文档中其他章节的同步返回参数。</p>
<p>安全机制异常同步返回参数列表如下：</p>
<table>
<thead>
<tr>
<th>code（错误代码）</th>
<th>msg（错误代码描述）</th>
<th>sub_code（明细错误码）</th>
<th>sub_msg（明细错误码描述）</th>
</tr>
</thead>
<tbody>
<tr>
<td>40001</td>
<td>Missing Required Arguments</td>
<td>isv.missing-method</td>
<td>缺少方法名参数</td>
</tr>
<tr>
<td>40002</td>
<td>Invalid Arguments</td>
<td>isv.invalid-method</td>
<td>不存在的方法名</td>
</tr>
<tr>
<td>40002</td>
<td>Invalid Arguments</td>
<td>isv.invalid-format</td>
<td>无效数据格式</td>
</tr>
<tr>
<td>40001</td>
<td>Missing Required Arguments</td>
<td>isv.missing-signature</td>
<td>缺少签名参数</td>
</tr>
<tr>
<td>40001</td>
<td>Missing Required Arguments</td>
<td>isv.missing-signature-type</td>
<td>缺少签名类型参数</td>
</tr>
<tr>
<td>40001</td>
<td>Missing Required Arguments</td>
<td>isv.missing-signature-key</td>
<td>缺少签名配置（未提供公钥）</td>
</tr>
<tr>
<td>40002</td>
<td>Invalid Arguments</td>
<td>isv.invalid-signature</td>
<td>无效签名</td>
</tr>
<tr>
<td>40002</td>
<td>Invalid Arguments</td>
<td>isv.invalid-signature-type</td>
<td>无效签名类型</td>
</tr>
<tr>
<td>40001</td>
<td>Missing Required Arguments</td>
<td>isv.missing-app-id</td>
<td>缺少AppID参数</td>
</tr>
<tr>
<td>40002</td>
<td>Invalid Arguments</td>
<td>isv.invalid-app-id</td>
<td>无效的AppID参数</td>
</tr>
<tr>
<td>40001</td>
<td>Missing Required Arguments</td>
<td>isv.missing-timestamp</td>
<td>缺少时间戳参数</td>
</tr>
<tr>
<td>40002</td>
<td>Invalid Arguments</td>
<td>isv.invalid-timestamp</td>
<td>非法的时间戳参数</td>
</tr>
<tr>
<td>40002</td>
<td>Invalid Arguments</td>
<td>Isv.invalid-charset</td>
<td>字符集错误</td>
</tr>
<tr>
<td>40003</td>
<td>invalid-app-state</td>
<td>Isv.invalid-app-state</td>
<td>应用状态不满足条件</td>
</tr>
<tr>
<td>20001</td>
<td>Insufficient Token Permissions</td>
<td>invalid-auth-token</td>
<td>无效的访问令牌</td>
</tr>
<tr>
<td>20001</td>
<td>Insufficient Token Permissions</td>
<td>aop.auth-token-time-out</td>
<td>访问令牌已过期</td>
</tr>
<tr>
<td>20000</td>
<td>Service Currently Unavailable</td>
<td>aop.unknow-error</td>
<td>系统繁忙</td>
</tr>
<tr>
<td>20000</td>
<td>Service Currently Unavailable</td>
<td>isp.unknow-error</td>
<td>系统繁忙</td>
</tr>
</tbody>
</table>
<h1 id="c10">JS接口</h1>
<p>我们为开发者提供了JSAPI的Demo合集，详见<a href="#c1102" seed="entryContent-JSAPI-DemoT1" smartracker="on">JSAPI Demo</a></p>
<table>
<thead>
<tr>
<th>接口名称</th>
<th>接口说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#alipayjsbridgeready" seed="entryContent-AlipayJSBridgeReady" smartracker="on" target="_blank">AlipayJSBridgeReady</a></td>
<td>JSBridge ready事件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#resume" seed="entryContent-resume" smartracker="on" target="_blank">resume</a></td>
<td>当一个webview界面重新回到栈顶时触发该事件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#back-%E5%90%8E%E9%80%80" seed="entryContent-back" smartracker="on" target="_blank">back</a></td>
<td>点击底部工具栏或者安卓回退按钮触发该事件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#checkjsapi-jsapi%E5%8F%AF%E7%94%A8%E6%80%A7%E5%88%A4%E6%96%AD" seed="entryContent-checkJSAPI" smartracker="on" target="_blank">checkJSAPI</a></td>
<td>JSApi可用性判断</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#checkapp-%E9%92%B1%E5%8C%85%E5%86%85app%E5%8F%AF%E7%94%A8%E6%80%A7%E5%88%A4%E6%96%AD" seed="entryContent-checkApp" smartracker="on" target="_blank">checkApp</a></td>
<td>钱包内App（比如余额宝、转账等）可用性判断</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#isinstalledapp-%E5%A4%96%E9%83%A8%E5%BA%94%E7%94%A8%E5%AD%98%E5%9C%A8%E6%80%A7%E5%88%A4%E6%96%AD" seed="entryContent-isInstalledApp" smartracker="on" target="_blank">isInstalledApp</a></td>
<td>检测外部App是否安装，比如淘宝主客</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#optionmenu" seed="entryContent-optionMenu" smartracker="on" target="_blank">optionMenu</a></td>
<td>点击顶部标题栏右方按钮触发该事件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#toolbarmenuclick" seed="entryContent-toolbarMenuClick" smartracker="on" target="_blank">toolbarMenuClick</a></td>
<td>点击顶部标题栏菜单触发该事件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#titleclick" seed="entryContent-titleClick" smartracker="on" target="_blank">titleClick</a></td>
<td>点击顶部标题栏标题触发该事件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#subtitleclick" seed="entryContent-subtitleClick" smartracker="on" target="_blank">subtitleClick</a></td>
<td>点击顶部标题栏副标题触发该事件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#titlebar-%E6%8E%A7%E5%88%B6%E6%A0%87%E9%A2%98%E6%A0%8F" seed="entryContent-titlebar" smartracker="on" target="_blank">titlebar</a></td>
<td>显示/隐藏顶部标题栏（默认隐藏），设置标题等操作</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#toolbar-%E8%AE%BE%E7%BD%AE%E5%B7%A5%E5%85%B7%E6%A0%8F" seed="entryContent-toolbar" smartracker="on" target="_blank">toolbar</a></td>
<td>显示/隐藏底部工具栏</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#toast-%E5%BC%B1%E6%8F%90%E7%A4%BA" seed="entryContent-toast" smartracker="on" target="_blank">toast</a></td>
<td>弹出Toast提示</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#settoolbarmenu-%E8%AE%BE%E7%BD%AE%E8%8F%9C%E5%8D%95%E9%A1%B9" seed="entryContent-setToolbarMenu" smartracker="on" target="_blank">setToolbarMenu</a></td>
<td>设置底部工具栏菜单项自定义选项</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#alert-%E5%AF%B9%E8%AF%9D%E6%A1%86" seed="entryContent-Alert" smartracker="on" target="_blank">Alert</a></td>
<td>弹出对话框</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#confirm-%E9%80%89%E6%8B%A9%E5%AF%B9%E8%AF%9D%E6%A1%86" seed="entryContent-Confirm" smartracker="on" target="_blank">Confirm</a></td>
<td>弹出选择对话框</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#loading-%E5%8A%A0%E8%BD%BD%E4%B8%AD%E6%8F%90%E7%A4%BA" seed="entryContent-loading" smartracker="on" target="_blank">loading</a></td>
<td>弹出加载中提示</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#popto-%E9%80%80%E5%9B%9E%E6%8C%87%E5%AE%9A%E7%95%8C%E9%9D%A2" seed="entryContent-popTo" smartracker="on" target="_blank">popTo</a></td>
<td>退回指定会话界面栈中的某个界面</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#exitapp-%E9%80%80%E5%87%BA%E5%BD%93%E5%89%8Dh5%E5%BA%94%E7%94%A8" seed="entryContent-exitApp" smartracker="on" target="_blank">exitApp</a></td>
<td>退出当前所有WebView</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#openinbrowser-%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E6%89%93%E5%BC%80" seed="entryContent-openInBrowser" smartracker="on" target="_blank">openInBrowser</a></td>
<td>浏览器中打开</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#%E7%AA%97%E5%8F%A3%E6%8E%A7%E5%88%B6" seed="entryContent-linkT176" smartracker="on" target="_blank">窗口控制</a></td>
<td>打开/关闭WebView</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#getnetworktype-%E8%8E%B7%E5%8F%96%E7%BD%91%E7%BB%9C%E7%8A%B6%E6%80%81" seed="entryContent-getNetworkType" smartracker="on" target="_blank">getNetworkType</a></td>
<td>获取用户网络状态，wifi或者非wifi</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#photo-%E6%8B%8D%E7%85%A7/%E9%80%89%E6%8B%A9%E7%85%A7%E7%89%87" seed="entryContent-photo" smartracker="on" target="_blank">photo</a></td>
<td>拍照/选择照片</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#share-%E5%88%86%E4%BA%AB" seed="entryContent-share" smartracker="on" target="_blank">share</a></td>
<td>调用系统分享组件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#getcities-%E5%9F%8E%E5%B8%82%E9%80%89%E6%8B%A9" seed="entryContent-getCities" smartracker="on" target="_blank">getCities</a></td>
<td>调用Native的选择城市组件</td>
</tr>
<tr>
<td><a href="http://am-team.github.io/h5container/jsapi-doc.html#vibrate-%E8%B0%83%E7%94%A8%E9%9C%87%E5%8A%A8" seed="entryContent-vibrate" smartracker="on" target="_blank">vibrate</a></td>
<td>调用震动</td>
</tr>
<tr>
<td><a href="#c0504" seed="entryContent-linkT177" smartracker="on">收货地址接口</a></td>
<td>获取用户收货地址</td>
</tr>
</tbody>
</table>
<h1 id="c11">开发者工具</h1>
<h2 id="c1101">SDK与Demo</h2>
<h3 id="c1101_intro">概述</h3>
<p>建议开发者使用支付宝提供的SDK进行服务窗开发，使用SDK进行开发有以下优点：</p>
<ol>
<li>SDK会随着新接口的发布而同步更新</li>
<li>SDK会随着老接口的更新而同步更新</li>
<li>SDK让底层逻辑变得透明和简单，开发者只需关注于自身的业务逻辑</li>
<li>SDK集成了编码、签名等常用方法，开发者无需额外耗费时间</li>
<li>提供了基于SDK开发的Demo，开发者上手更容易</li>
</ol>
<p>目前提供了多个语言版本的Demo（包括JDK 1.4、JDK 1.5、.NET2010以及PHP）。Demo包含以下几类业务场景：</p>
<ol>
<li>接入与验证示例</li>
<li>同步回复消息示例</li>
<li>关注事件示例</li>
<li>取消关注事件示例</li>
<li>普通进入事件示例</li>
<li>文本消息事件示例</li>
<li>文本消息事件示例</li>
<li>异步单发文本消息示例（以回复菜单点击事件为例）</li>
<li>异步单发图文消息示例</li>
<li>异步单发图文消息（含免登功能）示例</li>
<li>群发文本消息示例</li>
<li>群发图文消息示例</li>
<li>网页授权获取用户信息示例</li>
<li>带参二维码进入事件示例</li>
</ol>
<h3 id="c1101_download">下载链接</h3>
<p>SDK下载：</p>
<ol>
<li><a href="http://openhome.alipay.com/doc/sdkDownload.resource?sdkType=JAVA" seed="entryContent-linkT178" smartracker="on" target="_blank">Java-JDK 1.5 SDK</a></li>
<li><a href="http://openhome.alipay.com/doc/sdkDownload.resource?sdkType=JDK14" seed="entryContent-linkT179" smartracker="on" target="_blank">Java-JDK 1.4 SDK</a></li>
<li><a href="http://openhome.alipay.com/doc/sdkDownload.resource?sdkType=PHP" seed="entryContent-PHP-SDKT1" smartracker="on" target="_blank">PHP SDK</a></li>
<li><a href="http://openhome.alipay.com/doc/sdkDownload.resource?sdkType=NET" seed="entryContent-linkT180" smartracker="on" target="_blank">.NET2010 SDK</a></li>
</ol>
<p>Demo下载：</p>
<ol>
<li><a href="https://i.alipayobjects.com/i/ecmng/zip/201408/Alipay%20Fuwuchuang%20Java%20JDK%201.5%20Demo.zip" seed="entryContent-linkT181" smartracker="on" target="_blank">Java-JDK 1.5 Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/zip/201408/Alipay%20Fuwuchuang%20Java%20JDK%201.4%20Demo.zip" seed="entryContent-linkT182" smartracker="on" target="_blank">Java-JDK 1.4 Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/zip/201409/Alipay%20Fuwuchuang%20PHP%20Demo%2020140925.zip" seed="entryContent-PHP-DemoT1" smartracker="on" target="_blank">PHP Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/zip/201411/Alipay%20Fuwuchuang%20DotNet%20Demo%2020141028.zip" seed="entryContent-linkT183" smartracker="on" target="_blank">.NET2010 Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/pdf/201502/msgDemos.pdf" seed="entryContent-linkT184" smartracker="on" target="_blank">服务窗消息Demo</a></li>
<li><a href="https://i.alipayobjects.com/i/ecmng/pdf/201502/labelDemos.pdf" seed="entryContent-linkT185" smartracker="on" target="_blank">标签组发接口Demo</a></li>
</ol>
<h2 id="c1102">JSAPI Demo</h2>
<h3 id="c1102_intro">概述</h3>
<p>目前提供的JSAPI Demo合集包括以下内容：</p>
<ol>
<li>获取用户网络状态</li>
<li>拍照</li>
<li>分享组件</li>
<li>获取城市组件</li>
<li>震动</li>
<li>选取收货地址</li>
<li>扫码</li>
<li>获取用户地理位置</li>
<li>语音转文字</li>
</ol>
<h3 id="c1102_download">Demo查看及源码下载</h3>
<p>DEMO 查看及源码下载  开发者可以在“支付宝未来商业”这个服务窗中的“申请开通-技术文档”菜单中查看所有的DEMO，请用支付宝钱包扫描关注“支付宝未来商业”，源码下载请<a href="https://t.alipayobjects.com/tfscom/T1schfXeNsXXXXXXXX.zip" seed="entryContent-linkT186" smartracker="on" target="_blank">猛击此处</a>：</p>
<p><img alt="" src="44vguqpoxn.jpg" seed="entryContent-iIEcmngJpg20141244vGUqpOXNT1" smartracker="on" /></p>

          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <div class="grid-990 sitelink fn-clear">
        <ul class="ui-link fn-clear">
          <li class="ui-link-item"><a title="关于支付宝" href="http://ab.alipay.com/i/index.htm" seed="grid990-link" smartracker="on">关于支付宝</a></li>
          <li class="ui-link-item"><a title="官方博客" href="http://blog.alipay.com/" seed="grid990-linkT1" smartracker="on">官方博客</a></li>
          <li class="ui-link-item"><a title="诚征英才" href="http://job.alipay.com/index.php" seed="grid990-linkT2" smartracker="on">诚征英才</a></li>
          <li class="ui-link-item"><a title="开放平台" href="https://open.alipay.com/index.htm" seed="grid990-linkT3" smartracker="on">开放平台</a></li>
          <li class="ui-link-item"><a title="联系我们" href="http://ab.alipay.com/i/lianxi.htm" seed="grid990-linkT4" smartracker="on">联系我们</a></li>
          <li class="ui-link-item"><a title="网站地图" href="http://fun.alipay.com/sitemap/index.htm" seed="grid990-linkT5" smartracker="on">网站地图</a></li>
          <li class="ui-link-item"><a title="International Business" href="http://global.alipay.com/ospay/home.htm" seed="grid990-International-Business" smartracker="on">International Business</a></li>
          <li class="ui-link-item ui-link-item-last"><a title="About Alipay" href="http://ab.alipay.com/i/jieshao.htm#en" seed="grid990-About-Alipay" smartracker="on">About Alipay</a></li>
        </ul>
        <ul class="ui-link fn-clear">
          <li class="ui-link-item"><a title="阿里巴巴集团" href="http://page.1688.com/shtml/about/ali_group1.shtml" seed="grid990-linkT6" smartracker="on">阿里巴巴集团</a></li>
          <li class="ui-link-item"><a title="阿里巴巴国际站" href="http://www.alibaba.com/" seed="grid990-linkT7" smartracker="on">阿里巴巴国际站</a></li>
          <li class="ui-link-item"><a title="阿里巴巴中国站" href="http://www.1688.com/" seed="grid990-linkT8" smartracker="on">阿里巴巴中国站</a></li>
          <li class="ui-link-item"><a title="全球速卖通" href="http://www.aliexpress.com/" seed="grid990-linkT9" smartracker="on">全球速卖通</a></li>
          <li class="ui-link-item"><a title="淘宝网" href="http://www.taobao.com/" seed="grid990-linkT10" smartracker="on">淘宝网</a></li>
          <li class="ui-link-item"><a title="天猫" href="http://www.tmall.com/" seed="grid990-linkT11" smartracker="on">天猫</a></li>
          <li class="ui-link-item"><a title="聚划算" href="http://ju.taobao.com/" seed="grid990-linkT12" smartracker="on">聚划算</a></li>
          <li class="ui-link-item"><a title="一淘" href="http://www.etao.com/?tbpm=t" seed="grid990-linkT13" smartracker="on">一淘</a></li>
          <li class="ui-link-item"><a title="阿里妈妈" href="http://www.alimama.com/index.htm" seed="grid990-linkT14" smartracker="on">阿里妈妈</a></li>
          <li class="ui-link-item"><a title="淘宝旅行" href="http://trip.taobao.com/" seed="grid990-linkT15" smartracker="on">淘宝旅行</a></li>
          <li class="ui-link-item"><a title="虾米" href="http://www.xiami.com/" seed="grid990-linkT16" smartracker="on">虾米</a></li>
          <li class="ui-link-item"><a title="阿里云计算" href="http://www.aliyun.com/" seed="grid990-linkT17" smartracker="on">阿里云计算</a></li>
          <li class="ui-link-item"><a title="云OS" href="http://www.yunos.com/" seed="grid990-linkT18" smartracker="on">云OS</a></li>
          <li class="ui-link-item"><a title="万网" href="http://www.net.cn/" seed="grid990-linkT19" smartracker="on">万网</a></li>
          <li class="ui-link-item"><a title="支付宝" href="https://www.alipay.com/" seed="grid990-linkT20" smartracker="on">支付宝</a></li>
          <li class="ui-link-item ui-link-item-last"><a title="来往" href="https://www.laiwang.com/" seed="grid990-linkT21" smartracker="on">来往</a></li>
        </ul>
        <ul class="ui-link ui-link-bottom fn-clear">
          <li class="ui-link-item ui-link-item-last">支付宝版权所有 2004-2014<a href="http://fun.alipay.com/certificate/jyxkz.htm" seed="grid990-linkT22" smartracker="on">ICP证: 浙B2-20120045</a></li>
        </ul>
      </div>
    </div>
  

<!-- CMS:公众服务平台商户后台cms/develop/developaapi.vm结束:publichome/develop/developaapi.vm -->;<script src="validator.js" charset="utf-8" type="text/javascript"></script>
<script type="text/javascript">
var ASSERTS_SERVER = "https://a.alipayobjects.com";
</script>
<script type="text/javascript">
    var cnzz_protocol = (("https:" === document.location.protocol) ? "https://" : "http://");
    document.write(decodeURIComponent("%3Cspan id='cnzz_stat_icon_1253107971'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "w.cnzz.com/q_stat.php%3Fid%3D1253107971' type='text/javascript'%3E%3C/script%3E"));
</script><span id="cnzz_stat_icon_1253107971"></span><script type="text/javascript" src="http://w.cnzz.com/q_stat.php?id=1253107971"></script><span id="cnzz_stat_icon_1253107971"></span><script type="text/javascript" src="q_stat.php"></script>

 
<!-- uitpl:/component/tracker.vm -->
<!-- CMS:全站公共 cms/tracker/tracker.vm开始:alipay/tracker/tracker.vm --><script type="text/javascript">
window.Smartracker &amp;&amp; Smartracker.sow&amp;&amp;Smartracker.sow();
</script>



<script type="text/javascript">
function _use_monitor(){

  if(!window.seajs){return;}

  // 命中率：[0,1]: 实际对应采样率：[0%,100%]
  // 注意：sens_rate 跟 sens_rate 是有关联的。
  //      实际设置的内容时，应该参考以下算法：
  //      敏感信息监控实际采样率 = sens_rate * jserr_rate;
  var jserr_rate = 1;
  var sens_rate = 0.01;
  var performance_rate = 0.1;

  // 随机采样命中算法。
  // @param {Nuber} rate, 采样率，[0,1] 区间的数值。
  // @return {Boolean}
  function hit(rate){
    return 0 === Math.floor(Math.random() / rate);
  }
  
  // 引入性能打点文件	
  if(hit(performance_rate)){ 
	window.PAGE_TIMING = {
	  pageId: new String(new Date().getTime()),
	  parentPageId: "",
      pageType: "/platform/doc.htm",
      site: "AlipayCN",
      receiverUrl: "https://kcart.alipay.com/p.gif"
    };
		
    if(window._to &amp;&amp; _to.start){
      window.PAGE_TIMING.startRender = _to.start.getTime();
	};
		
	seajs.use("aliexpress.page-timing/0.2.0/index");
  }


  if(!hit(jserr_rate)){return;}

  seajs.use(["$", "alipay/monitor/2.3.1/monitor",
    "alipay/sensinfo/1.2.0/sensinfo"], function($, monitor, sensinfo){

    if(!monitor){return;}

    $(function(){
      var sysName = "publichome-60-5";

      monitor.on("*", function(meta){
        meta.sys = sysName;
      });


      if(!hit(sens_rate) || !sensinfo){return;}
      try{
        var html = (document.documentElement || document.body).innerHTML;
        window.setTimeout(function(){
          sensinfo.scan(html, {
            "*": function(cardType, privacy_card, context) {
              monitor.log(cardType+"="+privacy_card+"```"+context, "sens");
            }
          });
        }, 1200);
      }catch(ex){}

    });
  });

}

if(window._monitor_autoload !== false){
  _use_monitor();
}
</script>


<!-- CMS:全站公共 cms/cmsbuffer/main开始:alipay/cmsbuffer/main.vm -->																										
	
<!-- CMS:全站公共 cms/cmsbuffer/main结束:alipay/cmsbuffer/main.vm --><!-- CMS:全站公共 cms/tracker/tracker.vm结束:alipay/tracker/tracker.vm -->

<div id="global-zeroclipboard-html-bridge" class="global-zeroclipboard-container" style="position: absolute; left: 0px; top: -9999px; width: 15px; height: 15px; z-index: 999999999;">      <object width="100%" height="100%" id="global-zeroclipboard-flash-bridge" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">         <param value="//a.alipayobjects.com/gallery/zeroclipboard/1.3.5/ZeroClipboard.swf?noCache=1409909828475&amp;noCache=1436923828499" name="movie" />         <param value="always" name="allowScriptAccess" />         <param value="exactfit" name="scale" />         <param value="false" name="loop" />         <param value="false" name="menu" />         <param value="best" name="quality" />         <param value="#ffffff" name="bgcolor" />         <param value="transparent" name="wmode" />         <param value="trustedOrigins=*" name="flashvars" />         <embed width="100%" height="100%" scale="exactfit" flashvars="trustedOrigins=*" pluginspage="http://www.macromedia.com/go/getflashplayer" wmode="transparent" type="application/x-shockwave-flash" allowfullscreen="false" allowscriptaccess="always" name="global-zeroclipboard-flash-bridge" bgcolor="#ffffff" quality="best" menu="false" loop="false" src="zeroclipboard.swf" />                </object></div>

</body></html>